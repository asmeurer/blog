<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns#
        article: http://ogp.me/ns/article#
    " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>First Order Differential Equations with Homogeneous Coefficients | Aaron Meurer's SymPy Blog</title>

    
            <link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../rss.xml">

      <link rel="canonical" href="http://asmeurersympy.wordpress.com/posts/2009/05/31/first-order-differential-equations-with-homogeneous-coefficients.html">



    
        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    


    

    <meta name="author" content="Aaron Meurer">
    
        <meta name="og:title" content="First Order Differential Equations with Homogeneous Coefficients">
        <meta name="og:url" content="http://asmeurersympy.wordpress.com/posts/2009/05/31/first-order-differential-equations-with-homogeneous-coefficients.html">
            <meta name="og:description" content="So here is what I have done.  Homogeneous has several meanings, but when I use it in this post, I will mean homogeneous functions.  We only care about functions of two variables, so I will also only t">
        <meta name="og:site_name" content="Aaron Meurer's SymPy Blog">
        <meta name="og:type" content="article">

    

    



</head>
<body>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://asmeurersympy.wordpress.com/">Aaron Meurer's SymPy Blog</a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../../../../archive.html">Archives</a>
                </li>
<li>
<a href="../../../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../../../rss.xml">RSS</a>

            </li>
</ul>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="first-order-differential-equations-with-homogeneous-coefficients.wp" id="sourcelink">Source</a>
    </li>

            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">First Order Differential Equations with Homogeneous Coefficients</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Aaron Meurer</span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2009-05-31T00:10:45+00:00" itemprop="datePublished" title="Publication date">2009-05-31 00:10</time></a></p>
                <p class="commentline">
        
    <a href="first-order-differential-equations-with-homogeneous-coefficients.html#disqus_thread" data-disqus-identifier="cache/posts/2009/05/31/first-order-differential-equations-with-homogeneous-coefficients.html">Comments</a>


        </p>
</div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p></p>
<p>So here is what I have done.  Homogeneous has <a href="http://en.wikipedia.org/wiki/Homogeneous_(mathematics)">several meanings</a>, but when I use it in this post, I will mean <a href="http://en.wikipedia.org/wiki/Homogeneous_function">homogeneous functions</a>.  We only care about functions of two variables, so I will also only talk about them.  A function $latex F(x,y) $ is called homogeneous of order $latex n$ if $latex F(tx,ty)=t^nF(x,y)$ for some $latex n$.  Also, if we "pull" an $latex x$ out, we get $latex F(x,y)=x^nF(1,\frac{x}{y})=x^nG(\frac{y}{x})$, which is why the definition is often stated that the function can be written as a function of $latex \frac{y}{x} $.  Of course, we could do the same with $latex y$ and get a function of $latex \frac{x}{y}$.  Here is an example of a homogeneous function: $latex x^2+y\sqrt{x^2+y^2}\sin{\frac{x}{y}}$.  You can see that $latex (xt)^2+yt\sqrt{(xt)^2+(yt)^2}\sin{\frac{xt}{yt}}=t^2\left(x^2+y\sqrt{x^2+y^2}\sin{\frac{x}{y}}\right)$. </p>
<p>Now, if the coefficients $latex P$ and $latex Q$ in the first order differential equation $latex P(x,y)dx+Q(x,y)dy=0$ are both homogeneous functions of the same order, then the substitution $latex x=uy$ or $latex y=ux$ will make the equation separable.  I will show how to do it for $latex y=ux$.  We have $latex dy=xdy+udx$ by the product rule.  We also have $latex P(x,y)=P(x,xu)$ and $latex Q(x,y)=Q(x,xu)$.  Because these functions are homogeneous, we can "pull out" an $latex x^n$ from each, giving us $latex x^nP(1,u)dx+x^nQ(1,u)(xdu+udx)=0$.  Because we made the substitution $latex u=\frac{y}{x}$, we already have had to assume $latex x\neq0$.  Thus, we can divide the whole thing by $latex x^n$.  Doing this, and expanding the remaining terms, we get $latex P(1,u)dx+xQ(1,u)du+uQ(1,u)dx=0$.  Refactoring the $latex dx$ and $latex dy$ terms, we get $latex (P(1,u)+uQ(1,u))dx=-xQ(1,u)du$.  The equation is separable!  Separating variables and integrating, we get $latex \int{\frac{dx}{x}}=\int{\frac{-Q(1,u)du}{P(1,u)+uQ(1,u)}}+C$.  If we had used $latex x=uy$ instead, we would have gotten $latex \int{\frac{dy}{y}}=\int{\frac{-P(u,1)du}{uP(u,1)+Q(u,1)}}+C$.  This is exactly how I was able to solve these equations in SymPy.  Each homogeneous equation has two possible integrals, and often the right hand side of one equation is a much harder integral than the right hand side of the other.  Therefore, I did them both, and applied a little heuristic on which one to return.  It prefers expressions that can be solved for y (f(x) in the case of SymPy), expressions that have evaluated integrals, and if neither of them are solvable, the shortest one, which tends to be the simplest. </p>
<p>Here is an example from my text book.  $latex 2xydx+(x^2+y^2)dy=0$.  Astute readers of this blog may have noticed that this equation is <a href="http://asmeurersympy.wordpress.com/2009/05/16/work-started-exact-differential-equations/">exact</a>.  It is easier to solve that way, but we will try using the methods outlined above.  First, we notice that the coeficients of $latex dx$ and $latex dy$ are both homogeneous of order 2, so we can make the substitution $latex x=uy$ or $latex u=yx$ and the equation would become seperable.  If I were doing this by hand or for a homework assignment, I would make one of those substitutions and work it through, but we have the exact form above, so let's use it just like SymPy would.  $latex P(x,y)=2xy $ and $latex Q(x,y)=x^2+y^2$.  So we get $latex \int{\frac{dx}{x}}=\int{\frac{-(1+u^2)du}{2u+u(1+u^2)}}+C$ with $latex u=\frac{y}{x}$ and $latex \int{\frac{dy}{y}}=\int{\frac{-2udu}{u(2u)+(1+u^2)}}+C$ with $latex u=\frac{x}{y}$ (here and for the remainder of this derivation, the arbitrary constants in the two equations do not necessarily equal each other until the last step).  Both integrals can be solved  with a substitution of the denominator, giving, with $latex u$ back substituted, $latex \ln{x}=\frac{-\ln{(\frac{y^3}{x^3}+\frac{3y}{x})}}{3}+C$ and $latex \ln{y}=\frac{-\ln{(\frac{3x^3}{y^3}+1)}}{3}+C$.  If we make $latex C=ln(C_1)$, and pull the constants in front of the logs on the right hand sides in as powers, we can combine everything into logarithms.  After doing that, we then take the antilog of both sides and get $latex x=C_1{(\frac{y^3}{x^3}+\frac{3y}{x})}^{-\frac{1}{3}}$ and $latex y=C_1{(\frac{3x^3}{y^3}+1)}^{-\frac{1}{3}}$.  We then raise the whole equation to the $latex -3$ power and make $latex C_1^{-3}=A$.  We get</p>
<p>$latex \frac{1}{x^3}=A(\frac{y^3}{x^3}+3\frac{y}{x})$</p>
<p>$latex \frac{1}{x^3}=A\frac{y^3+3x^2y}{x^3}$</p>
<p>$latex K=y^3+3x^2y$ </p>
<p>and </p>
<p>$latex \frac{1}{y^3}=A(\frac{3x^2}{y^2}+1)$</p>
<p>$latex \frac{1}{y}=A(3x^2y+y^2)$</p>
<p>$latex K=y^3+3x^2y$,</p>
<p>where $latex K=\frac{1}{A}$</p>
<p>Verify as an exercise that you get the same solution by the exact differential equation methods (or <a href="http://comics.com/brevity/2006-02-16/">don't... you know, depending on which you'd rather do</a>).</p>
<p>Of course, if that was all there was to it, I would have finished in a day.  There was more.  First, I had to write a function that determines if an expression is homogeneous and what order if it is.  That was about 150 lines of code right there plus tests (150 lines is a lot in Python).   </p>
<p>I also wanted it to recognize that $latex \ln{x}-\ln{y}$ is homogeneous because $latex \ln{x}-\ln{y}=\ln{\frac{x}{y}}$.  SymPy was incapable of combining logarithms like this, so I had to write a logcombine function, which was another 100 lines of code plus tests.  This came in handy, because I was also able to use it in the part above where I combined the logarithms of my answer to eliminate all of them.  </p>
<p>Lastly, you may have noticed that my math looks much nicer in this post.  It turns out that WordPress supports math using $<!--more-->latex <!--more-->&lt;<!--more-->math<!--more-->&gt;$.  Unfortunately, I did not discover this until I had already uploaded images of almost all the math expressions in the post, so I had to go back and fix them.  </p>
<p>Also, I was having a problem where the math wouldn't render, but it turns out that this was an issue with me copying and pasting "$latex" and the expressions into the WordPress rich text editor.  I changed my editor settings to plain text.  I'm sorry, but web rich text editors do not work.  And I've grown accustomed to seeing the source of stuff that I write having done everything in $latex \LaTeX$ for a year and having edited Wikipedia for a while. </p>
<p>I wish there were a free blogging site like WordPress or Blogger that used MediaWiki or $latex \LaTeX$ as its rendering engine.  It would look nice, the formatting would be a standard thing that isn't confusing html, and $latex \LaTeX$ math would come out much nicer.  </p>
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    
        <ul itemprop="keywords" class="tags">
           <li><a class="tag p-category" href="../../../../categories/mathjax.html" rel="tag">mathjax</a></li>
        </ul>

    
        <ul class="pager">
            <li class="previous">
                <a href="../30/just-finished-a-new-bit.html" rel="prev" title="Just finished a new bit.">Previous post</a>
            </li>
            <li class="next">
                <a href="separable-next.html" rel="next" title="Separable next">Next post</a>
            </li>
        </ul>

    </nav>
    </aside>
        <section class="comments">
        <h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="nikolademo",
            disqus_url="http://asmeurersympy.wordpress.com/posts/2009/05/31/first-order-differential-equations-with-homogeneous-coefficients.html",
        disqus_title="First Order Differential Equations with Homogeneous Coefficients",
        disqus_identifier="cache/posts/2009/05/31/first-order-differential-equations-with-homogeneous-coefficients.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section>
    
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});</script>
        <script src="../../../../assets/js/mathjax.js"></script>

</article>

        
       <script>var disqus_shortname="nikolademo";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>



        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:asmeurer@gmail.com">Aaron Meurer</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
        </footer>
    </div>
</div>


            <script src="../../../../assets/js/all-nocdn.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

</body>
</html>
