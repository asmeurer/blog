<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns#
        article: http://ogp.me/ns/article#
    " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>The Risch Algorithm: Part 2, Elementary Functions | Aaron Meurer's SymPy Blog</title>

    
            <link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../rss.xml">

      <link rel="canonical" href="http://asmeurersympy.wordpress.com/posts/2010/07/24/the-risch-algorithm-part-2-elementary-functions.html">



    
        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    


    

    <meta name="author" content="Aaron Meurer">
    
        <meta name="og:title" content="The Risch Algorithm: Part 2, Elementary Functions">
        <meta name="og:url" content="http://asmeurersympy.wordpress.com/posts/2010/07/24/the-risch-algorithm-part-2-elementary-functions.html">
            <meta name="og:description" content="In Part 1 of this series of blog posts, I gave what I believed to be the prerequisites to understanding the mathematics behind the Risch Algorithm (aside from a basic understanding of derivatives and ">
        <meta name="og:site_name" content="Aaron Meurer's SymPy Blog">
        <meta name="og:type" content="article">

    

    



</head>
<body>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://asmeurersympy.wordpress.com/">Aaron Meurer's SymPy Blog</a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../../../../archive.html">Archives</a>
                </li>
<li>
<a href="../../../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../../../rss.xml">RSS</a>

            </li>
</ul>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="the-risch-algorithm-part-2-elementary-functions.wp" id="sourcelink">Source</a>
    </li>

            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">The Risch Algorithm: Part 2, Elementary Functions</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Aaron Meurer</span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2010-07-24T03:32:57+00:00" itemprop="datePublished" title="Publication date">2010-07-24 03:32</time></a></p>
                <p class="commentline">
        
    <a href="the-risch-algorithm-part-2-elementary-functions.html#disqus_thread" data-disqus-identifier="cache/posts/2010/07/24/the-risch-algorithm-part-2-elementary-functions.html">Comments</a>


        </p>
</div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p></p>
<p>In <a href="http://asmeurersympy.wordpress.com/2010/06/30/the-risch-algorithm-part-1/">Part 1</a> of this series of blog posts, I gave what I believed to be the prerequisites to understanding the mathematics behind the Risch Algorithm (aside from a basic understanding of derivatives and integrals from calculus).  In this post, I will elaborate on what is meant by "elementary function," a term that is thrown around a lot when talking about Risch integration.</p>
<p>The usual definition of elementary function given in calculus is any function that is a constant, a polynomial, an exponential ($latex e^x$, $latex 2^x$), a logarithm ($latex \ln({x})$, $latex \log_{10}({x})$), one of the standard trig functions or their inverses (sin, cos, tan, arcsin, arccos, arctan, etc.), and any combination of these functions via addition, subtraction, multiplication, division, taking powers, and composition.  Thus, even a function as crazy as <a href="../../../../2010/07/crazy-function.png"><img src="../../../../2010/07/crazy-function.png" alt="" title="crazy function" width="193" height="41" class="alignnone size-full wp-image-632"></a> is elementary, by this definition.  </p>
<p>But for the rigorous definition of an elementary function, we must take into consideration what field we are working over.  Before I get into that, I need some definitions.  Suppose that $latex k$ is the field we are working over.  You can imagine that $latex k=\mathbb{Q}(x)$, the field of rational functions in x with rational number coefficients.  As with the previous post, imagine $latex t$ as a function, for example, $latex t = f(x)$.  Let $latex K$ be a differential extension of $latex k$.  We have not defined this, but it basically means that our derivation $latex D$ works the same in $latex K$ as it does in $latex k$.  You can imagine here that $latex K=k[t]$.  </p>
<p>We say that $latex t \in K$ is a <strong>primitive</strong> over $latex k$ if $latex Dt \in k$.  In other words, the derivative of $latex t$ is does not contain $latex t$, only elements of $latex k$.  Obviously, by the definition of a derivation (see the <a href="http://asmeurersympy.wordpress.com/2010/06/30/the-risch-algorithm-part-1/">last post</a> in the series), any element of $latex k$ is a primitive over $latex K$, because the derivative of any element of a field is again an element of that field (you can see this by the definition of a derivation, also given in the last post).  But also if $latex t=log(a)$ for some $latex a \in k$, then $latex t$ is a primitive over $latex k$, because $latex Dt=\frac{Da}{a}\in k$.  </p>
<p>We say that $latex t \in K^*$ is a <strong>hyperexponential</strong> over $latex k$ if $latex \frac{Dt}{t}\in k$.  Written another way, $latex Dt=at$ for some $latex a\in k$.  We know from calculus that the functions that satisfy differential equations of the type $latex \frac{dy}{dx}=ay$ are exactly the exponential functions, i.e., $latex y=e^{\int{a\ dx}}$.  </p>
<p>The last class of functions that needs to be considered is <strong><a href="http://en.wikipedia.org/wiki/Algebraic_function">algebraic functions</a></strong>.  I will not go into depth on algebraic functions, because my work this summer is only on integrating purely transcendental functions.  Therefore, the only concern we shall have with algebraic functions in relation to the integration algorithm is to make sure that whatever function we are integrating is <em>not</em> algebraic, because the transcendental algorithms will not be valid if they are.  Hopefully in a future post I will be able to discuss the Risch Structure Theorems, which give necessary and sufficient conditions for determing if a Liouvillian function (see next paragraph) is algebraic.  </p>
<p>Now, we say that a function $latex t \in K$ is <strong>Liouvillian</strong> over $latex k$ if $latex t$ is algebraic, a primitive, or a hyperexponential over $latex k$.  For $latex t\in K$ to be a <strong>Liouvillian monomial</strong> over $latex k$, we have the additional condition that $latex \mathrm{Const}(k) = \mathrm{Const}(k(t))$. This just means that we cannot consider something like $latex \log({2})$ over $latex \mathbb{Q}$ as a Liouvillian monomial.  Otherwise (I believe) we could run into undecidability problems.  </p>
<p>We call $latex t \in K$ a <strong>logarithm</strong> over $latex k$ if $latex Dt=\frac{Db}{b}$ for some $latex b \in k^<em>$, i.e., $latex t=\log({b})$.  We call $latex t \in K^</em>$ an <strong>exponential</strong> over $latex k$ if $latex \frac{Dt}{t}=Db$ (or $latex Dt=tDb$) for some $latex b \in k$, i.e., $latex t=e^b$.  Note the difference between an <em>exponential</em> monomial and a <em>hyperexponential</em> monomial.  </p>
<p>We can finally give the rigorous definition of an elementary extension.  $latex K$ is an <strong>elementary extension</strong> of $latex k$ if there are $latex t_1, \dots, t_n \in K$ such that $latex K=k(t_1,\dots,t_n)$ and $latex t_i$ is elementary over $latex k(t_1, \dots, t_{i-1})$ for all $latex i \in {1,\dots,n}$.  An <strong>elementary function </strong> is any element of an elementary extension of $latex \mathbb{C}(x)$ with the derivation $latex D=\frac{d}{dx}$.  A function $latex f\in k$ has an <strong>elementary integral</strong> over $latex k$ if there exists an elementary extension $latex K$ of $latex k$ and $latex g\in K$ such that $latex Dg=f$, i.e., $latex f=\int{g}$.  </p>
<p>Usually, we start with $latex \mathbb{Q}(x)$, the field of rational functions in x with rational number coefficients. We then build up an elementary extension one function at a time, with each function either being a logarithm or exponential of what we have already built up, or algebraic over it.  As I noted above, we will ignore algebraic functions here.  We generally start with $latex \mathbb{Q}$ because it is computable (important problems such as the zero equivalence problem or the problem of determining certain field isomorphisms are decidable), but the above definition lets us start with any subfield of $latex \mathbb{C}$.  </p>
<p>Now you may be wondering: we've covered algebraic functions, exponentials and logarithms, and obviously rational functions are elements of $latex \mathbb{Q}(x)$, but what about trigonometric functions?  Well, from a theoretical stand point, we can make our lives easier by noticing that all the common trigonometric functions can be represented as exponentials and logarithms over $latex \mathbb{Q}(i)$.  For example, $latex \cos{x} = \frac{e^{ix} + e^{-ix}}{2}$.  You can see <a href="http://en.wikipedia.org/wiki/Trig_identities#Exponential_definitions">here</a> that all the common trig functions can be represented as complex exponentials or logarithms like this.  However, from an algorithmic standpoint, we don't want do convert all trig expressions into complex exponentials and logarithms in order to integrate them.  For one thing, our final result will be in terms of complex exponentials and logarithms, not the original functions we started with, and converting them back may or may not be an easy thing to do.  Also, aside from the fact that we have different functions than we were expecting, we also will end up with an answer containing $latex \sqrt{-1}$, even if our original integrand did not.  </p>
<p>Fortunately, the integrating tangents directly is a solved problem, just like integrating algebraic, exponential, or logarithmic functions is solved.  We can't integrate functions like $latex \sin{x}$ or $latex \cos{x}$ directly as monomials like we can with $latex \tan{x}$ or $latex e^x$, because the derivatives of sin and cos are not polynomials in their respective selves with coefficients in $latex \mathbb{C}(x)$.  However, we can use a trick or two to integrate them.  One way is to rewrite $latex \cos{x}=\frac{1 - \tan^2{\frac{x}{2}}}{1 + \tan^2{\frac{x}{2}}}$ and proceed to integrate it as a tangent.  Another alternative is to write $latex \cos{x}=\frac{1}{\sec{x}}=\sqrt{\frac{1}{\sec^2{x}}}=\sqrt{\frac{1}{\tan^2{x} + 1}}$.  This function is algebraic over $latex \mathbb{Q}(x, \tan{(x)})$, but if we do not already have $latex \tan{x}$ in our differential extension, it is transcendental, and we can rewrite it as $latex e^{-\frac{\log{(1 + \tan^2{x})}}{2}}$ (this is used in Bronstein's text, so I believe what I just said is correct, though I haven't verified it with the structure theorems just yet).   These both work using the relevant identities for sin too.  Of course, there is still the problem of rewriting the final integrand back in terms of sin or cos.  Otherwise, you will get something like $latex \frac{2e^x\tan({\frac{x}{2}}) - \tan^2({\frac{x}{2}})e^x + e^x}{2 + 2\tan^2({\frac{x}{2}})}$ instead of $latex \frac{e^x(\sin{(x)} + \cos{(x)})}{2}$ for $latex \int{\cos{(x)}e^xdx}$.  Bronstein doesn't elaborate on this too much in his book, so it is something that I will have to figure out on my own.</p>
<p>The second option I gave above leads nicely into the main point I wanted to make here about elementary functions.  Notice that everywhere in the definitions above, things depend on the field we are working in.  Therefore, $latex e^{\tan{x}}$ cannot be an elementary extension over $latex \mathbb{Q}(x)$, but it can be over $latex \mathbb{Q}(x, \tan{x})$.  Also, the <a href="http://en.wikipedia.org/wiki/Error_function">error function</a>, defined as $latex \mathrm{erf}{(x)} = \frac{2}{\sqrt{\pi}}\int{e^{-x^2}dx}$ cannot be an elementary extension over $latex \mathbb{Q}(x)$, but it can over $latex \mathbb{Q}(x, e^{-x^2})$. In fact this is how we can integrate in terms of some special functions, including the error function: by manually adding $latex e^{-x^2}$ (or whatever) to our differential extension.   Therefore, the usual definition of an elementary anti-derivaitve and the above Risch Algorithm definition of an elementary integral coincide only when the extension consists only of elementary functions of the form of the usual definition (note that above, our final fields are $latex \mathbb{Q}(x, \tan{x}, e^{\tan{x}})$ and $latex \mathbb{Q}(x, e^{-x^2}, \mathrm{erf}{(x)})$, respectively).  </p>
<p>Originally, I was also going to talk about Liouville's Theorem in this blog post, but I think it has already gotten long enough (read "I'm getting tired"), so I'll put that off until next time.  </p>
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    
        <ul itemprop="keywords" class="tags">
           <li><a class="tag p-category" href="../../../../categories/mathjax.html" rel="tag">mathjax</a></li>
        </ul>

    
        <ul class="pager">
            <li class="previous">
                <a href="../17/a-hard-week.html" rel="prev" title="A hard week">Previous post</a>
            </li>
            <li class="next">
                <a href="../31/integration-of-primitive-functions.html" rel="next" title="Integration of primitive functions">Next post</a>
            </li>
        </ul>

    </nav>
    </aside>
        <section class="comments">
        <h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="nikolademo",
            disqus_url="http://asmeurersympy.wordpress.com/posts/2010/07/24/the-risch-algorithm-part-2-elementary-functions.html",
        disqus_title="The Risch Algorithm: Part 2, Elementary Functions",
        disqus_identifier="cache/posts/2010/07/24/the-risch-algorithm-part-2-elementary-functions.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section>
    
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});</script>
        <script src="../../../../assets/js/mathjax.js"></script>

</article>

        
       <script>var disqus_shortname="nikolademo";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>



        </div>
        <!--End of body content-->

        <footer>
            Contents Â© 2014         <a href="mailto:asmeurer@gmail.com">Aaron Meurer</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
        </footer>
    </div>
</div>


            <script src="../../../../assets/js/all-nocdn.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

</body>
</html>
