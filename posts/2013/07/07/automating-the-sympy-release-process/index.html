<!DOCTYPE html><html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Aaron Meurer">
    <title>Automating the SymPy release process | Aaron Meurer's Blog</title>
    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
   tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
   },
   displayAlign: 'left', // Change this to 'center' to center equations.
   "HTML-CSS": {
       styles: {'.MathJax_Display': {"margin": 0}}
   }
});
</script>

            <link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
      <link rel="canonical" href="http://asmeurer.github.io/posts/2013/07/07/automating-the-sympy-release-process/">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]-->
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../rss.xml">

    

        <meta name="twitter:card" content="summary">
        <meta name="og:url" content="http://asmeurer.github.io/posts/2013/07/07/automating-the-sympy-release-process/">
            <meta name="twitter:site:id" content="123456">
            <meta name="twitter:creator:id" content="654321">
        <meta name="og:title" content="Automating the SymPy release process">
            <meta name="og:description" content="So I have just pub­lished  SymPy 0.7.3.r­c1. I'll write a blog post about the re­lease it­self when we re­lease 0.7.3 fi­nal, but for now, I want­ed to write about how we man­aged to au­to­mate our re">




    
<link rel="stylesheet" type="text/css" href="../../../../../assets/css/tipuesearch.css">
</head><body><div id="tipue_search_content" style="margin-left: auto; margin-right: auto; padding: 20px;"></div>



<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid"><!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://asmeurer.github.io/">Aaron Meurer's Blog</a>
        </div><!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li><a href="../../../../../archive.html">Archives</a>
                </li><li><a href="../../../../../categories/index.html">Tags</a>
                </li><li><a href="../../../../../rss.xml">RSS</a>

            </li></ul>
                
<span class="navbar-form pull-left">
<input type="text" id="tipue_search_input">
</span>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="index.wp" id="sourcelink">Source</a>
    </li>

            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
    <article class="postbox post-text">
    <div class="h-entry" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <h1 class="p-name" itemprop="headline name">Automating the SymPy release process</h1>

    <hr>
    <small>
        Posted: <time class="published dt-published" datetime="2013-07-07T03:13:57-05:00" itemprop="datePublished">2013-07-07 03:13</time>
        

        

    </small>
    <hr>
    <div class="e-content" itemprop="articleBody text">
    <div><p></p><p>So I have just pub­lished  <a href="https://github.com/sympy/sympy/releases/sympy-0.7.3.rc1">SymPy 0.7.3.r­c1</a>. I'll write a blog post about the re­lease it­self when we re­lease 0.7.3 fi­nal, but for now, I want­ed to write about how we man­aged to au­to­mate our re­lease process.</p> 
 <p>Our sto­ry be­gins back in Oc­to­ber of 2012, when I wrote a long wind­ed  <a href="https://groups.google.com/d/msg/sympy/UfNhyFv-oMg/PkwIz32K-lsJ">rant</a>  to the mail­ing list about how long it was tak­ing to get the 0.7.2 re­lease out (it took over a month from the time the re­lease branch was cre­at­ed).  </p> 
 <p>The rant is fun, and I rec­om­mend read­ing it. Here are some quotes</p> 
 <p>The in­tro:</p> 
 <p></p><blockquote>
<p>Now here's a time­line: 0.7.1 was re­leased Ju­ly 29, 2011, more than a year and two months ago.  0.7.0 was re­leased just over a month be­fore that, on June 28.  0.6.7 was re­leased March 18, 2010, again over a year be­fore 0.7.0.  In al­most two year's time, we've had three re­leas­es, and are strug­gling to get out a fourth.  And it's not like there were no changes; quite the op­po­site in fac­t.  If you look at SymPy 0.6.6 com­pared to the cur­rent mas­ter, it's un­be­liev­able the amount of changes that have gone for­ward in that time.  We've had  </p> 
 <p>since then the new polys, at least four com­plete­ly new sub­mod­ules (com­bi­na­toric­s, set­s, dif­fer­en­tial ge­om­e­try, and stat­s), mas­sive im­prove­ments to in­te­gra­tion and spe­cial func­tion­s, a ton of new stuff in the physics mod­ule, lit­er­al­ly thou­sands of bug fix­es, and the list goes on.  Each of these changes on it's own was enough to war­rant a re­lease.  </p> 
 <p>So in case I did­n't make my point, le me state it ex­plic­it­ly: we need to re­lease more of­ten.  We need to re­lease  <em>way</em>  more of­ten.  </p> 
 </blockquote>

<p>My views on some of the fun­da­men­tal (non-tech­ni­cal) is­sues:</p> 
 <blockquote>

I think that one other thing that has held back many releases is the feeling of "wait, we should put this in the release". The use of a release branch has helped keep master moving along independently, but there still seems to be the feeling with many branches of, "this is a nice feature, it ought to go in the release."  My hope is that by making the release process smoother, we can release more often, and this feeling will go away, because it won't be a big deal if something waits until the next release.  As far as deprecations go, the real issue with them is time, not release numbers.  So if we deprecate a feature today vs. one month from today, it's not a big deal (as opposed to today vs. a year from today), regardless of how many versions are in between. 



I read about what GitHub does for their Windows product regarding releasing often on their blog: https://github.com/blog/1271-how-we-ship-github-for-windows (they actually have this philosophy for all their products).  One thing that they said is, "And by shipping updates so often, there is less anxiety about getting a particular feature ready for a particular release. If your pull request isn’t ready to be merged in time for today’s release, relax. There will be another one soon, so make that code shine!"  I think that is exactly the point here.  Another thing that they noted is that automation is the key to doing this, which is what I am aiming for with the above point. 

</blockquote>

<p>My vi­sion:</p> 
 <blockquote>

Once we start releasing very often (and believe me, this is way down the road, but I'm trying to be forward looking here), we can do away with release candidates.  A release candidate lives in the wild for a week before the full release.  But if we are capable of releasing literally every week, then having release candidates is pointless.  If a bug slips into a release, we just fix it and it will be in the next release. 

</blockquote>

<p>...</p> 
 <blockquote>

We should release *at least* once a month.  I think that if the process is automated enough, that this will be very possible (as opposed to the current situation, where the release branch lasts longer than a month).  In times of high activity, we can release more often than that (e.g., after a big pull request is merged, we can release). 

</blockquote>

<p>That was Oc­to­ber. To­day is Ju­ly. Ba­si­cal­ly, our re­lease process was way too long. Half of it was test­ing stuff, half of it was te­dious re­leas­ing stuff (like mak­ing tar­balls and so on), and half of it was up­dat­ing web­sites.  </p> 
 <p>We have moved all our test­ing to Travis CI. So now ev­ery pull re­quest is test­ed, and we can be pret­ty much as­sured that mas­ter is al­ways pass­ing the test­s.  There is still some work to do here (cur­rent­ly Travis CI does­n't test with ex­ter­nal de­pen­den­cies), but it's most­ly a solved prob­lem.</p> 
 <p>For up­dat­ing web­sites, we con­ced­ed that we are not go­ing to up­date any­thing that we don't own. That means no at­tempt­ing to make De­bian or Sage pack­ages, or up­dat­ing Wikipedia or Fresh­meat. Some­one else will do that (and does any­one even use Fresh­meat any more?).  </p> 
 <p>That leaves the re­leas­ing it­self. It's still a pain, be­cause we have to make a source tar­ball, Win­dows in­staller, html doc­s, and pdf doc­s, and do them all for both Python 2 and Python 3.  </p> 
 <p>So On­drej sug­gest­ed mov­ing to fab­ric/­va­grant. At the SciPy 2013 sprints, he start­ed work­ing on a fab­file that au­to­mates the whole process. Ba­si­cal­ly va­grant is a pre­de­fined Lin­ux vir­tu­al ma­chine that makes it easy to make ev­ery­thing com­plete­ly re­pro­ducible. Fab­ric is a tool that makes it easy to write com­mands (in Python) that are run on that ma­chine.  </p> 
 <p>Build­ing the ba­sic stuff was easy, but I want to au­to­mate  <em>ev­ery­thing</em>. So far, not ev­ery­thing is done yet, but we're get­ting close. For ex­am­ple, in ad­di­tion to build­ing the tar­ball­s, the fab­ric script checks the con­tents of the tar­ball against  <code>git ls-­files</code>  to make sure that noth­ing is in­clud­ed that should­n't be or left out ac­ci­den­tal­ly (and, in­deed, we caught some miss­ing files that weren't in­clud­ed in the tar­ball, in­clud­ing the READ­ME).  </p> 
 <p>You can run all this your­self. Check­out the 0.7.3 branch from SymPy, then cd in­to the re­lease di­rec­to­ry, and read the README. Ba­si­cal­ly, you just in­stall Fab­ric and Va­grant if you don't have them al­ready, then run</p> 
 <p>[code]</p> 
 <p>va­grant up</p> 
 <p>fab va­grant pre­pare</p> 
 <p>fab va­grant re­lease</p> 
 <p>[/­code]</p> 
 <p>Note that this down­loads a 280 MB vir­tu­al ma­chine, so it will take some time to run for the first time. When you do this, the re­leas­es are in the  <code>re­lease</code>  di­rec­to­ry.  </p> 
 <p>Fi­nal­ly, I up­load­ed 0.7.3.r­c1 to GitHub us­ing the new re­leas­es fea­ture. This is what the re­lease looks like on GitHub, from the us­er point of view</p> 
 <p><a href="../../../../../2013/07/screenshot-2013-07-06-22-05-31.png"><img src="../../../../../2013/07/screenshot-2013-07-06-22-05-31.png" alt="SymPy 0.7.3.rc1" width="450" height="260" class="alignnone size-full wp-image-1352"></a></p> 
 <p>This is what it looks like to me</p> 
 <p><a href="../../../../../2013/07/screenshot-2013-07-06-22-08-19.png"><img src="../../../../../2013/07/screenshot-2013-07-06-22-08-19.png" alt="SymPy 0.7.3.rc1 Edit" width="450" height="470" class="alignnone size-full wp-image-1353"></a></p> 
 <p>GitHub has (ob­vi­ous­ly) the best in­ter­face I've ev­er seen for this. Of course, even bet­ter would be if there were an API, so that I could au­to­mate this too.  But since Google's  <a href="http://google-opensource.blogspot.com/2013/05/a-change-to-google-code-download-service.html">an­nounce­ment</a>  that they are dis­con­tin­u­ing down­load­s, we can no longer up­load to Google Code. Our plan was to just use PyP­I, but I am glad that we can have at least one oth­er lo­ca­tion, es­pe­cial­ly since PyPI is so bug­gy and un­re­li­able (I can't even log in, I get a 502).</p> 
 <p>So please down­load this re­lease can­di­date and test it. We es­pe­ical­ly need peo­ple to test the Win­dows in­staller, since we haven't au­to­mat­ed that part yet (ac­tu­al­ly, we are con­sid­er­ing not mak­ing them any more, es­pecail­ly giv­en the ex­is­tence of peo­ple like Christoph Gohlke who  <a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/#sympy">make them</a>  for SymPy any­way, but we'll see). The on­ly thing that re­mains to be done is to fin­ish writ­ing the  <a href="https://github.com/sympy/sympy/wiki/release-notes-for-0.7.3">re­lease notes</a>. If you made any con­tri­bu­tions to SymPy since the last re­lease, please add them there. Or if you want to help out, you can go through our pull re­quests and make sure that noth­ing is miss­ing.</p></div>
    </div>
    </div>
    
        <ul class="pager">
            <li class="previous">
                <a href="../../02/scipy-2013/" rel="prev">← Previous post</a>
            </li>
            <li class="next">
                <a href="../../../08/09/using-python-3-as-my-default-python/" rel="next">Next post →</a>
            </li>
        </ul>

        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="asmeurer",
            disqus_url="http://asmeurer.github.io/posts/2013/07/07/automating-the-sympy-release-process/",
        disqus_title="Automating the SymPy release process",
        disqus_identifier="cache/posts/2013/07/07/automating-the-sympy-release-process.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


    

    </article>

        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:asmeurer@gmail.com">Aaron Meurer</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<p xmlns:dct="http://purl.org/dc/terms/" xmlns:vcard="http://www.w3.org/2001/vcard-rdf/3.0#">
  <a rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/">
    <img src="http://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0">
  </a>

        </p></footer>
    </div>
</div>


            <script src="../../../../../assets/js/all-nocdn.js" type="text/javascript"></script>


    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul><li><a class="addthis_button_facebook"></a>
</li><li><a class="addthis_button_google_plusone_share"></a>
</li><li><a class="addthis_button_linkedin"></a>
</li><li><a class="addthis_button_twitter"></a>
</li></ul>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script type="text/javascript">jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

<script type="text/javascript" src="../../../../../assets/js/tipuesearch_set.js"></script>
<script type="text/javascript" src="../../../../../assets/js/tipuesearch.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#tipue_search_input').tipuesearch({
        'mode': 'json',
        'contentLocation': '/assets/js/tipuesearch_content.json',
        'showUrl': false
    });
});
</script>


</body></html>