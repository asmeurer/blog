<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns#
        article: http://ogp.me/ns/article#
    " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>The Risch Algorithm: Part 2, Elementary Functions | Aaron Meurer's Blog</title>

    
            <link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../rss.xml">

      <link rel="canonical" href="http://asmeurer.github.io/posts/2010/07/24/the-risch-algorithm-part-2-elementary-functions/">



    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
   tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"], ['$ latex','$'] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
   },
   displayAlign: 'left', // Change this to 'center' to center equations.
   "HTML-CSS": {
       styles: {'.MathJax_Display': {"margin": 0}}
   }
});
</script>

        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    
<link rel="stylesheet" type="text/css" href="../../../../../assets/css/tipuesearch.css">
</head>
<body>
<div id="tipue_search_content" style="margin-left: auto; margin-right: auto; padding: 20px;"></div>



    

    <meta name="author" content="Aaron Meurer">
    
        <meta name="og:title" content="The Risch Algorithm: Part 2, Elementary Functions">
        <meta name="og:url" content="http://asmeurer.github.io/posts/2010/07/24/the-risch-algorithm-part-2-elementary-functions/">
            <meta name="og:description" content="In  Part 1  of this se­ries of blog post­s, I gave what I be­lieved to be the pre­req­ui­sites to un­der­stand­ing the math­e­mat­ics be­hind the Risch Al­go­rithm (a­side from a ba­sic un­der­stand­i">
        <meta name="og:site_name" content="Aaron Meurer's Blog">
        <meta name="og:type" content="article">

    
        <meta name="twitter:card" content="summary">
            <meta name="twitter:site:id" content="123456">
            <meta name="twitter:creator:id" content="654321">

    





<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://asmeurer.github.io/">Aaron Meurer's Blog</a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../../../../../archive.html">Archives</a>
                </li>
<li>
<a href="../../../../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../../../../rss.xml">RSS</a>

            </li>
</ul>
                
<span class="navbar-form pull-left">
<input type="text" id="tipue_search_input">
</span>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="index.wp" id="sourcelink">Source</a>
    </li>

            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">The Risch Algorithm: Part 2, Elementary Functions</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Aaron Meurer</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2010-07-24T03:32:57-05:00" itemprop="datePublished" title="Publication date">2010-07-24 03:32</time></a></p>
                <p class="commentline">
        
    <a href=".#disqus_thread" data-disqus-identifier="cache/posts/2010/07/24/the-risch-algorithm-part-2-elementary-functions.html">Comments</a>


        </p>
</div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p></p>
<p>In  <a href="http://asmeurersympy.wordpress.com/2010/06/30/the-risch-algorithm-part-1/">Part 1</a>  of this se­ries of blog post­s, I gave what I be­lieved to be the pre­req­ui­sites to un­der­stand­ing the math­e­mat­ics be­hind the Risch Al­go­rithm (a­side from a ba­sic un­der­stand­ing of de­riv­a­tives and in­te­grals from cal­cu­lus).  In this post, I will elab­o­rate on what is meant by "ele­men­tary func­tion," a term that is thrown around a lot when talk­ing about Risch in­te­gra­tion.</p> 
 <p>The usu­al def­i­ni­tion of el­e­men­tary func­tion giv­en in cal­cu­lus is any func­tion that is a con­stan­t, a poly­no­mi­al, an ex­po­nen­tial ($la­tex e^x$, $la­tex 2^x$), a log­a­rithm ($la­tex \l­n({x})$, $la­tex \log_{10}({x})$), one of the stan­dard trig func­tions or their in­vers­es (s­in, cos, tan, arc­sin, ar­c­cos, arc­tan, etc.), and any com­bi­na­tion of these func­tions via ad­di­tion, sub­trac­tion, mul­ti­pli­ca­tion, di­vi­sion, tak­ing pow­er­s, and com­po­si­tion.  Thus, even a func­tion as crazy as  <a href="../../../../../2010/07/crazy-function.png"><img src="../../../../../2010/07/crazy-function.png" alt="" title="crazy function" width="193" height="41" class="alignnone size-full wp-image-632"></a>  is el­e­men­tary, by this def­i­ni­tion.   </p> 
 <p>But for the rig­or­ous def­i­ni­tion of an el­e­men­tary func­tion, we must take in­to con­sid­er­a­tion what field we are work­ing over.  Be­fore I get in­to that, I need some def­i­ni­tion­s.  Sup­pose that $la­tex k$ is the field we are work­ing over.  You can imag­ine that $la­tex k=\­math­b­b{Q}(x)$, the field of ra­tio­nal func­tions in x with ra­tio­nal num­ber co­ef­fi­cients.  As with the pre­vi­ous post, imag­ine $la­tex t$ as a func­tion, for ex­am­ple, $la­tex t = f(x)$.  Let $la­tex K$ be a dif­fer­en­tial ex­ten­sion of $la­tex k$.  We have not de­fined this, but it ba­si­cal­ly means that our deriva­tion $la­tex D$ works the same in $la­tex K$ as it does in $la­tex k$.  You can imag­ine here that $la­tex K=k[t]$.   </p> 
 <p>We say that $la­tex t \in K$ is a  <strong>prim­i­tive</strong>  over $la­tex k$ if $la­tex Dt \in k$.  In oth­er word­s, the de­riv­a­tive of $la­tex t$ is does not con­tain $la­tex t$, on­ly el­e­ments of $la­tex k$.  Ob­vi­ous­ly, by the def­i­ni­tion of a deriva­tion (see the  <a href="http://asmeurersympy.wordpress.com/2010/06/30/the-risch-algorithm-part-1/">last post</a>  in the se­ries), any el­e­ment of $la­tex k$ is a prim­i­tive over $la­tex K$, be­cause the de­riv­a­tive of any el­e­ment of a field is again an el­e­ment of that field (y­ou can see this by the def­i­ni­tion of a deriva­tion, al­so giv­en in the last post).  But al­so if $la­tex t=log(a)$ for some $la­tex a \in k$, then $la­tex t$ is a prim­i­tive over $la­tex k$, be­cause $la­tex Dt=\frac{­Da}{a}\in k$.   </p> 
 <p>We say that $la­tex t \in K^*$ is a  <strong>hy­per­ex­po­nen­tial</strong>  over $la­tex k$ if $la­tex \frac{Dt}{t}\in k$.  Writ­ten an­oth­er way, $la­tex Dt=at$ for some $la­tex a\in k$.  We know from cal­cu­lus that the func­tions that sat­is­fy dif­fer­en­tial equa­tions of the type $la­tex \frac{dy}{dx}=ay$ are ex­act­ly the ex­po­nen­tial func­tion­s, i.e., $la­tex y=e^{\in­t{a\ dx}}$.   </p> 
 <p>The last class of func­tions that needs to be con­sid­ered is  <strong><a href="http://en.wikipedia.org/wiki/Algebraic_function">al­ge­bra­ic func­tions</a></strong>.  I will not go in­to depth on al­ge­bra­ic func­tion­s, be­cause my work this sum­mer is on­ly on in­te­grat­ing pure­ly tran­scen­den­tal func­tion­s.  There­fore, the on­ly con­cern we shall have with al­ge­bra­ic func­tions in re­la­tion to the in­te­gra­tion al­go­rithm is to make sure that what­ev­er func­tion we are in­te­grat­ing is  <em>not</em>  al­ge­braic, be­cause the tran­scen­den­tal al­go­rithms will not be valid if they are.  Hope­ful­ly in a fu­ture post I will be able to dis­cuss the Risch Struc­ture The­o­rem­s, which give nec­es­sary and suf­fi­cient con­di­tions for de­terming if a Li­ou­vil­lian func­tion (see next para­graph) is al­ge­bra­ic.   </p> 
 <p>Now, we say that a func­tion $la­tex t \in K$ is  <strong>Li­ou­vil­lian</strong>  over $la­tex k$ if $la­tex t$ is al­ge­braic, a prim­i­tive, or a hy­per­ex­po­nen­tial over $la­tex k$.  For $la­tex t\in K$ to be a  <strong>Li­ou­vil­lian mono­mi­al</strong>  over $la­tex k$, we have the ad­di­tion­al con­di­tion that $la­tex \math­rm{­Con­st}(k) = \math­rm{­Con­st}(k(t))$. This just means that we can­not con­sid­er some­thing like $la­tex \log({2})$ over $la­tex \math­b­b{Q}$ as a Li­ou­vil­lian mono­mi­al.  Oth­er­wise (I be­lieve) we could run in­to un­de­cid­abil­i­ty prob­lem­s.   </p> 
 <p>We call $la­tex t \in K$ a  <strong>log­a­rithm</strong>  over $la­tex k$ if $la­tex Dt=\frac{D­b}{b}$ for some $la­tex b \in k^<em>$, i.e., $la­tex t=\log({b})$.  We call $la­tex t \in K^</em>$ an  <strong>ex­po­nen­tial</strong>  over $la­tex k$ if $la­tex \frac{Dt}{t}=D­b$ (or $la­tex Dt=t­D­b$) for some $la­tex b \in k$, i.e., $la­tex t=e^b$.  Note the dif­fer­ence be­tween an  <em>ex­po­nen­tial</em>  mono­mi­al and a  <em>hy­per­ex­po­nen­tial</em>  mono­mi­al.   </p> 
 <p>We can fi­nal­ly give the rig­or­ous def­i­ni­tion of an el­e­men­tary ex­ten­sion.  $la­tex K$ is an  <strong>el­e­men­tary ex­ten­sion</strong>  of $la­tex k$ if there are $la­tex t_1, \dot­s, t_n \in K$ such that $la­tex K=k(t_1,\­dot­s,t_n)$ and $la­tex t_i$ is el­e­men­tary over $la­tex k(t_1, \dot­s, t_{i-1})$ for all $la­tex i \in {1,\­dot­s,n}$.  An  <strong>el­e­men­tary func­tion  </strong>  is any el­e­ment of an el­e­men­tary ex­ten­sion of $la­tex \math­b­b{C}(x)$ with the deriva­tion $la­tex D=\frac{d}{dx}$.  A func­tion $la­tex f\in k$ has an  <strong>el­e­men­tary in­te­gral</strong>  over $la­tex k$ if there ex­ists an el­e­men­tary ex­ten­sion $la­tex K$ of $la­tex k$ and $la­tex g\in K$ such that $la­tex Dg=f$, i.e., $la­tex f=\in­t{g}$.   </p> 
 <p>Usu­al­ly, we start with $la­tex \math­b­b{Q}(x)$, the field of ra­tio­nal func­tions in x with ra­tio­nal num­ber co­ef­fi­cients. We then build up an el­e­men­tary ex­ten­sion one func­tion at a time, with each func­tion ei­ther be­ing a log­a­rithm or ex­po­nen­tial of what we have al­ready built up, or al­ge­bra­ic over it.  As I not­ed above, we will ig­nore al­ge­bra­ic func­tions here.  We gen­er­al­ly start with $la­tex \math­b­b{Q}$ be­cause it is com­putable (im­por­tant prob­lems such as the ze­ro equiv­a­lence prob­lem or the prob­lem of de­ter­min­ing cer­tain field iso­mor­phisms are de­cid­able), but the above def­i­ni­tion lets us start with any sub­field of $la­tex \math­b­b{C}$.   </p> 
 <p>Now you may be won­der­ing: we've cov­ered al­ge­bra­ic func­tion­s, ex­po­nen­tials and log­a­rithm­s, and ob­vi­ous­ly ra­tio­nal func­tions are el­e­ments of $la­tex \math­b­b{Q}(x)$, but what about trigono­met­ric func­tion­s?  Well, from a the­o­ret­i­cal stand point, we can make our lives eas­i­er by notic­ing that all the com­mon trigono­met­ric func­tions can be rep­re­sent­ed as ex­po­nen­tials and log­a­rithms over $la­tex \math­b­b{Q}(i)$.  For ex­am­ple, $la­tex \cos{x} = \frac{e^{ix} + e^{-ix}}{2}$.  You can see  <a href="http://en.wikipedia.org/wiki/Trig_identities#Exponential_definitions">here</a>  that all the com­mon trig func­tions can be rep­re­sent­ed as com­plex ex­po­nen­tials or log­a­rithms like this.  How­ev­er, from an al­go­rith­mic stand­point, we don't want do con­vert all trig ex­pres­sions in­to com­plex ex­po­nen­tials and log­a­rithms in or­der to in­te­grate them.  For one thing, our fi­nal re­sult will be in terms of com­plex ex­po­nen­tials and log­a­rithm­s, not the orig­i­nal func­tions we start­ed with, and con­vert­ing them back may or may not be an easy thing to do.  Al­so, aside from the fact that we have dif­fer­ent func­tions than we were ex­pect­ing, we al­so will end up with an an­swer con­tain­ing $la­tex \sqrt{-1}$, even if our orig­i­nal in­te­grand did not.   </p> 
 <p>For­tu­nate­ly, the in­te­grat­ing tan­gents di­rect­ly is a solved prob­lem, just like in­te­grat­ing al­ge­braic, ex­po­nen­tial, or log­a­rith­mic func­tions is solved.  We can't in­te­grate func­tions like $la­tex \s­in{x}$ or $la­tex \cos{x}$ di­rect­ly as mono­mi­als like we can with $la­tex \tan{x}$ or $la­tex e^x$, be­cause the de­riv­a­tives of sin and cos are not poly­no­mi­als in their re­spec­tive selves with co­ef­fi­cients in $la­tex \math­b­b{C}(x)$.  How­ev­er, we can use a trick or two to in­te­grate them.  One way is to re­write $la­tex \cos{x}=\frac{1 - \tan^2{\frac{x}{2}}}{1 + \tan^2{\frac{x}{2}}}$ and pro­ceed to in­te­grate it as a tan­gen­t.  An­oth­er al­ter­na­tive is to write $la­tex \cos{x}=\frac{1}{\sec{x}}=\sqrt{\frac{1}{\sec^2{x}}}=\sqrt{\frac{1}{\­tan^2{x} + 1}}$.  This func­tion is al­ge­bra­ic over $la­tex \math­b­b{Q}(x, \tan{(x)})$, but if we do not al­ready have $la­tex \tan{x}$ in our dif­fer­en­tial ex­ten­sion, it is tran­scen­den­tal, and we can re­write it as $la­tex e^{-\frac{\log{(1 + \tan^2{x})}}{2}}$ (this is used in Bron­stein's tex­t, so I be­lieve what I just said is cor­rec­t, though I haven't ver­i­fied it with the struc­ture the­o­rems just yet).   These both work us­ing the rel­e­vant iden­ti­ties for sin too.  Of course, there is still the prob­lem of rewrit­ing the fi­nal in­te­grand back in terms of sin or cos.  Oth­er­wise, you will get some­thing like $la­tex \frac{2e^x\­tan({\frac{x}{2}}) - \tan^2({\frac{x}{2}})e^x + e^x}{2 + 2\­tan^2({\frac{x}{2}})}$ in­stead of $la­tex \frac{e^x(\s­in{(x)} + \cos{(x)})}{2}$ for $la­tex \in­t{\­cos{(x)}e^xdx}$.  Bron­stein does­n't elab­o­rate on this too much in his book, so it is some­thing that I will have to fig­ure out on my own.</p> 
 <p>The sec­ond op­tion I gave above leads nice­ly in­to the main point I want­ed to make here about el­e­men­tary func­tion­s.  No­tice that ev­ery­where in the def­i­ni­tions above, things de­pend on the field we are work­ing in.  There­fore, $la­tex e^{\­tan{x}}$ can­not be an el­e­men­tary ex­ten­sion over $la­tex \math­b­b{Q}(x)$, but it can be over $la­tex \math­b­b{Q}(x, \tan{x})$.  Al­so, the  <a href="http://en.wikipedia.org/wiki/Error_function">er­ror func­tion</a>, de­fined as $la­tex \math­rm{er­f}{(x)} = \frac{2}{\sqrt{\pi}}\in­t{e^{-x^2}dx}$ can­not be an el­e­men­tary ex­ten­sion over $la­tex \math­b­b{Q}(x)$, but it can over $la­tex \math­b­b{Q}(x, e^{-x^2})$. In fact this is how we can in­te­grate in terms of some spe­cial func­tion­s, in­clud­ing the er­ror func­tion: by man­u­al­ly adding $la­tex e^{-x^2}$ (or what­ev­er) to our dif­fer­en­tial ex­ten­sion.   There­fore, the usu­al def­i­ni­tion of an el­e­men­tary an­ti-derivaitve and the above Risch Al­go­rithm def­i­ni­tion of an el­e­men­tary in­te­gral co­in­cide on­ly when the ex­ten­sion con­sists on­ly of el­e­men­tary func­tions of the form of the usu­al def­i­ni­tion (note that above, our fi­nal fields are $la­tex \math­b­b{Q}(x, \tan{x}, e^{\­tan{x}})$ and $la­tex \math­b­b{Q}(x, e^{-x^2}, \math­rm{er­f}{(x)})$, re­spec­tive­ly).   </p> 
 <p>Orig­i­nal­ly, I was al­so go­ing to talk about Li­ou­ville's The­o­rem in this blog post, but I think it has al­ready got­ten long enough (read "I'm get­ting tired"), so I'll put that off un­til next time.   </p>
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    
        <ul itemprop="keywords" class="tags">
           <li><a class="tag p-category" href="../../../../../categories/mathjax/" rel="tag">mathjax</a></li>
        </ul>

    
        <ul class="pager">
            <li class="previous">
                <a href="../../17/a-hard-week/" rel="prev" title="A hard week">Previous post</a>
            </li>
            <li class="next">
                <a href="../../31/integration-of-primitive-functions/" rel="next" title="Integration of primitive functions">Next post</a>
            </li>
        </ul>

    </nav>
    </aside>
        <section class="comments">
        <h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="asmeurer",
            disqus_url="http://asmeurer.github.io/posts/2010/07/24/the-risch-algorithm-part-2-elementary-functions/",
        disqus_title="The Risch Algorithm: Part 2, Elementary Functions",
        disqus_identifier="cache/posts/2010/07/24/the-risch-algorithm-part-2-elementary-functions.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section>
    
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});</script>
        <script src="../../../../../assets/js/mathjax.js"></script>

</article>

        
       <script>var disqus_shortname="asmeurer";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>



        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:asmeurer@gmail.com">Aaron Meurer</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<p xmlns:dct="http://purl.org/dc/terms/" xmlns:vcard="http://www.w3.org/2001/vcard-rdf/3.0#">
  <a rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/">
    <img src="http://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0">
  </a>

        </p></footer>
    </div>
</div>


            <script src="../../../../../assets/js/all-nocdn.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

<script type="text/javascript" src="../../../../../assets/js/tipuesearch_set.js"></script>
<script type="text/javascript" src="../../../../../assets/js/tipuesearch.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#tipue_search_input').tipuesearch({
        'mode': 'json',
        'contentLocation': '/assets/js/tipuesearch_content.json',
        'showUrl': false
    });
});
</script>


</body>
</html>
