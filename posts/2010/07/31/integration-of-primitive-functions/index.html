<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns#
        article: http://ogp.me/ns/article#
    " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Integration of primitive functions | Aaron Meurer's Blog</title>

    
            <link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../rss.xml">

      <link rel="canonical" href="http://asmeurer.github.io/posts/2010/07/31/integration-of-primitive-functions/">



    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
   tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"], ['$ latex','$'], ['$latex','$'] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
   },
   displayAlign: 'left', // Change this to 'center' to center equations.
   "HTML-CSS": {
       styles: {'.MathJax_Display': {"margin": 0}}
   }
});
</script>

        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    
<link rel="stylesheet" type="text/css" href="../../../../../assets/css/tipuesearch.css">
</head>
<body>
<div id="tipue_search_content" style="margin-left: auto; margin-right: auto; padding: 20px;"></div>



    

    <meta name="author" content="Aaron Meurer">
    
        <meta name="og:title" content="Integration of primitive functions">
        <meta name="og:url" content="http://asmeurer.github.io/posts/2010/07/31/integration-of-primitive-functions/">
            <meta name="og:description" content="Integration of Primitive Functions
So this past week, I had an­oth­er break through in my projec­t.  The  first break through, as you may re­cal­l, was the com­ple­tion of the  in­te­grate_hy­per­ex­p">
        <meta name="og:site_name" content="Aaron Meurer's Blog">
        <meta name="og:type" content="article">

    
        <meta name="twitter:card" content="summary">
            <meta name="twitter:site:id" content="123456">
            <meta name="twitter:creator:id" content="654321">

    





<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://asmeurer.github.io/">Aaron Meurer's Blog</a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../../../../../archive.html">Archives</a>
                </li>
<li>
<a href="../../../../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../../../../rss.xml">RSS</a>

            </li>
</ul>
                
<span class="navbar-form pull-left">
<input type="text" id="tipue_search_input">
</span>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="index.wp" id="sourcelink">Source</a>
    </li>

            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Integration of primitive functions</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Aaron Meurer</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2010-07-31T06:44:31-05:00" itemprop="datePublished" title="Publication date">2010-07-31 06:44</time></a></p>
                <p class="commentline">
        
    <a href=".#disqus_thread" data-disqus-identifier="cache/posts/2010/07/31/integration-of-primitive-functions.html">Comments</a>


        </p>
</div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p></p>
<strong>Integration of Primitive Functions</strong>
<p>So this past week, I had an­oth­er break through in my projec­t.  The  <a href="http://asmeurersympy.wordpress.com/2010/07/12/integration-of-exponential-functions/">first break through</a>, as you may re­cal­l, was the com­ple­tion of the  <code>in­te­grate_hy­per­ex­po­nen­tial()</code>  func­tion, which al­lowed for the in­te­gra­tion in hy­per­ex­po­nen­tial ex­ten­sion­s, in­clud­ing prov­ing the nonex­is­tence of el­e­men­tary in­te­gral­s.  Now I have worked my way up to this lev­el on the oth­er ma­jor half of the in­te­gra­tion al­go­rithm (ac­tu­al­ly, ma­jor third; more on that lat­er): in­te­gra­tion of prim­i­tive el­e­ments.   </p> 
 <p>This time, I can re­fer you to my  <a href="http://asmeurersympy.wordpress.com/2010/07/24/the-risch-algorithm-part-2-elementary-functions/">pre­vi­ous blog post</a>  for def­i­ni­tion­s.  The chief thing here is that there is now a func­tion in my  <tt>in­te­gra­tion3</tt>  branch called  <code>in­te­grate_prim­i­tive()</code>, and it is used pri­mar­i­ly for in­te­grat­ing func­tions with log­a­rithm­s.</p> 
 <p>So, how about some ex­am­ples?  The first one comes from  <a href="http://">Al­go­rithms for com­put­er al­ge­bra By Kei­th O. Ged­des, Stephen R. Cza­por, George Labahn</a>  (ex­am­ple 12.8).  I like it be­cause it con­tains both ex­po­nen­tials and log­a­rithm­s, in a way that they do not de­pend on each oth­er, so it can be in­te­grat­ed with ei­ther  <code>in­te­grate_prim­i­tive()</code>  or  <code>in­te­grate_hy­per­ex­po­nen­tial()</code>.  In ei­ther case, the poly­no­mi­al part is $la­tex \frac{x}{x + 1}$, so re­cur­sive­ly call­ing the oth­er func­tion is not re­quired.  (for those of you who have been fol­low­ing my  <tt>in­te­gra­tion3</tt>  branch, you may no­tice that this is bla­tant­ly tak­en from the com­mit his­to­ry).</p> 
 <p><strong>Hov­er over the code and click on the left­-­most, "view source" icon (a pa­per icon with  <tt>&lt; &gt;</tt>  over it) to view with­out break­s.  Opens in a new win­dow.</strong></p> 
 <div class="codehilite"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">sympy.integrals.risch</span> <span class="kn">import</span> <span class="n">integrate_primitive</span><span class="p">,</span>

<span class="n">integrate_hyperexponential</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>

<span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))))</span><span class="o">/</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span>

<span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">f</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
          <span class="err">⎛</span>                          <span class="mi">2</span>                                                   <span class="err">⎞</span>
          <span class="err">⎜⎛</span>                       <span class="mi">2</span><span class="err">⎞</span>                                                   <span class="mi">2</span><span class="err">⎟</span>
          <span class="err">⎜⎜</span>     <span class="mi">2</span>           <span class="mi">2</span>  <span class="mi">2</span><span class="err">⋅</span><span class="n">x</span> <span class="err">⎟</span>        <span class="err">⎛</span>    <span class="err">⎛</span>           <span class="mi">2</span>      <span class="mi">3</span><span class="err">⎞</span>           <span class="err">⎞</span>  <span class="mi">3</span><span class="err">⋅</span><span class="n">x</span> <span class="err">⎟</span>
<span class="n">x</span><span class="err">⋅</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="err">⋅⎝⎝</span><span class="o">-</span> <span class="n">log</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="err">⋅ℯ</span>    <span class="err">⎠</span>  <span class="o">+</span> <span class="mi">2</span><span class="err">⋅</span><span class="n">x</span><span class="err">⋅⎝</span><span class="n">x</span> <span class="o">-</span> <span class="err">⎝</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="err">⋅</span><span class="n">x</span>  <span class="o">+</span> <span class="mi">2</span><span class="err">⋅</span><span class="n">x</span> <span class="err">⎠⋅</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="err">⎠⋅ℯ</span>    <span class="err">⎠</span>

<span class="err">──────────────────────────────────────────────────────────────────────────────────────────</span>
                                                                <span class="mi">2</span>
                         <span class="err">⎛</span>                                    <span class="mi">2</span><span class="err">⎞</span>
                         <span class="err">⎜</span>   <span class="mi">2</span>                  <span class="err">⎛</span> <span class="mi">2</span>    <span class="mi">3</span><span class="err">⎞</span>  <span class="mi">2</span><span class="err">⋅</span><span class="n">x</span> <span class="err">⎟</span>
                         <span class="err">⎝</span><span class="n">log</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="err">⋅</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="err">⎝</span><span class="n">x</span>  <span class="o">+</span> <span class="n">x</span> <span class="err">⎠⋅ℯ</span>    <span class="err">⎠</span>


<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">var</span><span class="p">(</span><span class="s">'t0, t1'</span><span class="p">)</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="p">(</span><span class="n">t</span><span class="err">₀</span><span class="p">,</span> <span class="n">t</span><span class="err">₁</span><span class="p">)</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">a</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">Poly</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">t1</span><span class="p">),</span> <span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>

<span class="n">t0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">t1</span><span class="p">)</span><span class="o">.</span><span class="n">as_numer_denom</span><span class="p">())</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">a</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span>

<span class="n">Poly</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">t1</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">t1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>

<span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span> <span class="o">-</span>

<span class="mi">4</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">t1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">t0</span><span class="o">*</span> <span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span>

<span class="n">t0</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s">'ZZ[x,t0]'</span><span class="p">)</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">d</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">Poly</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">t1</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span>

<span class="mi">2</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">t1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t0</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">t0</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="n">t0</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span>

<span class="n">domain</span><span class="o">=</span><span class="s">'ZZ[x,t0]'</span><span class="p">)</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">t0</span><span class="p">,</span> <span class="n">t0</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">t1</span><span class="p">)]</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">r</span> <span class="o">=</span> <span class="n">integrate_primitive</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span>

<span class="mi">1</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)])</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">r</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span>

<span class="err">⎛</span>   <span class="err">⎛</span>                <span class="err">⎛</span> <span class="mi">2</span><span class="err">⎞⎞</span>      <span class="err">⎛</span>                <span class="err">⎛</span> <span class="mi">2</span><span class="err">⎞⎞</span>        <span class="err">⎛</span> <span class="mi">2</span><span class="err">⎞</span>                                <span class="err">⎞</span>

<span class="err">⎜</span>   <span class="err">⎜</span>                <span class="err">⎝</span><span class="n">x</span> <span class="err">⎠⎟</span>      <span class="err">⎜</span>                <span class="err">⎝</span><span class="n">x</span> <span class="err">⎠⎟</span>        <span class="err">⎝</span><span class="n">x</span> <span class="err">⎠</span>                <span class="err">⌠</span>               <span class="err">⎟</span>

<span class="err">⎜</span><span class="n">log</span><span class="err">⎝</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="err">⋅ℯ</span>    <span class="err">⎠</span>   <span class="n">log</span><span class="err">⎝</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="err">⋅ℯ</span>    <span class="err">⎠</span>     <span class="n">x</span><span class="err">⋅ℯ</span>    <span class="err">⋅</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>     <span class="err">⎮</span>   <span class="n">x</span>           <span class="err">⎟</span>

<span class="err">⎜─────────────────────────</span> <span class="o">-</span> <span class="err">─────────────────────────</span> <span class="o">-</span> <span class="err">──────────────────────</span> <span class="o">+</span> <span class="err">⎮</span> <span class="err">─────</span> <span class="n">dx</span><span class="p">,</span> <span class="bp">True</span><span class="err">⎟</span>

<span class="err">⎜</span>            <span class="mi">2</span>                           <span class="mi">2</span>                                    <span class="mi">2</span>   <span class="err">⎮</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span>         <span class="err">⎟</span>

<span class="err">⎜</span>                                                           <span class="mi">2</span>           <span class="mi">2</span>  <span class="mi">2</span><span class="err">⋅</span><span class="n">x</span>    <span class="err">⌡</span>               <span class="err">⎟</span>

<span class="err">⎝</span>                                                        <span class="n">log</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="err">⋅ℯ</span>                       <span class="err">⎠</span>
</pre></div>


<p>An ex­pla­na­tion:   <code>f</code>  is the func­tion we are in­te­grat­ing.  Prepars­ing is not im­ple­ment­ed yet, so we have to do it man­u­al­ly in  <tt>[5]</tt>.   <tt>[8]</tt>  is the list of deriva­tions of the mono­mi­als we are work­ing with,  <code>[x, t0, t1]</code>, which rep­re­sent $la­tex x$, $la­tex e^{x^2}$, and $la­tex \log{(x + 1)}$, re­spec­tive­ly. Be­cause the out­er­most mono­mi­al is a log­a­rithm (prim­i­tive), we call  <code>in­te­grate_prim­i­tive()</code>  on it.  The last ar­gu­ment of the func­tion is the back sub­sti­tu­tion list, in re­verse or­der be­cause that is the or­der we have to back sub­sti­tute in.  We can see the re­sult con­tains an un­eval­u­at­ed In­te­gral.  This is be­cause the re­cur­sive calls to in­te­grate over the small­er ex­ten­sions have not yet been im­ple­ment­ed.  In the fi­nal ver­sion,  <code>in­te­grate()</code>  will au­to­mat­i­cal­ly call  <code>rat­in­t()</code>  in this case on it to give the com­plete an­swer.  The sec­ond ar­gu­ment of the re­sult, True, in­di­cates that the in­te­gral was el­e­men­tary and that this is the com­plete in­te­gral.</p> 
 <p>Be­cause the ex­ten­sions did not de­pend on each oth­er, we could have al­so in­te­grat­ed in $la­tex \math­b­b{Q}(x, \log{(x + 1)}, e^{x^2})$ in­stead of $la­tex \math­b­b{Q}(x, e^{x^2}, \log{(x + 1)})$:</p> 
 <div class="codehilite"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">a1</span><span class="p">,</span> <span class="n">d1</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">Poly</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">t0</span><span class="p">),</span> <span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">t0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">t1</span><span class="p">)</span><span class="o">.</span><span class="n">as_numer_denom</span><span class="p">())</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">D1</span> <span class="o">=</span> <span class="p">[</span><span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">t1</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">t0</span><span class="p">,</span> <span class="n">t0</span><span class="p">)]</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">r1</span> <span class="o">=</span> <span class="n">integrate_hyperexponential</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">D1</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t0</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">r1</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span>

<span class="err">⎛</span>   <span class="err">⎛</span>              <span class="err">⎛</span> <span class="mi">2</span><span class="err">⎞⎞</span>      <span class="err">⎛</span>                <span class="err">⎛</span> <span class="mi">2</span><span class="err">⎞⎞</span>                                                <span class="err">⎞</span>

<span class="err">⎜</span>   <span class="err">⎜</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>    <span class="err">⎝</span><span class="n">x</span> <span class="err">⎠⎟</span>      <span class="err">⎜</span>  <span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>    <span class="err">⎝</span><span class="n">x</span> <span class="err">⎠⎟</span>          <span class="err">⎛</span> <span class="mi">2</span><span class="err">⎞</span>                                  <span class="err">⎟</span>

<span class="err">⎜</span><span class="n">log</span><span class="err">⎜──────────</span> <span class="o">+</span> <span class="err">ℯ</span>    <span class="err">⎟</span>   <span class="n">log</span><span class="err">⎜</span><span class="o">-</span> <span class="err">──────────</span> <span class="o">+</span> <span class="err">ℯ</span>    <span class="err">⎟</span>       <span class="mi">2</span>  <span class="err">⎝</span><span class="n">x</span> <span class="err">⎠</span>                  <span class="err">⌠</span>               <span class="err">⎟</span>

<span class="err">⎜</span>   <span class="err">⎝</span>    <span class="n">x</span>             <span class="err">⎠</span>      <span class="err">⎝</span>      <span class="n">x</span>             <span class="err">⎠</span>      <span class="n">x</span> <span class="err">⋅ℯ</span>    <span class="err">⋅</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>       <span class="err">⎮</span>   <span class="n">x</span>           <span class="err">⎟</span>

<span class="err">⎜───────────────────────</span> <span class="o">-</span> <span class="err">─────────────────────────</span> <span class="o">+</span> <span class="err">──────────────────────────</span> <span class="o">+</span> <span class="err">⎮</span> <span class="err">─────</span> <span class="n">dx</span><span class="p">,</span> <span class="bp">True</span><span class="err">⎟</span>

<span class="err">⎜</span>           <span class="mi">2</span>                          <span class="mi">2</span>                                        <span class="mi">2</span>   <span class="err">⎮</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span>         <span class="err">⎟</span>

<span class="err">⎜</span>                                                             <span class="mi">2</span>           <span class="mi">3</span>  <span class="mi">2</span><span class="err">⋅</span><span class="n">x</span>    <span class="err">⌡</span>               <span class="err">⎟</span>

<span class="err">⎝</span>                                                      <span class="o">-</span> <span class="n">x</span><span class="err">⋅</span><span class="n">log</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="err">⋅ℯ</span>                       <span class="err">⎠</span>
</pre></div>


<p>We can ver­i­fy by tak­ing the de­riv­a­tive that the re­sults in each case are anti­deriv­a­tives of the orig­i­nal func­tion,  <code>f</code>, even though they ap­pear dif­fer­en­t.</p> 
 <div class="codehilite"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">cancel</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="mi">0</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">cancel</span><span class="p">(</span><span class="n">r1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="mi">0</span>
</pre></div>


<p>We can see in each case, the re­main­ing un­eval­u­at­ed  <code>In­te­gral</code>  was in $la­tex \math­b­b{Q}(x)$ on­ly, mean­ing that the re­cur­sive call to  <code>in­te­grate_hy­per­ex­po­nen­tial()</code>  or  <code>in­te­grate_prim­i­tive()</code>, re­spec­tive­ly, would not have been nec­es­sary. Fi­nal­ly, we can see that choos­ing the cor­rect ex­ten­sion to in­te­grate over can make a dif­fer­ence, time wise:</p> 
 <div class="codehilite"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">integrate_primitive</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)])</span>

<span class="mi">1</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">1.91</span> <span class="n">s</span> <span class="n">per</span> <span class="n">loop</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">integrate_hyperexponential</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">D1</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t0</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>

<span class="mi">1</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">2.63</span> <span class="n">s</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>


<p>Just as with the ex­po­nen­tial case, the func­tion can prove the in­te­grals are non-ele­men­tary. This is the so-­called  <a href="http://en.wikipedia.org/wiki/Logarithmic_integral">log­a­rith­mic in­te­gral</a>:</p> 
 <div class="codehilite"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">f1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">a</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">Poly</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">t1</span><span class="p">),</span> <span class="n">f1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">t1</span><span class="p">)</span><span class="o">.</span><span class="n">as_numer_denom</span><span class="p">())</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">a</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s">'ZZ'</span><span class="p">)</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">d</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">Poly</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s">'ZZ'</span><span class="p">)</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="n">integrate_primitive</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="p">[</span><span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">t1</span><span class="p">)],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t1</span><span class="p">],</span> <span class="p">[</span><span class="n">log</span><span class="p">])</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>


<p>The sec­ond ar­gu­men­t,  <code>False</code>, in­di­cates that the in­te­gral was non-ele­men­tary.  Name­ly, the func­tion has proven that the func­tion $la­tex f - D(0) = \frac{1}{\log{(x)}}$ does not have an el­e­men­tary an­ti-deriva­tive over $la­tex \math­b­b{Q}(x, \log{(x)})$ (see the  <a href="http://asmeurersympy.wordpress.com/2010/07/12/integration-of-exponential-functions/">pre­vi­ous post</a>  for more in­for­ma­tion).</p> 
 <p>Fi­nal­ly, be aware that, just as with  <code>in­te­grate_hy­per­ex­po­nen­tial()</code>  many in­te­grals will  raise  <code>NotIm­ple­ment­ed­Er­ror</code>, be­cause the sub­rou­tines nec­es­sary to solve them have not yet been fin­ished.</p> 
 <div class="codehilite"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">26</span><span class="p">]:</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">26</span><span class="p">]:</span>

<span class="mi">2</span><span class="err">⋅</span><span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="err">─────────────</span>
   <span class="n">x</span><span class="err">⋅</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="n">In</span> <span class="p">[</span><span class="mi">27</span><span class="p">]:</span> <span class="n">a</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">Poly</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">t1</span><span class="p">),</span>

<span class="n">cancel</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">t0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">t0</span><span class="p">),</span> <span class="n">t1</span><span class="p">)</span><span class="o">.</span><span class="n">as_numer_denom</span><span class="p">())</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="n">a</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s">'ZZ'</span><span class="p">)</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="n">d</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="n">Poly</span><span class="p">(</span><span class="n">t0</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s">'ZZ[x,t0]'</span><span class="p">)</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">30</span><span class="p">]:</span> <span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">t0</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">t0</span><span class="p">),</span> <span class="n">t1</span><span class="p">)]</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">31</span><span class="p">]:</span> <span class="n">integrate_primitive</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">log</span><span class="p">])</span>

<span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NotImplementedError</span><span class="p">:</span> <span class="n">Remaining</span> <span class="n">cases</span> <span class="k">for</span> <span class="n">Poly</span> <span class="n">RDE</span> <span class="ow">not</span> <span class="n">yet</span> <span class="n">implemented</span><span class="o">.</span>
</pre></div>


<p>Now one thing that I want to add from the above ex­am­ples tak­en from the com­mit mes­sage is that log­a­rithms are not the on­ly func­tion that are prim­i­tive.  The Li func­tion (the log­a­rith­mic in­te­gral, as above), con­sid­ered as an el­e­men­tary ex­ten­sion of $la­tex \math­b­b{Q}(x, \log{(x)})$ is al­so prim­i­tive.  But even among the com­mon­ly de­fined el­e­men­tary func­tion­s, there is one oth­er, acr­tan­gents.   </p> 
 <div class="codehilite"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">32</span><span class="p">]:</span> <span class="n">diff</span><span class="p">(</span><span class="n">atan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">32</span><span class="p">]:</span> 

<span class="mi">2</span><span class="err">⋅</span><span class="n">atan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="err">─────────</span>
       <span class="mi">2</span> 
  <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span>  


<span class="n">In</span> <span class="p">[</span><span class="mi">33</span><span class="p">]:</span> <span class="n">integrate_primitive</span><span class="p">(</span><span class="n">Poly</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="p">[</span><span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">t</span><span class="p">)],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">],</span> <span class="p">[</span><span class="n">atan</span><span class="p">])</span>



<span class="n">Out</span><span class="p">[</span><span class="mi">33</span><span class="p">]:</span> 

<span class="err">⎛</span>    <span class="mi">2</span>         <span class="err">⎞</span>

<span class="err">⎝</span><span class="n">atan</span> <span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="bp">True</span><span class="err">⎠</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">34</span><span class="p">]:</span> <span class="n">integrate_primitive</span><span class="p">(</span><span class="n">Poly</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="p">[</span><span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">t</span><span class="p">)],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">],</span> <span class="p">[</span><span class="n">atan</span><span class="p">])</span>



<span class="n">Out</span><span class="p">[</span><span class="mi">34</span><span class="p">]:</span> 

<span class="err">⎛⌠</span>                  <span class="err">⎞</span>

<span class="err">⎜⎮</span> <span class="n">atan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>          <span class="err">⎟</span>

<span class="err">⎜⎮</span> <span class="err">───────</span> <span class="n">dx</span><span class="p">,</span> <span class="bp">False</span><span class="err">⎟</span>

<span class="err">⎜⎮</span>    <span class="n">x</span>             <span class="err">⎟</span>

<span class="err">⎝⌡</span>                  <span class="err">⎠</span>
</pre></div>


<p>Due to a bug in the code right now, the fi­nal ver­sion re­turns the non-ele­men­tary in­te­gral in the fi­nal re­sult.  Suf­fice it to say that it has proven that $la­tex \int {\frac{\arc­tan{(x)}}{x} dx}$ is non-ele­men­tary. As far as I know, this is­n't any spe­cial func­tion.  Ac­tu­al­ly, it's just a ran­dom func­tion con­tain­ing arc­tan that looked non-ele­men­tary to me that I plugged in and found out that I was cor­rec­t.  It's very sim­i­lar in form to the  <a href="http://en.wikipedia.org/wiki/Exponential_integral">ex­po­nen­tial in­te­gral</a>  (Ei) or the  <a href="http://en.wikipedia.org/wiki/Sine_integral#Sine_integral">Sine/­Co­sine In­te­gral</a>  (Si/­Ci), which is how I guessed that it would be non-ele­men­tary.  Maybe it should be called ATi().</p> 
 <p><strong>Sta­tus Up­date</strong></p> 
 <p>So it has come to my at­ten­tion that the sug­gest­ed "pen­cils down" date is one week from Mon­day, and the hard "pen­cils down" date is two weeks from Mon­day (see the  <a href="http://socghop.appspot.com/document/show/gsoc_program/google/gsoc2010/timeline">Google Sum­mer of Code Time­line</a>).  Now, no mat­ter how fast I work, my work can­not be pushed in un­til Ma­teusz's lat­est polys branch gets pushed in, be­cause my work is based on top of it.  I plan on con­tin­u­ing work on the in­te­gra­tion al­go­rithm be­yond the sum­mer un­til I fin­ish the tran­scen­den­tal part of the al­go­rith­m, and even af­ter that, I want to look in­to im­ple­ment­ing oth­er in­te­gra­tion re­lat­ed things, like def­i­nite in­te­gra­tion us­ing  <a href="http://en.wikipedia.org/wiki/Meijer-G">Mei­jer G-­func­tion­s,</a>  and the al­ge­bra­ic part of the al­go­rith­m.  But for now, these are the things that I need to do for the tran­scen­den­tal part, which is this sum­mer's work:</p> 
 <p><em>1. Im­ple­ment the prepars­ing al­go­rithm­s.  </em>  This part is two-­fold.  First, I need to im­ple­ment al­go­rithms based on the Risch Struc­ture The­o­rem­s, which al­low me to de­ter­mine if an ex­ten­sion is al­ge­bra­ic or not (if it is al­ge­braic, we can­not in­te­grate it be­cause on­ly the tran­scen­den­tal part is im­ple­ment­ed).  The oth­er part will be the func­tion that ac­tu­al­ly goes through an ex­pres­sion and tries to build up a dif­fer­en­tial ex­ten­sion from it so it can be in­te­grat­ed.  This can be a tricky part. For ex­am­ple, if we want to in­te­grate $la­tex f = e^x + e^{\frac{x}{2}}$, we want to first choose $la­tex t_1=e^{\frac{x}{2}}$ so that $la­tex f = t_1^2 + t_1$, be­cause if we choose $la­tex t_1=e^x$, then $la­tex t_2=e^{\frac{x}{2}}=\sqrt{t_1}$ will be al­ge­bra­ic over $la­tex \math­b­b{Q}(x, t_1)$.  This is one case where we might try adding an al­ge­bra­ic ex­ten­sions but where it can be avoid­ed.  The so­lu­tion will have to be to go through and find the com­mon de­nom­i­na­tors of the ex­po­nen­tial­s.  I'm al­so con­sid­er­ing that this might hap­pen in more ad­vanced ways, so it could be nec­es­sary for the func­tion to back­track in the ex­ten­sion tree to see if it can do it in an en­tire­ly tran­scen­den­tal way.  For­tu­nate­ly, the Risch Struc­ture The­o­rems give us a de­ci­sion pro­ce­dure for de­ter­min­ing if an ex­ten­sion can be writ­ten in terms of the pre­vi­ous ex­ten­sions (is al­ge­bra­ic over it), but this will still be a very hard func­tion to get right.</p> 
 <p><em>2. Fin­ish the re­main­ing cas­es for  <code>in­te­grate_hy­per­ex­po­nen­tial()</code>  and  <code>in­te­grate_prim­i­tive()</code>.</em>  As you could see in this post, as well as in the  <a href="http://asmeurersympy.wordpress.com/2010/07/12/integration-of-exponential-functions/">pre­vi­ous one</a>, there are many in­te­grals that can­not yet be in­te­grat­ed be­cause the spe­cial cas­es for them have not been im­ple­ment­ed yet.  Most of these ac­tu­al­ly re­ly on im­ple­ment­ing the struc­ture the­o­rem al­go­rithms from  <strong>1</strong>, and im­ple­ment­ing them once that is fin­ished will not take long, be­cause they will just be straight copy­ing of the pseu­docode from Bron­stein's book.  But some of them, par­tic­u­lar­ly ones from the prim­i­tive case, are not spelt out so well in Bron­stein's book, and will re­quire more think­ing (and thus time) on my part.  I should note that the Struc­ture The­o­rem al­go­rithms are al­so this way.</p> 
 <p><em>  3. Im­ple­ment the hy­per­tan­gent case.  </em>  The abil­i­ty to in­te­grate in tan­gent ex­ten­sions is the oth­er  <em>third</em>  I men­tioned above.  Since tan­gents re­quire more spe­cial cas­ing, I plan on do­ing this on­ly af­ter I have fin­ished  <strong>1</strong>  and  <strong>2</strong>.  This is ac­tu­al­ly not much work, be­cause most of the al­go­rithms for solv­ing the par­tic­u­lar sub­prob­lem for tan­gents (called the  <em>Cou­pled Risch Dif­fer­en­tial Equa­tion</em>) are ex­act­ly the same as those for solv­ing the sub­prob­lem for hy­per­ex­po­nen­tials (the  <em>Risch Dif­fer­en­tial Equa­tion</em>), which are al­ready (most­ly) im­ple­ment­ed in the hy­per­ex­po­nen­tial part.  There are on­ly a few ex­tra func­tions that need to be writ­ten for it.  Al­so, you will still be able to in­te­grate func­tions that con­tain tan­gents, such as $la­tex e^{\­tan{(x)}}$ (re­call  <a href="http://asmeurersympy.wordpress.com/2010/07/12/integration-of-exponential-functions/">last time</a>  that we showed that  <code>in­te­grate_hy­per­ex­po­nen­tial()</code>  can prove that this does not have an el­e­men­tary in­te­gral).  It just won't be able to in­te­grate when the top-­most ex­ten­sion is a tan­gen­t.</p> 
 <p>So here is what I plan on do­ing.  Right now, I am go­ing to fo­cus my work on  <strong>1</strong>, since most of  <strong>2</strong>  can't be done un­til it is any­way.  But more im­por­tant­ly, I want to have a pro­to­type user-lev­el func­tion for the Risch Al­go­rith­m.  The rea­son I want this is so that peo­ple can try it out, with­out hav­ing to do the prepars­ing like I did above, but rather they can just call  <code>risch_in­te­grate(f, x)</code>, and it will re­turn the in­te­gral of  <code>f</code>, prove that it is non-ele­men­tary and re­duce it in­to the el­e­men­tary and non-ele­men­tary part­s, or ex­plain why it can­not do it (ei­ther be­cause the func­tion is not tran­scen­den­tal or be­cause some­thing is not im­ple­ment­ed yet).  My chief de­sire for do­ing this is so that peo­ple can try out my code and find the bugs in it for me.  I have al­ready found many crit­i­cal er­rors in the code (re­turns a wrong re­sult), and I want to iron these out be­fore any­thing goes in.  The best way to do this will be to re­lease a work­ing user-lev­el func­tion and hope that peo­ple try it out for me.   </p> 
 <p>Al­so, even if  <strong>2</strong>  and  <strong>3</strong>  are not fin­ished, if I have  <strong>1</strong>, I can in­te­grate it with  <code>in­te­grate()</code>  (no pun in­tend­ed) and just have it bail if it rais­es  <code>NotIm­ple­ment­ed­Er­ror</code>  I will need to come up with a way to dif­fer­en­ti­ate be­tween this and the case where it re­turns an un­eval­u­at­ed  <code>In­te­gral</code>  be­cause it has proven that an el­e­men­tary anti­deriv­a­tive does not ex­ist.  Any sug­ges­tion­s?</p> 
 <p>I plan on con­tin­u­ing work af­ter the sum­mer un­til I fin­ish  <strong>1</strong>  through  <strong>3</strong>, though I won't pre­tend that my work won't slow down con­sid­er­ably when I start class­es in Au­gust.  I al­so prom­ise to fin­ish the  <a href="http://asmeurersympy.wordpress.com/2010/07/12/integration-of-exponential-functions/">Risch Al­go­rithm posts</a>  that I promised.</p> 
 <p>And for what it's worth, I plan on work­ing my ass off this next two week­s.</p>
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    
        <ul itemprop="keywords" class="tags">
           <li><a class="tag p-category" href="../../../../../categories/mathjax/" rel="tag">mathjax</a></li>
        </ul>

    
        <ul class="pager">
            <li class="previous">
                <a href="../../24/the-risch-algorithm-part-2-elementary-functions/" rel="prev" title="The Risch Algorithm: Part 2, Elementary Functions">Previous post</a>
            </li>
            <li class="next">
                <a href="../../../08/05/prototype-risch_integrate-function-ready-for-testing/" rel="next" title="Prototype risch_integrate() function ready for testing!">Next post</a>
            </li>
        </ul>

    </nav>
    </aside>
        <section class="comments">
        <h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="asmeurer",
            disqus_url="http://asmeurer.github.io/posts/2010/07/31/integration-of-primitive-functions/",
        disqus_title="Integration of primitive functions",
        disqus_identifier="cache/posts/2010/07/31/integration-of-primitive-functions.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section>
    
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});</script>
        <script src="../../../../../assets/js/mathjax.js"></script>

</article>

        
       <script>var disqus_shortname="asmeurer";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>



        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:asmeurer@gmail.com">Aaron Meurer</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<p xmlns:dct="http://purl.org/dc/terms/" xmlns:vcard="http://www.w3.org/2001/vcard-rdf/3.0#">
  <a rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/">
    <img src="http://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0">
  </a>

        </p></footer>
    </div>
</div>


            <script src="../../../../../assets/js/all-nocdn.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

<script type="text/javascript" src="../../../../../assets/js/tipuesearch_set.js"></script>
<script type="text/javascript" src="../../../../../assets/js/tipuesearch.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#tipue_search_input').tipuesearch({
        'mode': 'json',
        'contentLocation': '/assets/js/tipuesearch_content.json',
        'showUrl': false
    });
});
</script>


</body>
</html>
