<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns#
        article: http://ogp.me/ns/article#
    " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>The Risch Algorithm: Part 3, Liouville's Theorem | Aaron Meurer's Blog</title>

    
            <link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../rss.xml">

      <link rel="canonical" href="http://asmeurer.github.io/posts/2010/08/14/the-risch-algorithm-part-3-liouvilles-theorem/">



    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
   tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"], ['$ latex','$'] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
   },
   displayAlign: 'left', // Change this to 'center' to center equations.
   "HTML-CSS": {
       styles: {'.MathJax_Display': {"margin": 0}}
   }
});
</script>

        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    
<link rel="stylesheet" type="text/css" href="../../../../../assets/css/tipuesearch.css">
</head>
<body>
<div id="tipue_search_content" style="margin-left: auto; margin-right: auto; padding: 20px;"></div>



    

    <meta name="author" content="Aaron Meurer">
    
        <meta name="og:title" content="The Risch Algorithm: Part 3, Liouville's Theorem">
        <meta name="og:url" content="http://asmeurer.github.io/posts/2010/08/14/the-risch-algorithm-part-3-liouvilles-theorem/">
            <meta name="og:description" content="So this is the last of­fi­cial week of the Sum­mer of Code pro­gram, and my work is most­ly con­sist­ing of re­mov­ing  NotIm­ple­ment­ed­Er­rors (i.e., im­ple­ment­ing stuff), and fix­ing bugs. None ">
        <meta name="og:site_name" content="Aaron Meurer's Blog">
        <meta name="og:type" content="article">

    
        <meta name="twitter:card" content="summary">
            <meta name="twitter:site:id" content="123456">
            <meta name="twitter:creator:id" content="654321">

    





<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://asmeurer.github.io/">Aaron Meurer's Blog</a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../../../../../archive.html">Archives</a>
                </li>
<li>
<a href="../../../../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../../../../rss.xml">RSS</a>

            </li>
</ul>
                
<span class="navbar-form pull-left">
<input type="text" id="tipue_search_input">
</span>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="index.wp" id="sourcelink">Source</a>
    </li>

            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">The Risch Algorithm: Part 3, Liouville's Theorem</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Aaron Meurer</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2010-08-14T02:55:23-05:00" itemprop="datePublished" title="Publication date">2010-08-14 02:55</time></a></p>
                <p class="commentline">
        
    <a href=".#disqus_thread" data-disqus-identifier="cache/posts/2010/08/14/the-risch-algorithm-part-3-liouvilles-theorem.html">Comments</a>


        </p>
</div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p></p>
<p>So this is the last of­fi­cial week of the Sum­mer of Code pro­gram, and my work is most­ly con­sist­ing of re­mov­ing  <code>NotIm­ple­ment­ed­Er­ror</code>s (i.e., im­ple­ment­ing stuff), and fix­ing bugs. None of this is par­tic­u­lar­ly in­ter­est­ing, so in­stead of talk­ing about that, I fig­ured I would pro­duce an­oth­er one of my Risch Al­go­rithm blog post­s.  It is rec­om­mend­ed that you read parts  <a href="http://asmeurersympy.wordpress.com/2010/06/30/the-risch-algorithm-part-1/">1</a>  and  <a href="http://asmeurersympy.wordpress.com/2010/07/24/the-risch-algorithm-part-2-elementary-functions/">2</a>  first, as well as my post on  <a href="http://asmeurersympy.wordpress.com/2010/06/11/integration-of-rational-functions/">ra­tio­nal func­tion in­te­gra­tion</a>, which could be con­sid­ered part 0.</p> 
 <p><strong>Li­ou­ville's The­o­rem</strong></p> 
 <p>Any­one who's tak­en cal­cu­lus in­tu­itive­ly knows that in­te­gra­tion is hard, while dif­fer­en­ti­a­tion is easy.  For dif­fer­en­ti­a­tion, we can pro­duce the de­riv­a­tive of any el­e­men­tary func­tion, and we can do so eas­i­ly, us­ing a sim­ple al­go­rithm con­sist­ing of the sum and prod­uct rules, the chain rule, and the rules for the de­riv­a­tive of all the var­i­ous el­e­men­tary func­tion­s.  But for in­te­gra­tion, we have to try to work back­ward­s.   </p> 
 <p>There are two things that make in­te­gra­tion dif­fi­cult.  First is the ex­is­tence of func­tions that sim­ply do not have any el­e­men­tary anti­deriv­a­tive.  $la­tex e^{-x^2}$ is per­haps the most fa­mous ex­am­ple of such a func­tion, since it aris­es from the nor­mal dis­tri­bu­tion in sta­tis­tics.  But there are many oth­er­s.  $la­tex \s­in{(x^2)}$, $la­tex \frac{1}{\log{(x)}}$, and $la­tex x^x$ are some oth­er ex­am­ples of fa­mous non-in­te­grable func­tion­s.   </p> 
 <p>The sec­ond prob­lem is that no one sin­gle sim­ple rule for work­ing back­wards will al­ways be ap­pli­ca­ble.  We know that u-­sub­sti­tu­tion and in­te­gra­tion by parts are the re­verse of the chain rule and the prod­uct rule, re­spec­tive­ly.  But those meth­ods will on­ly work if those rules were the ones that were ap­plied orig­i­nal­ly, and then on­ly if you chose the right $la­tex u$ and $la­tex dv$.   </p> 
 <p>But there is a much sim­pler ex­am­ple that gets right down to the point with Li­ou­ville's the­o­rem.  The pow­er rule, which is that $la­tex \frac{d}{dx}x^n=nx^{n-1}$ is eas­i­ly re­versed for in­te­gra­tion.  Giv­en the pow­er rule for dif­fer­en­ti­a­tion, it's easy to see that the re­verse rule should be $la­tex \in­t{x^ndx}=\frac{x^{n+1}}{n+1}$.  This works fine, ex­cept that were are di­vid­ing some­thing, $la­tex n+1$.  In math­e­mat­ic­s, when­ev­er we do that, we have to en­sure that what­ev­er we di­vide by is not 0. In this case, it means that we must as­sert $la­tex n\neq -1$.  This ex­cludes $la­tex \in­t{\frac{1}{x}dx}$.  We know from cal­cu­lus that this in­te­gral re­quires us to in­tro­duce a spe­cial func­tion, the nat­u­ral log­a­rith­m.   </p> 
 <p>But we see that $la­tex n=-1$ is the on­ly ex­cep­tion to the pow­er rule, so that the in­te­gral of any (<a href="http://en.wikipedia.org/wiki/Laurent_polynomial">Lau­rent</a>) poly­no­mi­al is again a (Lau­ren­t) poly­no­mi­al, plus a log­a­rith­m.  Re­call from part 0 (<a href="http://asmeurersympy.wordpress.com/2010/06/11/integration-of-rational-functions/">Ra­tio­nal Func­tion In­te­gra­tion</a>) that the same thing is true for any ra­tio­nal func­tion: the in­te­gral is again a ra­tio­nal func­tion, plus a log­a­rithm (we can com­bine mul­ti­ple log­a­rithms in­to one us­ing the log­a­rith­mic iden­ti­ties, so as­sume for sim­plic­i­ty that there is just one).  The ar­gu­ment is very sim­i­lar, too.  As­sume that we have split the de­nom­i­na­tor ra­tio­nal func­tion in­to lin­ear fac­tors in the  <a href="http://en.wikipedia.org/wiki/Algebraic_splitting_field">al­ge­bra­ic split­ting field</a>  (such as the com­plex num­ber­s).  Then per­form a par­tial frac­tions de­com­po­si­tion on the ra­tio­nal func­tion.  Each term in the de­com­po­si­tion will be ei­ther a poly­no­mi­al, or of the form $la­tex \frac{a}{(x - b)^n}$. The in­te­gra­tion of these terms is the same as with the pow­er rule, mak­ing the sub­sti­tu­tion $la­tex u = x - b$. When $la­tex n\geq 2$, the in­te­gral will be $la­tex \frac{-1}{n - 1}\frac{a}{(x - b)^{n - 1}}$; when $la­tex n = 1$, the in­te­gral will be $la­tex a\log{(x - b)}$.  Now com­pu­ta­tion­al­ly, we don't want to work with the al­ge­bra­ic split­ting field, but it turns out that we don't need to ac­tu­al­ly com­pute it to find the in­te­gral.  But the­o­ry is what we are deal­ing with here, so don't wor­ry about that.   </p> 
 <p>Now the key ob­ser­va­tion about dif­fer­en­ti­a­tion, as I have point­ed out in the ear­li­er parts of this blog post se­ries,  is that the de­riv­a­tive of an el­e­men­tary func­tion can be ex­pressed in terms of it­self, in par­tic­u­lar, as a poly­no­mi­al in it­self.  To put it an­oth­er way, func­tions like $la­tex e^x$, $la­tex \tan{(x)}$, and $la­tex \log{(x)}$ all sat­is­fy lin­ear dif­fer­en­tial equa­tions with ra­tio­nal co­ef­fi­cients (e.g., for the­se, $la­tex y'=y$, $la­tex y'=1 + y^2$, and $la­tex y'=\frac{1}{x}$).   </p> 
 <p>Now, the the­o­ry gets more com­pli­cat­ed, but it turns out that, us­ing a care­ful anal­y­sis of this fac­t, we can prove a sim­i­lar re­sult to the one about ra­tio­nal func­tions to any el­e­men­tary func­tion. In a nut­shel­l, Li­ou­ville's The­o­rem says this:  if an el­e­men­tary func­tion has an el­e­men­tary in­te­gral, then that in­te­gral is a com­posed on­ly of func­tions from the orig­i­nal in­te­grand, plus a fi­nite num­ber of log­a­rithms of func­tions from the in­te­grand, which can be con­sid­ered one log­a­rith­m, as men­tioned above ("­func­tions from" more specif­i­cal­ly means a ra­tio­nal func­tion in the terms from our el­e­men­tary ex­ten­sion).  Here is the for­mal state­ment of the the­o­rem.</p> 
 <p><strong>The­o­rem (Liou­ville's The­o­rem - Strong ver­sion)</strong></p> 
 <p><em>Let $la­tex K$ be a dif­fer­en­tial field, $la­tex C=\­math­rm{­Con­st}(K)$, and $la­tex f\in K$. If there ex­ist an el­e­men­tary ex­ten­sion $la­tex E$ of $la­tex K$ and $la­tex g \in E$ such that $la­tex Dg =f$, then there are $la­tex v \in K$, $la­tex c_1, \dot­s, c_n\in \bar{C}$, and $la­tex u_1, \dot­s,u_n\in K(c_1,\­dot­s,c_n)^*$ such that  </em></p> 
 <h2>

$latex f = Dv + \sum_{i=1}^n c_i\frac{Du_i}{u_i}$.

</h2>

<p></p> 
 <p>Look­ing close­ly at the for­mal state­ment of the the­o­rem, we can see that it says the same thing as my "in a nut­shel­l" state­men­t.  $la­tex K$ is the dif­fer­en­tial ex­ten­sion, say of $la­tex \math­b­b{Q}(x)$, that con­tains all of our el­e­men­tary func­tions (see  <a href="http://asmeurersympy.wordpress.com/2010/07/24/the-risch-algorithm-part-2-elementary-functions/">part 2</a>).  $la­tex E$ is an ex­ten­sion of $la­tex K$.  The whole state­ment of the the­o­rem is that $la­tex E$ need not be ex­tend­ed from $la­tex K$ by any­thing more than some log­a­rithm­s.   $la­tex f$ is our orig­i­nal func­tion and $la­tex g=\int f$.  Re­call from  <a href="http://asmeurersympy.wordpress.com/2010/06/30/the-risch-algorithm-part-1/">part 1</a>  that $la­tex Dg = \frac{­Du}{u}$ is just an­oth­er way of say­ing that $la­tex g = \log{(u)}$.  The rest of the for­mal state­ment is some specifics deal­ing with the con­stant field, which as­sure us that we do not need to in­tro­duce any new con­stants in the in­te­gra­tion. This fact is ac­tu­al­ly im­por­tant to the de­cid­abil­i­ty of the Risch Al­go­rith­m, be­cause many prob­lems about con­stants are ei­ther un­known or un­de­cid­able (such as the tran­scen­dence de­gree of $la­tex \math­b­b{Q}(e, \pi)$).  But this en­sures us that as long as we start with a con­stant field that is com­putable, our con­stant field for our anti­deriv­a­tive will al­so be com­putable, and will in fact be the same field, ex­cept for some pos­si­ble al­ge­bra­ic ex­ten­sions (the $la­tex c_i$).   </p> 
 <p>At this point, I want to point out that even though my work this sum­mer has been on­ly on the pure­ly tran­scen­den­tal case of the Risch Al­go­rith­m, Li­ou­ville's The­o­rem is true for all el­e­men­tary func­tion­s, which in­cludes al­ge­bra­ic func­tion­s.  How­ev­er, if you re­view the proof of the the­o­rem, the proof of the al­ge­bra­ic part is com­plete­ly dif­fer­ent from the proof of the tran­scen­den­tal part, which is the first clue that the al­ge­bra­ic part of the al­go­rithm is com­plete­ly dif­fer­ent from the tran­scen­den­tal part (and al­so a clue that it is hard­er).</p> 
 <p>Li­ou­ville's The­o­rem is what al­lows us to prove that a giv­en func­tion does not have an el­e­men­tary an­tideriva­tive, by giv­ing us the form that any anti­deriv­a­tive must have.  We first per­form the same Her­mite Re­duc­tion from the  <a href="http://asmeurersympy.wordpress.com/2010/06/11/integration-of-rational-functions/">ra­tio­nal in­te­gra­tion case</a>. Then, a gen­er­al­iza­tion of the same Lazard-Ri­o­boo-­Trager Al­go­rithm due to Roth­stein al­lows us to find the log­a­rith­mic part of any in­te­gral (the $la­tex \sum_{i=1}^n c_i\frac{­Du_i}{u_i}$ from Li­ou­ville's The­o­rem).   </p> 
 <p>Now a dif­fer­ence here is that some­times, the part of the in­te­grand that cor­re­sponds to the $la­tex \frac{a}{x - b}$ for gen­er­al func­tions does­n't al­ways have an el­e­men­tary in­te­gral (these are called  <em>sim­ple</em>  func­tion­s.  I think I will talk about them in more de­tail in a fu­ture post in this se­ries).   An ex­am­ple of this is $la­tex \frac{1}{\log{(x)}}$.  Suf­fice it to say that any el­e­men­tary in­te­gral of $la­tex \frac{1}{\log{(x)}}$ must be part of some log-ex­ten­sion of $la­tex \math­b­b{Q}(x, \log{(x)})$, and that we can prove that no such log­a­rith­mic ex­ten­sion ex­ists in the course of try­ing to com­pute it with the Lazard-Ri­o­boo-Roth­stein-­Trager Al­go­rith­m.</p> 
 <p>In the ra­tio­nal func­tion case, af­ter we found the ra­tio­nal part and the log­a­rith­mic part, we were prac­ti­cal­ly done, be­cause the on­ly re­main­ing part was a poly­no­mi­al.  Well, for the gen­er­al tran­scen­den­tal func­tion case, we are left with an ana­logue, which are called  <em>re­duced</em>  func­tion­s, and we are far from done.  This is the hard­est part of the in­te­gra­tion al­go­rith­m.  This will al­so be the top­ic of a fu­ture post in this se­ries.  Suf­fice it to say that this is where most of the proofs of non-in­te­gra­bil­i­ty come from, in­clud­ing the oth­er in­te­grals than $la­tex \frac{1}{\log{(x)}}$ that I gave above.   </p> 
 <p><strong>Con­clu­sion</strong></p> 
 <p>That's it for now.  Orig­i­nal­ly, I was al­so go­ing to in­clude a bit on the struc­ture the­o­rems too, but I think I am go­ing to save that for part 4 in­stead.  I may or may not have an­oth­er post ready be­fore the of­fi­cial end of cod­ing date for Google Sum­mer of Code, which is Mon­day (three days from now).  I want to make a post with some nice graphs com­par­ing the tim­ings of the new  <code>risch_in­te­grate()</code>  and the old  <code>heurisch()</code>  (what is cur­rent­ly be­hind SymPy's  <code>in­te­grate()</code>).  But as I have said be­fore, I plan on con­tin­u­ing cod­ing the in­te­gra­tion al­go­rithm be­yond the pro­gram un­til I fin­ish it, and even be­yond that (there are lots of cool ways that the al­go­rithm can be ex­tend­ed to work with spe­cial func­tion­s, there's def­i­nite in­te­gra­tion with Mei­jer-G func­tion­s, and there's of course the al­ge­bra­ic part of the al­go­rith­m, which is a much larg­er chal­lenge).  And along with it, I plan to con­tin­ue keep­ing you up­dat­ed with blog post­s, in­clud­ing at least all the Risch Al­go­rithm se­ries posts that I have promised (I have count­ed at least three top­ics that I have ex­plic­it­ly promised but haven't done yet).  And of course, there will be the manda­to­ry GSoC wrap-up blog post, de­tail­ing my work for the sum­mer.   </p> 
 <p>Please con­tin­ue to test my pro­to­type  <a href="http://asmeurersympy.wordpress.com/2010/08/05/prototype-risch_integrate-function-ready-for-testing/"><code>risch_in­te­grate()</code></a>  func­tion in my  <a href="http://github.com/asmeurer/sympy/tree/integration3">in­te­gra­tion3</a>  branch, and tell me what you think (or if you find a bug).</p>
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    
        <ul itemprop="keywords" class="tags">
           <li><a class="tag p-category" href="../../../../../categories/mathjax/" rel="tag">mathjax</a></li>
        </ul>

    
        <ul class="pager">
            <li class="previous">
                <a href="../../05/prototype-risch_integrate-function-ready-for-testing/" rel="prev" title="Prototype risch_integrate() function ready for testing!">Previous post</a>
            </li>
            <li class="next">
                <a href="../../../12/27/major-api-change-for-the-risch-algorithm-functions/" rel="next" title="Major API Change for the Risch Algorithm Functions">Next post</a>
            </li>
        </ul>

    </nav>
    </aside>
        <section class="comments">
        <h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="asmeurer",
            disqus_url="http://asmeurer.github.io/posts/2010/08/14/the-risch-algorithm-part-3-liouvilles-theorem/",
        disqus_title="The Risch Algorithm: Part 3, Liouville's Theorem",
        disqus_identifier="cache/posts/2010/08/14/the-risch-algorithm-part-3-liouvilles-theorem.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section>
    
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});</script>
        <script src="../../../../../assets/js/mathjax.js"></script>

</article>

        
       <script>var disqus_shortname="asmeurer";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>



        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:asmeurer@gmail.com">Aaron Meurer</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<p xmlns:dct="http://purl.org/dc/terms/" xmlns:vcard="http://www.w3.org/2001/vcard-rdf/3.0#">
  <a rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/">
    <img src="http://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0">
  </a>

        </p></footer>
    </div>
</div>


            <script src="../../../../../assets/js/all-nocdn.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

<script type="text/javascript" src="../../../../../assets/js/tipuesearch_set.js"></script>
<script type="text/javascript" src="../../../../../assets/js/tipuesearch.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#tipue_search_input').tipuesearch({
        'mode': 'json',
        'contentLocation': '/assets/js/tipuesearch_content.json',
        'showUrl': false
    });
});
</script>


</body>
</html>
