<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns#
        article: http://ogp.me/ns/article#
    " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Integration of rational functions | Aaron Meurer's Blog</title>

    
            <link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../rss.xml">

      <link rel="canonical" href="http://asmeurer.github.io/posts/2010/06/11/integration-of-rational-functions/">



    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
   tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"], ['$ latex','$'], ['$latex','$'] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
   },
   displayAlign: 'left', // Change this to 'center' to center equations.
   "HTML-CSS": {
       styles: {'.MathJax_Display': {"margin": 0}}
   }
});
</script>

        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    
<link rel="stylesheet" type="text/css" href="../../../../../assets/css/tipuesearch.css">
</head>
<body>
<div id="tipue_search_content" style="margin-left: auto; margin-right: auto; padding: 20px;"></div>



    

    <meta name="author" content="Aaron Meurer">
    
        <meta name="og:title" content="Integration of rational functions">
        <meta name="og:url" content="http://asmeurer.github.io/posts/2010/06/11/integration-of-rational-functions/">
            <meta name="og:description" content="So for this week's blog post I will try to ex­plain how the gen­er­al al­go­rithm for in­te­grat­ing ra­tio­nal func­tions work­s.  Re­call that a  ra­tio­nal func­tion  is the quo­tient of two poly­n">
        <meta name="og:site_name" content="Aaron Meurer's Blog">
        <meta name="og:type" content="article">

    
        <meta name="twitter:card" content="summary">
            <meta name="twitter:site:id" content="123456">
            <meta name="twitter:creator:id" content="654321">

    





<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://asmeurer.github.io/">Aaron Meurer's Blog</a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../../../../../archive.html">Archives</a>
                </li>
<li>
<a href="../../../../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../../../../rss.xml">RSS</a>

            </li>
</ul>
                
<span class="navbar-form pull-left">
<input type="text" id="tipue_search_input">
</span>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="index.wp" id="sourcelink">Source</a>
    </li>

            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Integration of rational functions</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Aaron Meurer</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2010-06-11T19:39:58-05:00" itemprop="datePublished" title="Publication date">2010-06-11 19:39</time></a></p>
                <p class="commentline">
        
    <a href=".#disqus_thread" data-disqus-identifier="cache/posts/2010/06/11/integration-of-rational-functions.html">Comments</a>


        </p>
</div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p></p>
<p>So for this week's blog post I will try to ex­plain how the gen­er­al al­go­rithm for in­te­grat­ing ra­tio­nal func­tions work­s.  Re­call that a  <a href="http://en.wikipedia.org/wiki/Rational_function">ra­tio­nal func­tion</a>  is the quo­tient of two poly­no­mi­al­s.  We know that us­ing com­mon de­nom­i­na­tors, we can con­vert the sum of any num­ber of ra­tio­nal func­tions in­to a sin­gle quo­tien­t, $la­tex \frac{a_nx^n + a_{n-1}x^{n-1} + \c­dots + a_2x^2 + a_1x + a_0}{b_nx^n + b_{n-1}x^{n-1} + \c­dots + b_2x^2 + a_1x + a_0}$.  Al­so, us­ing  <a href="http://en.wikipedia.org/wiki/Polynomial_division">poly­no­mi­al di­vi­sion</a>  we can re­write any ra­tio­nal func­tion as the sum of a poly­no­mi­al and the quo­tient of two poly­no­mi­als such that the de­gree of the nu­mer­a­tor is less than the de­gree of the de­nom­i­na­tor ($la­tex F(x) = \frac{b(x)}{c(x)} = p(x) + \frac{r(x)}{g(x)}$, with $la­tex deg(r) &lt; deg(g)$).  Fur­ther­more, we know that the rep­re­sen­ta­tion of a ra­tio­nal func­tion is not unique.  For ex­am­ple, $la­tex \frac{(x + 1)(x - 1)}{(x + 2)(x - 1)}$ is the same as $la­tex \frac{x + 1}{x + 2}$ ex­cept at the point $la­tex x = 1$, and $la­tex \frac{(x - 1)^2}{x - 1}$ is the same as $la­tex x - 1$ ev­ery­where.  But by us­ing  <a href="http://en.wikipedia.org/wiki/Euclid%27s_algorithm_for_polynomials#Polynomials">Eu­clid's al­go­rithm</a>  for find­ing the GCD of poly­no­mi­als on the nu­mer­a­tor and the de­nom­i­na­tor, along with poly­no­mi­al di­vi­sion on each,  we can can­cel all com­mon fac­tors to get a rep­re­sen­ta­tion that is unique (as­sum­ing we ex­pand all fac­tors in­to one poly­no­mi­al).  Fi­nal­ly, us­ing poly­no­mi­al di­vi­sion with re­main­der, we can re­write any ra­tio­nal func­tion $la­tex F(x)$ as $la­tex \frac{a(x)}{b(x)} = p(x) + \frac{a(x)}{d(x)}$, where $la­tex a(x)$, $la­tex b(x)$, $la­tex c(x)$, $la­tex d(x)$, and $la­tex p(x)$ are all poly­no­mi­al­s, and the de­gree of $la­tex a$ is less than the de­gree of $la­tex d$.   </p> 
 <p>We know from cal­cu­lus that the in­te­gral of any ra­tio­nal func­tion con­sists of three part­s: the poly­no­mi­al part, the ra­tio­nal part, and the log­a­rith­mic part (con­sid­er arc­tan­gents as com­plex log­a­rithm­s).  The poly­no­mi­al part is just the in­te­gral of $la­tex p(x)$ above.  The ra­tio­nal part is an­oth­er ra­tio­nal func­tion, and the log­a­rith­mic part, which is a sum of log­a­rithms of the form $la­tex a\log{s(x)}$, where $la­tex a$ is an al­ge­bra­ic con­stant and $la­tex s(x)$ is a poly­no­mi­al (note that if $la­tex s(x)$ is a ra­tio­nal func­tion, we can split it in­to two log­a­rithms of poly­no­mi­als us­ing the log iden­ti­ties).   </p> 
 <p>To find the ra­tio­nal part, we first need to know about square-free fac­tor­iza­tion­s.  An im­por­tant re­sult in al­ge­bra is that any poly­no­mi­al with ra­tio­nal co­ef­fi­cients can be fac­tored unique­ly in­to ir­re­duc­ible poly­no­mi­als with ra­tio­nal co­ef­fi­cients, up to mul­ti­pli­ca­tion of a non-ze­ro con­stant and re­order­ing of fac­tors, sim­i­lar to how any in­te­ger can be fac­tored unique­ly in­to primes up to mul­ti­pli­ca­tion of 1 and -1 and re­order­ing of fac­tors (tech­ni­cal­ly, it is with co­ef­fi­cients from a unique fac­tor­iza­tion do­main, for which the ra­tio­nals is a spe­cial case, and up to mul­ti­pli­ca­tion of a unit, which for ra­tio­nals is ev­ery non-ze­ro con­stan­t).  A poly­no­mi­al is square-free if this unique fac­tor­iza­tion does not have any poly­no­mi­als with pow­ers greater than 1.  An­oth­er the­o­rem from al­ge­bra tells us that ir­re­duc­ible poly­no­mi­als over the ra­tio­nals do not have any re­peat­ed root­s, and so giv­en this, it is not hard to see that a poly­no­mi­al be­ing square-free is equiv­a­lent to it not hav­ing re­peat­ed root­s.   </p> 
 <p>A  <a href="http://en.wikipedia.org/wiki/Square-free_factorization">square-free fac­tor­iza­tion</a>  of a poly­no­mi­al is a list of poly­no­mi­al­s, $la­tex P_1P_2^2 \c­dots P_n^n$, where each $la­tex P_i$ is square-free (in oth­er word­s, $la­tex P_1$ is the prod­uct of all the fac­tors of de­gree 1, $la­tex P_2$ is the prod­uct of all the fac­tors of de­gree 2, and so on).  There is a rel­a­tive­ly sim­ple al­go­rithm to com­pute the square-free fac­tor­iza­tion of a poly­no­mi­al, which is based on the fact that $la­tex gcd(P, \frac{d­p}{dx})$ re­duces the pow­er of each ir­re­duc­ible fac­tor by 1.  For ex­am­ple:</p> 
 <p><a href="../../../../../2010/06/gcd.png"><img src="../../../../../2010/06/gcd.png" alt="" title="gcd" width="246" height="175" class="alignnone size-full wp-image-420"></a></p> 
 <p>(Sor­ry for the pic­ture.   Word­Press code blocks do not work)</p> 
 <p>It is not too hard to prove this us­ing the prod­uct rule on the fac­tor­iza­tion of P.  So you can see that by com­put­ing $la­tex \frac{P}{gcd(P, \frac{d­P}{dx})}$, you can ob­tain $la­tex P_1P_2\c­dots P_n$.  Then, by re­cur­sive­ly com­put­ing $la­tex A_0 = P$, $la­tex A_1 = gcd(A_0, \frac{­dA_0}{dx})$, $la­tex A2 = gcd(A_1, \frac{­dA_1}{dx})$, … and tak­ing the quo­tient each time as above, we can find the square-free fac­tors of P.   </p> 
 <p>OK, so we know from par­tial frac­tion de­com­po­si­tions we learned in cal­cu­lus that if we have a ra­tio­nal func­tion of the form $la­tex \frac{Q(x)}{V(x)^n}$ , where $la­tex V(x)$ is square-free, the in­te­gral will be a ra­tio­nal func­tion if $la­tex n &gt; 1$ and a log­a­rithm if $la­tex n = 1$.  We can use the par­tial frac­tion de­com­po­si­tion that is easy to find once we have the square-free fac­tor­iza­tion of the de­nom­i­na­tor to re­write the re­main­ing ra­tio­nal func­tion as a sum of terms of the form $la­tex \frac{Q}{V_k^k}$, where $la­tex V_i$ is square-free.  Be­cause $la­tex V$ is square-free, $la­tex gcd(V, V')=1$, so the  <a href="http://en.wikipedia.org/wiki/Extended_Euclidean_algorithm">Ex­tend­ed Eu­clidean Al­go­rithm</a>  gives us $la­tex B_0$ and $la­tex C_0$ such that $la­tex B_0V + C_0V'=1$ (re­call that $la­tex g$ is the gcd of $la­tex p$ and $la­tex q$ if and on­ly if there ex­ist $la­tex a$ and $la­tex b$ rel­a­tive­ly prime to $la­tex g$ such that $la­tex ap+bq=g$.  This holds true for in­te­gers as well as poly­no­mi­al­s). Thus we can find $la­tex B$ and $la­tex C$ such that $la­tex BV + CV'= \frac{Q}{1-k}$.  Mul­ti­ply­ing through by $la­tex \frac{1-k}{V^k}$, $la­tex \frac{Q}{V^k}=-\frac{(k-1)B­V'}{V^k} + \frac{(1-k)C}{V^{k-1}}$, which is equal to $la­tex \frac{Q}{V^k} = (\frac{B'}{V^{k-1}} - \frac{(k-1)B­V'}{V^k}) + \frac{(1-k)C-B'}{V^{k-1}}$.  You may no­tice that the term in the paren­the­sis is just the de­riv­a­tive of  $la­tex \frac{B}{V^{k-1}}$, so we get $la­tex \in­t\frac{Q}{V^k}=\frac{B}{V^{k-1}} + \in­t\frac{(1-k)C - B'}{V^{k-1}}$.  This is called Her­mite Re­duc­tion.  We can re­cur­sive­ly re­duce the in­te­gral on the right hand side un­til the $la­tex k=1$. Note that there are more ef­fi­cient ways of do­ing this that do not ac­tu­al­ly re­quire us to com­pute the par­tial frac­tion de­com­po­si­tion, and there is al­so a lin­ear ver­sion due to Mack (this one is quadrat­ic), and an even more ef­fi­cient al­go­rithm called the Horow­itz-Ostro­grad­sky Al­go­rith­m, that does­n't even re­quire a square-free de­com­po­si­tion.   </p> 
 <p>So when we have fin­ished the Her­mite Re­duc­tion, we are left with in­te­grat­ing ra­tio­nal func­tions with pure­ly square-free de­nom­i­na­tors.  We know from cal­cu­lus that these will have log­a­rith­mic in­te­gral­s, so this is the log­a­rith­mic part.   </p> 
 <p>First, we need to look at re­sul­tants and PRSs. The  <a href="http://en.wikipedia.org/wiki/Resultant">re­sul­tant</a>  of two poly­no­mi­als is de­fined as dif­fer­ences of the roots of the two poly­no­mi­al­s, i.e., $la­tex re­sul­tan­t(A, B) = \prod_{i=1}^n\prod_{j=1}^m (\al­pha_i - \be­ta_j)$, where $la­tex A = (x - \al­pha_1)\c­dot­s(x - \al­pha_n)$ and $la­tex B = (x - \be­ta_1)\c­dot­s(x - \be­ta_m)$ are mon­ic poly­no­mi­als split in­to lin­ear fac­tors.  Clear­ly, the re­sul­tant of two poly­no­mi­als is 0 if and on­ly if the two poly­no­mi­als share a root. It is an im­por­tant re­sult that the re­sul­tant of two poly­no­mi­als can be com­put­ed from on­ly their co­ef­fi­cients by tak­ing the de­ter­mi­nant of the  <a href="http://en.wikipedia.org/wiki/Sylvester_matrix">Sylvester Ma­trix</a>  of the two poly­no­mi­al­s.  How­ev­er, it is more ef­fi­cient­ly cal­cu­lat­ed us­ing a poly­no­mi­al re­main­der se­quence  (PRS) (sor­ry, there does­n't seem to be a Wikipedia ar­ti­cle), which in ad­di­tion to giv­ing the re­sul­tant of A and B, al­so gives a se­quence of poly­no­mi­als with some use­ful prop­er­ties that I will dis­cuss be­low.  A poly­no­mi­al re­main­der se­quence is a gen­er­al­iza­tion of the Eu­clid­i­an al­go­rithm where in each step, the re­main­der $la­tex R_i$ is mul­ti­plied by a con­stant $la­tex \be­ta_i$.  The Fun­da­men­tal PRS The­o­rem shows how to com­pute spe­cif­ic $la­tex \be­ta_i$ such that the re­sul­tant can be cal­cu­lat­ed from the poly­no­mi­als in the se­quence.  </p> 
 <p>Then, if we have $la­tex \frac{A}{D}$, left over from the Her­mite Re­duc­tion (so $la­tex D$ square-free), let $la­tex R=re­sul­tan­t_t(A-t\frac{d­D}{dx}, D)$, where $la­tex t$ is a new vari­able, and $la­tex \al­pha_i$ be the dis­tinct roots of R.  Let $la­tex p_i=\gcd(A - \al­pha_i\frac{d­D}{dx}, D)$.  Then it turns out that the log­a­rith­mic part of the in­te­gral is just $la­tex \al­pha_1\log{p_1} + \al­pha_2\log{p_2} + \c­dots \al­pha_n\log{p_n}$.  This is called the Roth­stein-­Trager Al­go­rith­m.</p> 
 <p>How­ev­er, this re­quires find­ing the prime fac­tor­iza­tion of the re­sul­tan­t, which can be avoid­ed if a more ef­fi­cient al­go­rithm called the Lazard-Ri­o­boo-­Trager Al­go­rithm is used. I will talk a lit­tle bit about it.  It works by us­ing sub­re­sul­tant poly­no­mi­al re­minder se­quences.  </p> 
 <p>It turns out that the above $la­tex gcd(A-\al­pha\frac{d­D}{dx}, D)$ will ap­pear in the PRS of $la­tex D$ and $la­tex A-t\frac{d­D}{dx}$.  Fur­ther­more, we can use the PRS to im­me­di­ate­ly find the re­sul­tant $la­tex R=re­sul­tan­t_t(A-t\frac{d­D}{dx}, D)$, which as we saw, is all we need to com­pute the log­a­rith­mic part.   </p> 
 <p>So that's ra­tio­nal in­te­gra­tion.  I hope I haven't bored you too much, and that this made at least a lit­tle sense.  I al­so hope that it was all cor­rec­t.  Note that this en­tire al­go­rithm has al­ready been im­ple­ment­ed in SymPy, so if you plug a ra­tio­nal func­tion in to  <code>in­te­grate()</code>, you should get back a so­lu­tion.  How­ev­er, I de­scribe it here be­cause the tran­scen­den­tal case of the Risch Al­go­rithm is just a gen­er­al­iza­tion of ra­tio­nal func­tion in­te­gra­tion.</p> 
 <p>As for work up­dates, I found that the Poly ver­sion of the heur­sitic Risch al­go­rithm was con­sid­er­ably slow­er than the orig­i­nal ver­sion, due to in­ef­fi­cien­cies in the way the poly­no­mi­als are cur­rent­ly rep­re­sent­ed in SymPy.  So I have put that aside, and I have start­ed im­ple­ment­ing al­go­rithms from the full al­go­rith­m.  There's not much to say on that fron­t.  It's te­dious work.  I copy the al­go­rithm from Bron­stein's book, then try make sure that it is cor­rect based on the few ex­am­ples giv­en and from the math­e­mat­i­cal back­ground given, and when I'm sat­is­fied, I move on to the next one.  Fol­low my  <a href="http://github.com/asmeurer/sympy/tree/integration">in­te­gra­tion</a>  branch if you are in­ter­est­ed.</p> 
 <p>In my next post, I'll try to de­fine some terms, like "ele­men­tary func­tion," and in­tro­duce a lit­tle dif­fer­en­tial al­ge­bra, so you can un­der­stand a lit­tle bit of the na­ture of the gen­er­al in­te­gra­tion al­go­rith­m.</p>
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    
        <ul itemprop="keywords" class="tags">
           <li><a class="tag p-category" href="../../../../../categories/mathjax/" rel="tag">mathjax</a></li>
        </ul>

    
        <ul class="pager">
            <li class="previous">
                <a href="../../04/pudb-a-better-python-debugger/" rel="prev" title="PuDB, a better Python debugger">Previous post</a>
            </li>
            <li class="next">
                <a href="../../15/a-weeklog/" rel="next" title="A Weeklog">Next post</a>
            </li>
        </ul>

    </nav>
    </aside>
        <section class="comments">
        <h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="asmeurer",
            disqus_url="http://asmeurer.github.io/posts/2010/06/11/integration-of-rational-functions/",
        disqus_title="Integration of rational functions",
        disqus_identifier="cache/posts/2010/06/11/integration-of-rational-functions.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section>
    
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});</script>
        <script src="../../../../../assets/js/mathjax.js"></script>

</article>

        
       <script>var disqus_shortname="asmeurer";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>



        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:asmeurer@gmail.com">Aaron Meurer</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<p xmlns:dct="http://purl.org/dc/terms/" xmlns:vcard="http://www.w3.org/2001/vcard-rdf/3.0#">
  <a rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/">
    <img src="http://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0">
  </a>

        </p></footer>
    </div>
</div>


            <script src="../../../../../assets/js/all-nocdn.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

<script type="text/javascript" src="../../../../../assets/js/tipuesearch_set.js"></script>
<script type="text/javascript" src="../../../../../assets/js/tipuesearch.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#tipue_search_input').tipuesearch({
        'mode': 'json',
        'contentLocation': '/assets/js/tipuesearch_content.json',
        'showUrl': false
    });
});
</script>


</body>
</html>
