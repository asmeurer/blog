<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns#
        article: http://ogp.me/ns/article#
    " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Strange Python Behavior (can someone please explain to me what is going on here?) | Aaron Meurer's Blog</title>

    
            <link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../rss.xml">

      <link rel="canonical" href="http://asmeurer.github.io/posts/2010/06/16/strange-python-behavior-can-someone-please-explain-to-me-what-is-going-on-here/">



    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
   tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"], ['$ latex','$'], ['$latex','$'] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
   },
   displayAlign: 'left', // Change this to 'center' to center equations.
   "HTML-CSS": {
       styles: {'.MathJax_Display': {"margin": 0}}
   }
});
</script>

        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    
<link rel="stylesheet" type="text/css" href="../../../../../assets/css/tipuesearch.css">
</head>
<body>
<div id="tipue_search_content" style="margin-left: auto; margin-right: auto; padding: 20px;"></div>



    

    <meta name="author" content="Aaron Meurer">
    
        <meta name="og:title" content="Strange Python Behavior (can someone please explain to me what is goin">
        <meta name="og:url" content="http://asmeurer.github.io/posts/2010/06/16/strange-python-behavior-can-someone-please-explain-to-me-what-is-going-on-here/">
            <meta name="og:description" content="Every once in a while, seemingly really simple Python code does something completely unexpected for me. Look at the following snippet of Python code.  This is run straight from the 2.6.5 interpreter, ">
        <meta name="og:site_name" content="Aaron Meurer's Blog">
        <meta name="og:type" content="article">

    
        <meta name="twitter:card" content="summary">
            <meta name="twitter:site:id" content="123456">
            <meta name="twitter:creator:id" content="654321">

    





<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://asmeurer.github.io/">Aaron Meurer's Blog</a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../../../../../archive.html">Archives</a>
                </li>
<li>
<a href="../../../../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../../../../rss.xml">RSS</a>

            </li>
</ul>
                
<span class="navbar-form pull-left">
<input type="text" id="tipue_search_input">
</span>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="index.wp" id="sourcelink">Source</a>
    </li>

            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Strange Python Behavior (can someone please explain to me what is going on here?)</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Aaron Meurer</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2010-06-16T04:49:06-05:00" itemprop="datePublished" title="Publication date">2010-06-16 04:49</time></a></p>
                <p class="commentline">
        
    <a href=".#disqus_thread" data-disqus-identifier="cache/posts/2010/06/16/strange-python-behavior-can-someone-please-explain-to-me-what-is-going-on-here.html">Comments</a>


        </p>
</div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p></p>
<a href="http://asmeurersympy.wordpress.com/2009/07/20/modifying-a-list-while-looping-through-it-in-python/">Every once in a while</a>, seemingly really simple Python code does something completely unexpected for me. Look at the following snippet of Python code.  This is run straight from the 2.6.5 interpreter, with no other commands executed.  Do you notice anything strange?
<div class="codehilite"><pre><span class="err">$</span><span class="n">python</span>

<span class="n">Python</span> <span class="mf">2.6</span><span class="o">.</span><span class="mi">5</span> <span class="p">(</span><span class="n">r265</span><span class="p">:</span><span class="mi">79359</span><span class="p">,</span> <span class="n">Mar</span> <span class="mi">24</span> <span class="mi">2010</span><span class="p">,</span> <span class="mo">01</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">55</span><span class="p">)</span> 

<span class="p">[</span><span class="n">GCC</span> <span class="mf">4.0</span><span class="o">.</span><span class="mi">1</span> <span class="p">(</span><span class="n">Apple</span> <span class="n">Inc</span><span class="o">.</span> <span class="n">build</span> <span class="mi">5493</span><span class="p">)]</span> <span class="n">on</span> <span class="n">darwin</span>

<span class="n">Type</span> <span class="s">"help"</span><span class="p">,</span> <span class="s">"copyright"</span><span class="p">,</span> <span class="s">"credits"</span> <span class="ow">or</span> <span class="s">"license"</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>

<span class="o">&gt;&gt;&gt;</span><span class="p">;</span> <span class="n">l</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">l</span>

<span class="o">&lt;</span><span class="n">function</span> <span class="n">at</span><span class="o">=</span><span class="s">""</span> <span class="n">replaceme</span> <span class="n">h</span><span class="o">=</span><span class="s">"[(1,"</span> <span class="n">l</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">did</span> <span class="n">you</span> <span class="n">spot</span> <span class="n">it</span> <span class="n">here</span> <span class="ow">is</span> <span class="n">hint</span><span class="o">.</span> <span class="n">running</span> <span class="n">different</span> <span class="n">but</span> <span class="n">similar</span> <span class="n">session</span><span class="p">:</span> <span class="n">python</span> <span class="n">mar</span> <span class="n">inc</span><span class="o">.</span> <span class="n">build</span> <span class="n">on</span> <span class="n">darwin</span> <span class="nb">type</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span> <span class="n">i</span><span class="p">:</span> <span class="n">traceback</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span> <span class="nb">file</span> <span class="n">line</span> <span class="n">nameerror</span><span class="p">:</span> <span class="k">global</span> <span class="n">name</span> <span class="ow">not</span> <span class="n">defined</span> <span class="n">do</span> <span class="n">see</span> <span class="n">now</span> <span class="n">i</span> <span class="n">the</span> <span class="k">lambda</span> <span class="n">function</span><span class="o">&gt;</span><span class="n">l</span> <span class="ow">in</span> <span class="n">terms</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">a</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="n">without</span> <span class="n">defining</span> <span class="n">first</span> <span class="n">defining</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">a</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;</span><span class="err">!</span>  <span class="n">And</span> <span class="n">furthermore</span><span class="p">,</span> <span class="n">it</span> <span class="n">just</span> <span class="n">works</span> <span class="n">when</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">a</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">defined</span><span class="o">.</span>  <span class="n">This</span> <span class="ow">is</span> <span class="n">actually</span> <span class="n">independent</span> <span class="n">of</span> <span class="n">the</span> <span class="n">fact</span> <span class="n">that</span> <span class="n">we</span> <span class="n">are</span> <span class="n">working</span> <span class="ow">in</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">comprehension</span><span class="p">,</span> <span class="k">as</span> <span class="n">this</span> <span class="n">continuation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">previous</span> <span class="n">session</span> <span class="n">shows</span><span class="p">:</span>



<span class="sb">``</span><span class="err">`</span><span class="n">py</span>


<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">l</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="mi">3</span>
</pre></div>


<p>But I want to ex­pand on the list com­pre­hen­sion ex­am­ple, be­cause there even more biz­zare things go­ing on here.  Restart­ing a new ses­sion again:</p> 
 <div class="codehilite"><pre><span class="err">$</span><span class="n">python</span>

<span class="n">Python</span> <span class="mf">2.6</span><span class="o">.</span><span class="mi">5</span> <span class="p">(</span><span class="n">r265</span><span class="p">:</span><span class="mi">79359</span><span class="p">,</span> <span class="n">Mar</span> <span class="mi">24</span> <span class="mi">2010</span><span class="p">,</span> <span class="mo">01</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">55</span><span class="p">)</span> 

<span class="p">[</span><span class="n">GCC</span> <span class="mf">4.0</span><span class="o">.</span><span class="mi">1</span> <span class="p">(</span><span class="n">Apple</span> <span class="n">Inc</span><span class="o">.</span> <span class="n">build</span> <span class="mi">5493</span><span class="p">)]</span> <span class="n">on</span> <span class="n">darwin</span>

<span class="n">Type</span> <span class="s">"help"</span><span class="p">,</span> <span class="s">"copyright"</span><span class="p">,</span> <span class="s">"credits"</span> <span class="ow">or</span> <span class="s">"license"</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">l</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">l</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">H</span><span class="p">]</span>

<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">l</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">l</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">H</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">generator</span> <span class="nb">object</span><span class="o">=</span><span class="s">""</span> <span class="n">at</span><span class="o">=</span><span class="s">""</span> <span class="n">replaceme</span> <span class="nb">list</span> <span class="n">l</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">h</span> <span class="n">so</span> <span class="k">if</span> <span class="n">you</span> <span class="n">are</span> <span class="n">astute</span> <span class="ow">and</span> <span class="n">have</span> <span class="n">been</span> <span class="n">using</span> <span class="n">python</span> <span class="nb">long</span> <span class="n">enough</span> <span class="n">should</span> <span class="n">be</span> <span class="n">able</span> <span class="n">to</span> <span class="n">catch</span> <span class="n">what</span> <span class="ow">is</span> <span class="n">going</span> <span class="n">on</span> <span class="n">here</span><span class="o">.</span> <span class="n">don</span> <span class="n">know</span> <span class="n">here</span> <span class="n">hint</span> <span class="n">of</span> <span class="n">previous</span> <span class="n">session</span> <span class="k">as</span> <span class="n">may</span> <span class="n">earlier</span> <span class="n">comprehension</span> <span class="n">index</span> <span class="n">variables</span> <span class="n">into</span> <span class="n">the</span> <span class="n">local</span> <span class="n">namespace</span><span class="o">.</span> <span class="n">strange</span> <span class="n">thing</span> <span class="n">that</span> <span class="n">although</span> <span class="n">would</span> <span class="n">reset</span> <span class="n">it</span> <span class="n">generator</span> <span class="n">version</span> <span class="n">does</span> <span class="ow">not</span><span class="o">.</span> <span class="n">well</span> <span class="n">normally</span> <span class="n">do</span> <span class="n">this</span><span class="p">:</span> <span class="n">x</span><span class="o">=</span><span class="s">"1"</span> <span class="nb">range</span> <span class="k">del</span> <span class="n">traceback</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span> <span class="nb">file</span> <span class="n">line</span> <span class="n">nameerror</span><span class="p">:</span> <span class="n">name</span> <span class="ow">not</span> <span class="n">defined</span> <span class="n">above</span> <span class="n">bit</span> <span class="n">has</span> <span class="n">something</span> <span class="k">with</span> <span class="n">way</span><span class="o">&gt;</span><span class="k">lambda</span> <span class="n">function</span> <span class="n">was</span> <span class="n">defined</span> <span class="k">with</span> <span class="n">the</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">a</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;.</span>  <span class="n">By</span> <span class="n">the</span> <span class="n">way</span><span class="p">,</span> <span class="n">here</span> <span class="ow">is</span> <span class="n">what</span> <span class="n">happens</span> <span class="k">with</span> <span class="n">the</span> <span class="n">generator</span> <span class="n">comprehension</span> <span class="p">(</span><span class="ow">is</span> <span class="n">that</span> <span class="n">what</span> <span class="n">these</span> <span class="n">are</span> <span class="n">called</span><span class="err">?</span><span class="p">)</span> <span class="k">if</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">a</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span><span class="p">:</span>



<span class="sb">``</span><span class="err">`</span><span class="n">py</span>


<span class="o">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">a</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">((</span><span class="n">l</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">l</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">H</span><span class="p">))</span>

<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">""</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> 
  <span class="n">File</span> <span class="s">""</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> 
  <span class="n">File</span> <span class="s">""</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> 
<span class="ne">NameError</span><span class="p">:</span> <span class="k">global</span> <span class="n">name</span> <span class="s">'a'</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>


<p>This is how I dis­cov­ered this.  I had de­fined a lamb­da func­tion us­ing an vari­able that was then passed to a list com­pre­hen­sion that used this vari­able as the in­dex with­out re­al­iz­ing it. But then I tried con­vert­ing this in­to a gen­er­a­tor com­pre­hen­sion to see if it would be faster, and got the above er­ror.   </p> 
 <p>Fi­nal­ly, since the "fea­ture" of leak­ing list com­pre­hen­sion loop vari­ables in­to the lo­cal names­pace is  <a href="http://docs.python.org/release/3.0.1/whatsnew/3.0.html#changed-syntax">go­ing away</a>  in Python 3, I ex­pect­ed things to be­have at least a lit­tle dif­fer­ent­ly in Python 3.  I tried the above in a Python 3.1.2 in­ter­preter and got the fol­low­ing:</p> 
 <div class="codehilite"><pre><span class="err">$</span><span class="n">python3</span>

<span class="n">Python</span> <span class="mf">3.1</span><span class="o">.</span><span class="mi">2</span> <span class="p">(</span><span class="n">r312</span><span class="p">:</span><span class="mi">79147</span><span class="p">,</span> <span class="n">Mar</span> <span class="mi">23</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">22</span><span class="p">:</span><span class="mo">02</span><span class="p">:</span><span class="mo">05</span><span class="p">)</span> 

<span class="p">[</span><span class="n">GCC</span> <span class="mf">4.2</span><span class="o">.</span><span class="mi">1</span> <span class="p">(</span><span class="n">Apple</span> <span class="n">Inc</span><span class="o">.</span> <span class="n">build</span> <span class="mi">5646</span><span class="p">)</span> <span class="p">(</span><span class="n">dot</span> <span class="mi">1</span><span class="p">)]</span> <span class="n">on</span> <span class="n">darwin</span>

<span class="n">Type</span> <span class="s">"help"</span><span class="p">,</span> <span class="s">"copyright"</span><span class="p">,</span> <span class="s">"credits"</span> <span class="ow">or</span> <span class="s">"license"</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">l</span>

<span class="o">&lt;</span><span class="n">function</span> <span class="n">at</span><span class="o">=</span><span class="s">""</span> <span class="n">replaceme</span> <span class="n">h</span><span class="o">=</span><span class="s">"[(1,"</span> <span class="n">l</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">traceback</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span> <span class="nb">file</span> <span class="n">line</span> <span class="n">nameerror</span><span class="p">:</span> <span class="k">global</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span> <span class="nb">list</span> <span class="n">so</span> <span class="n">python</span> <span class="n">both</span> <span class="n">the</span> <span class="n">comprehension</span> <span class="ow">and</span> <span class="n">generator</span> <span class="n">comprehensions</span> <span class="n">act</span> <span class="n">same</span> <span class="n">which</span> <span class="n">too</span> <span class="n">surprising</span><span class="o">.</span> <span class="n">i</span> <span class="n">guess</span> <span class="n">should</span> <span class="n">recode</span> <span class="n">that</span> <span class="n">piece</span> <span class="n">of</span> <span class="n">code</span> <span class="n">to</span> <span class="n">make</span> <span class="n">it</span> <span class="n">future</span> <span class="n">proof</span> <span class="n">although</span> <span class="n">this</span> <span class="n">doesn</span> <span class="n">seem</span> <span class="n">easy</span> <span class="n">moment</span> <span class="n">may</span> <span class="n">require</span> <span class="n">converting</span> <span class="n">one</span><span class="o">-</span><span class="n">liner</span> <span class="n">into</span> <span class="n">six</span><span class="o">-</span><span class="n">liner</span><span class="o">.</span> <span class="k">if</span> <span class="n">you</span> <span class="n">are</span> <span class="n">interested</span> <span class="n">href</span><span class="o">=</span><span class="s">"http://github.com/asmeurer/sympy/blob/15c3675ff67be854c12c349ed9034f12bb2f5247/sympy/integrals/risch.py#L297"</span><span class="o">&gt;</span><span class="n">here</span><span class="o">.</span>



<span class="n">So</span> <span class="n">can</span> <span class="n">anyone</span> <span class="n">provide</span> <span class="nb">any</span> <span class="n">insight</span> <span class="n">into</span> <span class="n">what</span> <span class="ow">is</span> <span class="n">going</span> <span class="n">on</span> <span class="k">with</span> <span class="n">that</span> <span class="k">lambda</span> <span class="n">function</span><span class="err">?</span>  <span class="n">Running</span> <span class="n">it</span> <span class="k">with</span> <span class="n">the</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;-</span><span class="mi">3</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="n">switch</span> <span class="n">to</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">python2</span><span class="o">.</span><span class="mi">6</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="n">didn</span><span class="s">'t give any warnings related to it.  </span>



<span class="o">&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="n">Update</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">strong</span><span class="o">&gt;</span> <span class="n">As</span> <span class="n">I</span> <span class="n">noted</span> <span class="ow">in</span> <span class="n">a</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">"http://asmeurersympy.wordpress.com/2010/06/16/strange-python-behavior-can-someone-please-explain-to-me-what-is-going-on-here/#comment-121"</span><span class="o">&gt;</span><span class="n">comment</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">I</span> <span class="n">figured</span> <span class="n">out</span> <span class="n">how</span> <span class="n">to</span> <span class="n">make</span> <span class="n">this</span> <span class="n">future</span><span class="o">-</span><span class="n">proof</span><span class="o">.</span>  <span class="n">I</span> <span class="n">need</span> <span class="n">to</span> <span class="n">convert</span> <span class="n">it</span> <span class="kn">from</span> 



<span class="sb">``</span><span class="err">`</span><span class="n">py</span>


<span class="k">def</span> <span class="nf">residue_reduce_derivation</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="n">lambdafunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">*</span><span class="n">derivation</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">D</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">as_basic</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">/</span> \
         <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_basic</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">S</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">RootSum</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_poly</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">lambdafunc</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">H</span><span class="p">]))</span>
</pre></div>


<p>to</p> 
 <div class="codehilite"><pre><span class="k">def</span> <span class="nf">residue_reduce_derivation</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">S</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">RootSum</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_poly</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">*</span><span class="n">derivation</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">D</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">as_basic</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">/</span> \
        <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_basic</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">H</span><span class="p">)))</span>
</pre></div>


<p>Thanks to all the com­menters for the ex­pla­na­tion­s.   </p> 
 <p>Al­so, you may have no­ticed that I dis­cov­ered that if you use  <tt>[code]</tt>  in­stead of  <tt>&lt;code&gt;</tt>, you get these nicer code blocks that  <em>ac­tu­al­ly re­spect in­den­ta­tion!</em>   Now I just need to fig­ure out how to make them syn­tax high­light Python code.</p> 
 <p><strong>Up­date 2:</strong>   <tt>[code='py']</tt>  col­ors it!  Sweet!</p> 
 <p><strong>Up­date 3:</strong>  I just dis­cov­ered that SymPy has a  <code>Lamb­da()</code>  ob­ject that han­dles this bet­ter.  In par­tic­u­lar, it pret­ty prints the code, and is what is al­ready be­ing used for  <code>Root­Sum()</code>  in the ra­tio­nal func­tion in­te­gra­tor, at least in Ma­teusz's polys9.   </p> 
 <div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">integrate</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>

<span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="n">RootSum</span><span class="p">(</span><span class="mi">625</span><span class="o">*</span><span class="n">_t</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">125</span><span class="o">*</span><span class="n">_t</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">_t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">_t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">_t</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">_t</span><span class="p">)))</span>                                                   
</pre></div>


<p>Stil­l, this has been a very good learn­ing ex­pe­ri­ence.   </p>
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    

    
        <ul class="pager">
            <li class="previous">
                <a href="../../15/a-weeklog/" rel="prev" title="A Weeklog">Previous post</a>
            </li>
            <li class="next">
                <a href="../../26/quick-update/" rel="next" title="Quick Update">Next post</a>
            </li>
        </ul>

    </nav>
    </aside>
        <section class="comments">
        <h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="asmeurer",
            disqus_url="http://asmeurer.github.io/posts/2010/06/16/strange-python-behavior-can-someone-please-explain-to-me-what-is-going-on-here/",
        disqus_title="Strange Python Behavior (can someone please explain to me what is going on here?)",
        disqus_identifier="cache/posts/2010/06/16/strange-python-behavior-can-someone-please-explain-to-me-what-is-going-on-here.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section>
    

</article>

        
       <script>var disqus_shortname="asmeurer";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>



        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:asmeurer@gmail.com">Aaron Meurer</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<p xmlns:dct="http://purl.org/dc/terms/" xmlns:vcard="http://www.w3.org/2001/vcard-rdf/3.0#">
  <a rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/">
    <img src="http://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0">
  </a>

        </p></footer>
    </div>
</div>


            <script src="../../../../../assets/js/all-nocdn.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

<script type="text/javascript" src="../../../../../assets/js/tipuesearch_set.js"></script>
<script type="text/javascript" src="../../../../../assets/js/tipuesearch.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#tipue_search_input').tipuesearch({
        'mode': 'json',
        'contentLocation': '/assets/js/tipuesearch_content.json',
        'showUrl': false
    });
});
</script>


</body>
</html>
