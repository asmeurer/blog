<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns#
        article: http://ogp.me/ns/article#
    " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>The Risch Algorithm: Part 1 | Aaron Meurer's Blog</title>

    
            <link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../rss.xml">

      <link rel="canonical" href="http://asmeurer.github.io/posts/2010/06/30/the-risch-algorithm-part-1/">



    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
   tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"], ['$ latex','$'], ['$latex','$'] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
   },
   displayAlign: 'left', // Change this to 'center' to center equations.
   "HTML-CSS": {
       styles: {'.MathJax_Display': {"margin": 0}}
   }
});
</script>

        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    
<link rel="stylesheet" type="text/css" href="../../../../../assets/css/tipuesearch.css">
</head>
<body>
<div id="tipue_search_content" style="margin-left: auto; margin-right: auto; padding: 20px;"></div>



    

    <meta name="author" content="Aaron Meurer">
    
        <meta name="og:title" content="The Risch Algorithm: Part 1">
        <meta name="og:url" content="http://asmeurer.github.io/posts/2010/06/30/the-risch-algorithm-part-1/">
            <meta name="og:description" content="My work this week is­n't very in­ter­est­ing, even in­so­much as my work any week is in­ter­est­ing, so this week I have elect­ed to start a se­ries of blog posts about the Risch Al­go­rithm in gen­er">
        <meta name="og:site_name" content="Aaron Meurer's Blog">
        <meta name="og:type" content="article">

    
        <meta name="twitter:card" content="summary">
            <meta name="twitter:site:id" content="123456">
            <meta name="twitter:creator:id" content="654321">

    





<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://asmeurer.github.io/">Aaron Meurer's Blog</a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../../../../../archive.html">Archives</a>
                </li>
<li>
<a href="../../../../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../../../../rss.xml">RSS</a>

            </li>
</ul>
                
<span class="navbar-form pull-left">
<input type="text" id="tipue_search_input">
</span>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="index.wp" id="sourcelink">Source</a>
    </li>

            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container-fluid -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">The Risch Algorithm: Part 1</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Aaron Meurer</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2010-06-30T03:43:00-05:00" itemprop="datePublished" title="Publication date">2010-06-30 03:43</time></a></p>
                <p class="commentline">
        
    <a href=".#disqus_thread" data-disqus-identifier="cache/posts/2010/06/30/the-risch-algorithm-part-1.html">Comments</a>


        </p>
</div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p></p>
<p>My work this week is­n't very in­ter­est­ing, even in­so­much as my work any week is in­ter­est­ing, so this week I have elect­ed to start a se­ries of blog posts about the Risch Al­go­rithm in gen­er­al.  I will start out with the ba­sics in this post.</p> 
 <p>Any­one who has tak­en Cal­cu­lus knows a hand­ful of heuris­tics to cal­cu­late in­te­gral­s.  u-­sub­sti­tu­tion, par­tial frac­tion­s, in­te­gra­tion by part­s, trigono­met­ric sub­sti­tu­tion, and ta­ble in­te­gra­tion are a few of the more pop­u­lar ones.  These are gen­er­al enough to work for most in­te­grals that are en­coun­tered in prob­lems in Physic­s, En­gi­neer­ing, and so on, as well as most of those gen­er­at­ed by solv­ing dif­fer­en­tial equa­tions from the same field­s.  But these fall short in a cou­ple of ways.  First of­f, they are just heuris­tic­s.  If they fail, it does not mean that no in­te­gral ex­ist­s.  This means that they are use­less for prov­ing that cer­tain func­tion­s, such as $la­tex e^{-x^2}$ do not have in­te­gral­s, no mat­ter how hard you try to find them.  Sec­ond, they work for on­ly rel­a­tive­ly sim­ple func­tion­s.  For ex­am­ple, sup­pose you have a ra­tio­nal func­tion in $la­tex \log{x}$ and $la­tex x$.  An ex­am­ple would be $la­tex \frac{(\log{x})^2 + 2\log{x} + x^2 + 1}{x\log{x} + 2x^3}$.  We are not in­ter­est­ed in in­te­grat­ing this func­tion, but rather in find­ing it back giv­en its deriva­tive, $la­tex - \frac{1 + 7 x^{2} \log{x} + \log{x} + (\log{x})^2 + 3 x^{2} + 6 x^{2} (\log{x})^2 + (\log{x})^3 + 2 x^{4}}{4 x^{4} \log{x} + x^{2} (\log{x})^2 + 4 x^{6}}$.  The on­ly method I named above that would come even close to be­ing ap­pli­ca­ble to this in­te­grand is par­tial frac­tion­s.  This re­quires mul­ti­vari­ate par­tial frac­tion de­com­po­si­tion (with re­spect to $la­tex x$ and $la­tex \log{x}$), and gives $la­tex -{\frac {2\,{x}^{2}+1+\log{x} }{{x}^{2}}}+{\frac {-1+8\,{x}^{4}-16\,{x}^{6}-{x}^{2}}{ \left( \log{x} +2\,{x}^{2} \right) ^{2}{x}^{2}}}+{\frac {-3\,{x}^{2}+12\,{x}^{4}-1}{ \left( \log{x} +2\,{x}^{2} \right) {x}^{2}}}$, which brings us no clos­er to a so­lu­tion.  </p> 
 <p>The rea­son that I start­ed with a func­tion and then com­put­ed its de­riv­a­tive was to show how easy it is to come up with a very com­pli­cat­ed func­tion that has an el­e­men­tary an­ti-deriva­tive.  There­fore, we see that the meth­ods from cal­cu­lus are not the ones to use if we want an in­te­gra­tion al­go­rithm that is com­plete.  The Risch In­te­gra­tion Al­go­rithm is based on a com­plete­ly dif­fer­ent ap­proach.  At its core lies Li­ou­ville's The­o­rem, which gives us the form of any el­e­men­tary an­ti-deriva­tive.   (I wish to point out at this point that heuris­tics like this are still use­ful in a com­put­er al­ge­bra sys­tem such as SymPy as fast pre­proces­sors to the full in­te­gra­tion al­go­rith­m).</p> 
 <p>The Risch Al­go­rithm works by do­ing poly­no­mi­al ma­nip­u­la­tions on the in­te­grand, which is en­tire­ly de­ter­min­is­tic (non-heuris­tic), and gives us the pow­er of all the the­o­rems of al­ge­bra, al­low­ing us to ac­tu­al­ly prove that an­ti-deriva­tives can­not ex­ist when they don't.  To start of­f, we have to look at deriva­tion­s.  As I said, ev­ery­thing with the Risch Al­go­rithm is looked at al­ge­bra­i­cal­ly (as op­posed to an­a­lyt­i­cal­ly).  The first thing to look at is the de­riv­a­tive it­self.  We de­fine a deriva­tion as any func­tion $la­tex D$ on a ring $la­tex R$ that sat­is­fies two prop­er­ties:</p> 
 <ol>
<li> 
 <p>$la­­tex D(a + b) = Da + Db$ (Sum Rule),</p>  
  </li> 
 <li> 
 <p>$la­­tex D(ab) = aDb + bDa$ (Prod­uct Rule)</p>  
  </li> 
 </ol>
<p>for any $la­tex a, b \in R$.  Fur­ther­more, de­fine the set of con­stant el­e­ments as $la­tex Con­st_D(R) = {a \in R\­tex­tr­m{ such that }Da = 0}$.  From just these two rules, you can prove all the rules from cal­cu­lus such as the pow­er rule and the quo­tient rule.  Defin­ing things al­ge­bra­i­cal­ly lets us avoid an­a­lyt­ic prob­lem­s, such as dis­con­ti­nu­ities and the need to prove con­ver­gence all the time.  An­oth­er prob­lem from anal­y­sis is the mul­ti­val­ue na­ture of cer­tain func­tion­s, name­ly the nat­u­ral log­a­rith­m.  We get around this by defin­ing $la­tex \log{a}$ as the unique func­tion sat­is­fy­ing $la­tex D\log{a} = \frac{­Da}{a}$, for $la­tex a \neq 0$.   From this def­i­ni­tion we can prove the fa­mous log­a­rith­mic iden­ti­ties $la­tex \log{ab} = \log{a} + \log{b}$ and $la­tex \log{a^n} = n\log{a}$ for log­a­rith­mic deriva­tives, again us­ing on­ly the two rules for a deriva­tion giv­en above.  For ex­am­ple, $la­tex D\log{ab}=\frac{D­ab}{ab}=\frac{aDb + bDa}{ab} = \frac{b­Da}{ab} + \frac{aD­b}{ab} = $$la­tex \frac{­Da}{a} + \frac{D­b}{b}=D\log{a} + D\log{b}=D(\log{a} + \log{b})$.   </p> 
 <p>The above def­i­ni­tion for the nat­u­ral log­a­rithm gives the first in­sight in­to how the in­te­gra­tion al­go­rithm work­s.  We de­fine tran­scen­den­tal func­tions in terms of their de­riv­a­tives.  So if $la­tex t = e^x$, then $la­tex Dt/t = 1$.  We can de­fine all of the trigono­met­ric func­tions in terms of $la­tex e^x$ and $la­tex \log{x}$ if we use $la­tex \sqrt{-1}$, but we can al­so avoid this.  For ex­am­ple, if $la­tex t = \tan{x}$, then $la­tex Dt = 1 + t^2$ be­cause $la­tex \frac{d}{dx}\­tan{x} = \sec^2{x} = 1 + \tan^2{x}$.   </p> 
 <p>We say that $la­tex t\in K$ is a  <em>mono­mi­al</em>  over the field $la­tex k$ with re­spect to a deriva­tion $la­tex D$ if it sat­is­fies</p> 
 <ol>
<li> 
 <p>$la­­tex t$ is tran­s­cen­­den­­tal over $la­­tex k$,</p>  
  </li> 
 <li> 
 <p>$la­­tex D[t]\in k[t]$.</p>  
  </li> 
 </ol>
<p>The first con­di­tion is nec­es­sary be­cause the we are on­ly go­ing to deal with the trance­nen­tal ver­sion of the Risch Al­go­rithm (the al­ge­bra­ic case is solved too, but the so­lu­tion method is quite dif­fer­en­t, and I am not im­ple­ment­ing it this sum­mer).  The sec­ond con­di­tion just says that the de­riv­a­tive of t is a poly­no­mi­al in t and a ra­tio­nal func­tion in x.  The func­tions I men­tioned above all sat­is­fy these prop­er­ties for $la­tex K = \math­b­b{Q}$.  The­o­rems in anal­y­sis show that $la­tex \log{x}$, $la­tex e^x$, and $la­tex \tan{x}$ are all tran­scen­den­tal over $la­tex \math­b­b{Q}[x]$.  This is ac­tu­al­ly the on­ly use of anal­y­sis that we make in the in­te­gra­tion al­go­rith­m.  Al­so, we see that if $la­tex t_1=\log{x}$, $la­tex t_2=e^x$, and $la­tex t_3=\­tan{x}$, then $la­tex Dt_1=\frac{1}{x}$, $la­tex Dt_2=t_2$, and $la­tex Dt_3=1 + t_3^2$, which are all poly­no­mi­als in their re­spec­tive $la­tex t_i$ and ra­tio­nal func­tions in $la­tex x$.  In the al­go­rith­m, $la­tex K$ is ac­tu­al­ly a tow­er of mono­mi­al ex­ten­sions of $la­tex \math­b­b{Q}$, so $la­tex t_n$ is a mono­mi­al over $la­tex \math­b­b{Q}(x, t_1, \dot­s, t_{n-1})$.   This al­lows us to work with func­tions like $la­tex e^{\­tan{x}}$.  We can't make $la­tex t=e^{\­tan{x}}$ di­rect­ly be­cause $la­tex \frac{d}{dx}e^{\­tan{x}} = (1 + \tan^2{x})e^{\­tan{x}}$ is not a poly­no­mi­al in $la­tex t$ (it al­so con­tains $la­tex \tan{x}$) .  But if we let $la­tex t_1$ be such that $la­tex Dt_1=1 + t_1^2$, i.e., $la­tex t_1=\­tan{x}$, then we can let $la­tex t_2$ be such that $la­tex Dt_2=(1 + t_1^2)t_2$, i.e., $la­tex t_2=e^{\­tan{x}}$.  Re­mem­ber that the $la­tex t_i$ are all "func­tion­s" of x, but there is no need to write $la­tex t=t(x)$ as long as we re­mem­ber that $la­tex Dt\neq 0$, i.e., $la­tex t\not \in Con­st_D(K)$.  This is an­oth­er ad­van­tage of us­ing al­ge­bra­ic over an­a­lyt­ic meth­od­s; it al­lows us to re­duce an in­te­gral down to a ra­tio­nal func­tion in the "sym­bol­s" $la­tex x$ and $la­tex t_1, t_2, \dot­s, t_n$.  By con­ven­tion, we make the first ex­ten­sion $la­tex t_0$ such that $la­tex Dt_0=1$, i.e., $la­tex t_0=x$.  I will just call it $la­tex x$ here in­stead of $la­tex t_0$, to avoid con­fu­sion.   </p> 
 <p>This is the prepars­ing that I al­lud­ed to in an  <a href="http://asmeurersympy.wordpress.com/2010/06/26/quick-update/">ear­li­er post</a>  that I have not im­ple­ment­ed yet.  The rea­son that I haven't im­ple­ment­ed it yet is not just be­cause I haven't got­ten around to it.  We have to be care­ful when we build up the ex­ten­sion that each el­e­ment is in­deed tran­scen­den­tal over the al­ready built-up field $la­tex k$.  For ex­am­ple, al­though it ap­pears tran­scen­den­tal, the func­tion $la­tex e^{\frac{1}{2}\log{(1 + x^2)}}$ is re­al­ly al­ge­bra­ic be­cause it equals $la­tex \sqrt{1 + x^2}$.  There are ad­di­tion­al re­quire­ments, such that each ex­ten­sion is not the de­riv­a­tive of log­a­rith­mic de­riv­a­tive of an el­e­ment of $la­tex k$ (see al­so the ex­am­ple I gave in the pre­vi­ous post).  This is the part that I was talk­ing about in my  <a href="http://asmeurersympy.wordpress.com/2010/06/26/quick-update/">pre­vi­ous post</a>  that is not writ­ten out as much as the oth­er al­go­rithms in Bron­stein's book.  So this is al­go­rith­mi­cal­ly solved, just like the rest of the Al­go­rith­m, but it is non-triv­ial and may end up be­ing the hard­est part of the al­go­rithm for me to im­ple­men­t, just be­cause it will prob­a­bly re­quire the most fig­ur­ing out on my part.   </p> 
 <p>So we can see that we can con­vert a tran­scen­den­tal in­te­gral, such as the one above, in­to a ra­tio­nal func­tion in x and mono­mi­al ex­ten­sions $la­tex t_1, t_2, \dot­s, t_n$.  For ex­am­ple, the above in­te­grand would be­come $la­tex - \frac{1 + t + t^{2} + 3 x^{2} + 6 t^{2} x^{2} + 7 t x^{2} + t^{3} + 2 x^{4}}{t^{2} x^{2} + 4 t x^{4} + 4 x^{6}}$.  We then per­form cer­tain poly­no­mi­al ma­nip­u­la­tions on this in­te­grand, us­ing the fact that $la­tex Dx=1$ and $la­tex Dt=\frac{1}{x}$.  For the tran­scen­den­tal case of the Risch Al­go­rith­m, this is sim­i­lar to the ra­tio­nal func­tion in­te­gra­tion that I out­lined in  <a href="http://asmeurersympy.wordpress.com/2010/06/11/integration-of-rational-functions/">this post</a>, and has Li­ou­ville's The­o­rem at its core.  This is where I will start off next time.   </p>
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    
        <ul itemprop="keywords" class="tags">
           <li><a class="tag p-category" href="../../../../../categories/mathjax/" rel="tag">mathjax</a></li>
        </ul>

    
        <ul class="pager">
            <li class="previous">
                <a href="../../26/quick-update/" rel="prev" title="Quick Update">Previous post</a>
            </li>
            <li class="next">
                <a href="../../../07/12/integration-of-exponential-functions/" rel="next" title="Integration of exponential functions">Next post</a>
            </li>
        </ul>

    </nav>
    </aside>
        <section class="comments">
        <h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="asmeurer",
            disqus_url="http://asmeurer.github.io/posts/2010/06/30/the-risch-algorithm-part-1/",
        disqus_title="The Risch Algorithm: Part 1",
        disqus_identifier="cache/posts/2010/06/30/the-risch-algorithm-part-1.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section>
    
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});</script>
        <script src="../../../../../assets/js/mathjax.js"></script>

</article>

        
       <script>var disqus_shortname="asmeurer";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>



        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:asmeurer@gmail.com">Aaron Meurer</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<p xmlns:dct="http://purl.org/dc/terms/" xmlns:vcard="http://www.w3.org/2001/vcard-rdf/3.0#">
  <a rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/">
    <img src="http://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0">
  </a>

        </p></footer>
    </div>
</div>


            <script src="../../../../../assets/js/all-nocdn.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

<script type="text/javascript" src="../../../../../assets/js/tipuesearch_set.js"></script>
<script type="text/javascript" src="../../../../../assets/js/tipuesearch.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#tipue_search_input').tipuesearch({
        'mode': 'json',
        'contentLocation': '/assets/js/tipuesearch_content.json',
        'showUrl': false
    });
});
</script>


</body>
</html>
