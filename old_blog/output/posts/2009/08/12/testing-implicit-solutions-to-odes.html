<!DOCTYPE html><html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Joe Example">
    <title>Testing implicit solutions to ODEs | Aaron Meurer's SymPy Blog</title>
    
            <link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
    <link rel="canonical" href="http://asmeurersympy.wordpress.com/posts/2009/08/12/testing-implicit-solutions-to-odes.html">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]-->
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../rss.xml">

    





    
</head>
<body>
<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://asmeurersympy.wordpress.com/">Aaron Meurer's SymPy Blog</a>
    </div>
    <div class="collapse navbar-collapse navbar-ex1-collapse">
        <ul class="nav navbar-nav">
            
                <li><a href="../../../../archive.html">Archives</a>
                </li><li><a href="../../../../categories/index.html">Tags</a>
                </li><li><a href="../../../../rss.xml">RSS</a>

        </li></ul>

        <ul class="nav navbar-nav navbar-right">
            
            
        </ul>
    </div><!-- /.navbar-collapse -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
    <article class="postbox post-text">
    <div class="h-entry" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <h1 class="p-name" itemprop="headline name">Testing implicit solutions to ODEs</h1>

    <hr>
    <small>
        Posted: <time class="published dt-published" datetime="2009-08-12T21:27:21+00:00" itemprop="datePublished">2009-08-12 21:27</time>
        

        
          |  
        More posts about 
    <span itemprop="keywords">
        <a class="tag p-category" href="../../../../categories/mathjax.html"><span class="badge badge-info">mathjax</span></a>
    </span>


    </small>
    <hr>
    <div class="e-content" itemprop="articleBody text">
    <div><p></p><p>So, the hard deadline for GSoC it Monday, so this will probably be my last post until then (I am very busy trying to finish up the ode module by then).  But this is one of those things that you just have to blog about.</p>
<p>So I have this checksol function in test_ode.py that attempts to check it the solutions to odes are valid or not.  It was a relic of the old ode module.  For that, it would just substitute the solution into the ode and see if it simplified to 0.  That is what it still does, if the solution is solved for f(x) (the function for all of my ode tests).  But if the solution is implicit in f, either because solve() is not good enough to solve it or because it cannot be solved, then that method obviously does not work.  So what I was trying to do is what my textbook suggested.  Take the derivative of the solution implicitly n times, where n is the order of the ode, and see if that is equal to the ode.  Basically, I was subtracting the ode from it and seeing if it reduced to 0.</p>
<p>However, it wasn't really working at all for most of my implicit solutions, even the really simple ones.  I ended up XFAILing most of my implicit checksol tests.  I think every single <a href="http://asmeurersympy.wordpress.com/2009/05/31/first-order-differential-equations-with-homogeneous-coefficients/">homogeneous coefficients</a> had an implicit solution, and none of them were working with checksol().  </p>
<p>So I started to ask around on IRC to see if anyone had any better ideas for testing these.  Ondrej couldn't think of anything.  Luke and Chris worked on an example that I gave them, and it seemed to be that it <em>wasn't</em> correct (which I didn't believe for a second, because the solution was straight out of my text, and both homogeneous coefficients integrals produced that same solution).  It turns out that we were mixing up $latex \log{\frac{y}{x}}$ and $latex \log{\frac{x}{y}}$ terms.  One of those appeared in the ode and the other appeared in the solution (the ode was $latex y dx  + x\log{\frac{y}{x}}dy - 2x dy = 0$ and the solution is $latex \frac{y}{1 + \log{\frac{x}{y}}}=C$, <a href="http://books.google.com.np/books?id=29utVed7QMIC&amp;lpg=PA24&amp;ots=uxLSUKt_3P&amp;dq=testing%20implicit%20solutions%20to%20ode&amp;hl=en&amp;pg=PA61#v=onepage&amp;q=&amp;f=false">number 9 from my odes text, pg. 61</a>.  </p>
<p>So Chris had a novel idea.  For 1st order odes, you can take the derivative of the solution and solve for $latex \frac{dy}{dx}$, which will always be possible, because differentiation is a linear operator.  Then substitute that into the original ode, and it will reduce.  </p>
<p>So we were talking about this on IRC later, and I had an epiphany as to why my original method wasn't working.  After trying it manually on an ode, I found that I had to multiply through the solution's derivative by $latex \frac{x}{f(x)}$ to make it equal to the ode.  Then, that reminded me of an important solution method that I didn't have time to implement this summer: integrating factors.  I remember that my textbook had <a href="http://books.google.com.np/books?id=29utVed7QMIC&amp;lpg=PA24&amp;ots=uxLSUKt_3P&amp;dq=testing%20implicit%20solutions%20to%20ode&amp;hl=en&amp;pg=PA83#v=onepage&amp;q=&amp;f=false">mentioned</a> that there is a theorem that states that every 1st order ODE that is linear in the derivative has a unique integrating factor that makes it exact.  And I realized, the derivative of the solution will be equal to the ODE if and only if the ODE is exact.  I checked my exact tests and verified my hunch.  I had to XFAIL all of my implicit homogeneous coefficients solutions, but all of my exact checksols were working just fine.  </p>
<p>So I refactored my checksol function to do this, and it now can check almost every one of my failing checksols.  The exceptions are some where trigsimp() cannot simplify the solution to 0 (we have a poor trigsimp), a second order solution (the above trick only works on 1st order odes, I believe), and some other simplification problems. </p>
<p>The only down side to this new routine is that it is kind of slow (because of the simplification).  I am going to have to skip a test of only 6 solutions because it takes 24 seconds to complete.  </p></div>
    </div>
    </div>
    
        <ul class="pager">
            <li class="previous">
                <a href="../10/homogeneous-coefficients-corner-case.html" rel="prev">← Previous post</a>
            </li>
            <li class="next">
                <a href="../17/los-alamos-sprint.html" rel="next">Next post →</a>
            </li>
        </ul>

        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="nikolademo",
            disqus_url="http://asmeurersympy.wordpress.com/posts/2009/08/12/testing-implicit-solutions-to-odes.html",
        disqus_title="Testing implicit solutions to ODEs",
        disqus_identifier="cache/posts/2009/08/12/testing-implicit-solutions-to-odes.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


    
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}
        });
        </script>
        <script src="../../../../assets/js/mathjax.js"></script>

    </article>

        </div>
        <!--End of body content-->

        <footer>
            Contents © 2014         <a href="mailto:joe@example.com">Joe Example</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
        </footer>
    </div>
</div>


            <script src="../../../../assets/js/all-nocdn.js" type="text/javascript"></script>


    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul><li><a class="addthis_button_facebook"></a>
</li><li><a class="addthis_button_google_plusone_share"></a>
</li><li><a class="addthis_button_linkedin"></a>
</li><li><a class="addthis_button_twitter"></a>
</li></ul>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script type="text/javascript">jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

</body>
</html>