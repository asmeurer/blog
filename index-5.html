<!DOCTYPE html>
<html prefix="        og: http://ogp.me/ns# article: http://ogp.me/ns/article#     " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="My blog">
<meta name="viewport" content="width=device-width">
<title>Aaron Meurer's Blog (old posts, page 5) | Aaron Meurer's Blog</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="rss.xml">
<link rel="canonical" href="https://asmeurer.com/blog/index-5.html">
<link rel="prev" href="." type="text/html">
<link rel="next" href="index-4.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
        
    <header id="header"><h1 id="brand"><a href="." title="Aaron Meurer's Blog" rel="home">

        <span id="blog-title">Aaron Meurer's Blog</span>
    </a></h1>

        

        
    <nav id="menu"><ul>
<li><a href=".">Blog</a></li>
                <li><a href="about">About</a></li>
                <li><a href="work">Work</a></li>
                <li><a href="archive.html">Archives</a></li>
                <li><a href="rss.xml">RSS</a></li>

    

    
    
    </ul></nav></header><main id="content"><div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/quansight-labs-work-update-for-september-2019/" class="u-url">Quansight Labs Work Update for September, 2019</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Aaron Meurer
            </span></p>
            <p class="dateline">
            <a href="posts/quansight-labs-work-update-for-september-2019/" rel="bookmark">
            <time class="published dt-published" datetime="2019-10-07T00:00:00-05:00" itemprop="datePublished" title="2019-10-07 00:00">2019-10-07 00:00</time></a>
            </p>
                <p class="commentline">
        
        <a href="posts/quansight-labs-work-update-for-september-2019/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p><em>This post has been cross-posted on the <a href="https://labs.quansight.org/blog/2019/10/quansight-labs-work-update-for-september-2019/">Quansight Labs
Blog</a>.</em></p>
<p>As of November, 2018, I have been working at
<a href="https://www.quansight.com/">Quansight</a>. Quansight is a new startup founded by
the same people who started Anaconda, which aims to connect companies and open
source communities, and offers consulting, training, support and mentoring
services. I work under the heading of <a href="https://www.quansight.com/labs">Quansight
Labs</a>. Quansight Labs is a public-benefit
division of Quansight. It provides a home for a "PyData Core Team" which
consists of developers, community managers, designers, and documentation
writers who build open-source technology and grow open-source communities
around all aspects of the AI and Data Science workflow.</p>
<p>My work at Quansight is split between doing open source consulting for various
companies, and working on SymPy.
<a href="https://www.sympy.org/en/index.html">SymPy</a>, for those who do not know, is a
symbolic mathematics library written in pure Python. I am the lead maintainer
of SymPy.</p>
<p>In this post, I will detail some of the open source work that I have done
recently, both as part of my open source consulting, and as part of my work on
SymPy for Quansight Labs.</p>
<h3>Bounds Checking in Numba</h3>
<p>As part of work on a client project, I have been working on contributing code
to the <a href="https://numba.pydata.org">numba</a> project. Numba is a just-in-time
compiler for Python. It lets you write native Python code and with the use of
a simple <code>@jit</code> decorator, the code will be automatically sped up using LLVM.
This can result in code that is up to 1000x faster in some cases:</p>
<pre><code>
In [1]: import numba

In [2]: import numpy

In [3]: def test(x):
   ...:     A = 0
   ...:     for i in range(len(x)):
   ...:         A += i*x[i]
   ...:     return A
   ...:

In [4]: @numba.njit
   ...: def test_jit(x):
   ...:     A = 0
   ...:     for i in range(len(x)):
   ...:         A += i*x[i]
   ...:     return A
   ...:

In [5]: x = numpy.arange(1000)

In [6]: %timeit test(x)
249 µs ± 5.77 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)

In [7]: %timeit test_jit(x)
336 ns ± 0.638 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)

In [8]: 249/.336
Out[8]: 741.0714285714286
</code></pre>
<p>Numba only works for a subset of Python code, and primarily targets code that
uses NumPy arrays.</p>
<p>Numba, with the help of LLVM, achieves this level of performance through many
optimizations. One thing that it does to improve performance is to remove all
bounds checking from array indexing. This means that if an array index is out
of bounds, instead of receiving an <code>IndexError</code>, you will get garbage, or
possibly a segmentation fault.</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from numba import njit
&gt;&gt;&gt; def outtabounds(x):
...     A = 0
...     for i in range(1000):
...         A += x[i]
...     return A
&gt;&gt;&gt; x = np.arange(100)
&gt;&gt;&gt; outtabounds(x) # pure Python/NumPy behavior
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "&lt;stdin&gt;", line 4, in outtabounds
IndexError: index 100 is out of bounds for axis 0 with size 100
&gt;&gt;&gt; njit(outtabounds)(x) # the default numba behavior
-8557904790533229732
</code></pre>
<p>In numba pull request <a href="https://github.com/numba/numba/pull/4432">#4432</a>, I am
working on adding a flag to <code>@njit</code> that will enable bounds checks for array
indexing. This will remain disabled by default for performance purposes. But
you will be able to enable it by passing <code>boundscheck=True</code> to <code>@njit</code>, or by
setting the <code>NUMBA_BOUNDSCHECK=1</code> environment variable. This will make it
easier to detect out of bounds issues like the one above. It will work like</p>
<pre><code class="language-pycon">&gt;&gt;&gt; @njit(boundscheck=True)
... def outtabounds(x):
...     A = 0
...     for i in range(1000):
...         A += x[i]
...     return A
&gt;&gt;&gt; x = np.arange(100)
&gt;&gt;&gt; outtabounds(x) # numba behavior in my pull request #4432
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
IndexError: index is out of bounds
</code></pre>
<p>The pull request is still in progress, and many things such as the quality of
the error message reporting will need to be improved. This should make
debugging issues easier for people who write numba code once it is merged.</p>
<h3>removestar</h3>
<p><a href="https://www.asmeurer.com/removestar/">removestar</a> is a new tool I wrote to
automatically replace <code>import *</code> in Python modules with explicit imports.</p>
<p>For those who don't know, Python's <code>import</code> statement supports so-called
"wildcard" or "star" imports, like</p>
<pre><code class="language-py">from sympy import *
</code></pre>
<p>This will import every public name from the <code>sympy</code> module into the current
namespace. This is often useful because it saves on typing every name that is
used in the import line. This is especially useful when working interactively,
where you just want to import every name and minimize typing.</p>
<p>However, doing <code>from module import *</code> is generally frowned upon in Python. It is
considered acceptable when working interactively at a <code>python</code> prompt, or in
<code>__init__.py</code> files (removestar skips <code>__init__.py</code> files by default).</p>
<p>Some reasons why <code>import *</code> is bad:</p>
<ul>
<li>It hides which names are actually imported.</li>
<li>It is difficult both for human readers and static analyzers such as
pyflakes to tell where a given name comes from when <code>import *</code> is used. For
example, pyflakes cannot detect unused names (for instance, from typos) in
the presence of <code>import *</code>.</li>
<li>If there are multiple <code>import *</code> statements, it may not be clear which names
come from which module. In some cases, both modules may have a given name,
but only the second import will end up being used. This can break people's
intuition that the order of imports in a Python file generally does not
matter.</li>
<li>
<code>import *</code> often imports more names than you would expect. Unless the module
you import defines <code>__all__</code> or carefully <code>del</code>s unused names at the module
level, <code>import *</code> will import every public (doesn't start with an
underscore) name defined in the module file. This can often include things
like standard library imports or loop variables defined at the top-level of
the file. For imports from modules (from <code>__init__.py</code>), <code>from module import *</code> will include every submodule defined in that module. Using <code>__all__</code> in
modules and <code>__init__.py</code> files is also good practice, as these things are
also often confusing even for interactive use where <code>import *</code> is
acceptable.</li>
<li>In Python 3, <code>import *</code> is syntactically not allowed inside of a function
definition.</li>
</ul>
<p>Here are some official Python references stating not to use <code>import *</code> in
files:</p>
<ul>
<li>
<p><a href="https://docs.python.org/3/faq/programming.html?highlight=faq#what-are-the-best-practices-for-using-import-in-a-module">The official Python
FAQ</a>:</p>
<blockquote>
<p>In general, don’t use <code>from modulename import *</code>. Doing so clutters the
importer’s namespace, and makes it much harder for linters to detect
undefined names.</p>
</blockquote>
</li>
<li>
<p><a href="https://www.python.org/dev/peps/pep-0008/#imports">PEP 8</a> (the official
Python style guide):</p>
<blockquote>
<p>Wildcard imports (<code>from &lt;module&gt; import *</code>) should be avoided, as they
make it unclear which names are present in the namespace, confusing both
readers and many automated tools.</p>
</blockquote>
</li>
</ul>
<p>Unfortunately, if you come across a file in the wild that uses <code>import *</code>, it
can be hard to fix it, because you need to find every name in the file that is
imported from the <code>*</code> and manually add an import for it. Removestar makes this
easy by finding which names come from <code>*</code> imports and replacing the import
lines in the file automatically.</p>
<p>As an example, suppose you have a module <code>mymod</code> like</p>
<pre><code>mymod/
  | __init__.py
  | a.py
  | b.py
</code></pre>
<p>with</p>
<pre><code class="language-py"># mymod/a.py
from .b import *

def func(x):
    return x + y
</code></pre>
<p>and</p>
<pre><code class="language-py"># mymod/b.py
x = 1
y = 2
</code></pre>
<p>Then <code>removestar</code> works like:</p>
<pre><code>$ removestar -i mymod/
$ cat mymod/a.py
# mymod/a.py
from .b import y

def func(x):
    return x + y
</code></pre>
<p>The <code>-i</code> flag causes it to edit <code>a.py</code> in-place. Without it, it would just
print a diff to the terminal.</p>
<p>For implicit star imports and explicit star imports from the same module,
<code>removestar</code> works statically, making use of
<a href="https://github.com/PyCQA/pyflakes">pyflakes</a>. This means none of the code is
actually executed. For external imports, it is not possible to work statically
as external imports may include C extension modules, so in that case, it
imports the names dynamically.</p>
<p><code>removestar</code> can be installed with pip or conda:</p>
<pre><code>pip install removestar
</code></pre>
<p>or if you use conda</p>
<pre><code>conda install -c conda-forge removestar
</code></pre>
<h3>sphinx-math-dollar</h3>
<p>In SymPy, we make heavy use of LaTeX math in our documentation. For example,
in our <a href="https://docs.sympy.org/dev/modules/functions/special.html#sympy.functions.special.hyper.hyper">special functions
documentation</a>,
most special functions are defined using a LaTeX formula, like <img src="besselj_docs.png" alt="The docs for besselj"></p>
<p>(from <a href="https://docs.sympy.org/dev/modules/functions/special.html#sympy.functions.special.bessel.besselj">https://docs.sympy.org/dev/modules/functions/special.html#sympy.functions.special.bessel.besselj</a>)</p>
<p>However, the source for this math in the docstring of the function uses RST
syntax:</p>
<pre><code class="language-py">class besselj(BesselBase):
    """
    Bessel function of the first kind.

    The Bessel `J` function of order `\nu` is defined to be the function
    satisfying Bessel's differential equation

    .. math ::
        z^2 \frac{\mathrm{d}^2 w}{\mathrm{d}z^2}
        + z \frac{\mathrm{d}w}{\mathrm{d}z} + (z^2 - \nu^2) w = 0,

    with Laurent expansion

    .. math ::
        J_\nu(z) = z^\nu \left(\frac{1}{\Gamma(\nu + 1) 2^\nu} + O(z^2) \right),

    if :math:`\nu` is not a negative integer. If :math:`\nu=-n \in \mathbb{Z}_{&lt;0}`
    *is* a negative integer, then the definition is

    .. math ::
        J_{-n}(z) = (-1)^n J_n(z).
</code></pre>
<p>Furthermore, in SymPy's documentation we have configured it so that text
between `single backticks` is rendered as math. This was originally done for
convenience, as the alternative way is to write <code>:math:`\nu`</code> every
time you want to use inline math. But this has lead to many people being
confused, as they are used to Markdown where `single backticks` produce
<code>code</code>.</p>
<p>A better way to write this would be if we could delimit math with dollar
signs, like <code>$\nu$</code>. This is how things are done in LaTeX documents, as well
as in things like the Jupyter notebook.</p>
<p>With the new <a href="https://www.sympy.org/sphinx-math-dollar/">sphinx-math-dollar</a>
Sphinx extension, this is now possible. Writing <code>$\nu$</code> produces $\nu$, and
the above docstring can now be written as</p>
<pre><code class="language-py">class besselj(BesselBase):
    """
    Bessel function of the first kind.

    The Bessel $J$ function of order $\nu$ is defined to be the function
    satisfying Bessel's differential equation

    .. math ::
        z^2 \frac{\mathrm{d}^2 w}{\mathrm{d}z^2}
        + z \frac{\mathrm{d}w}{\mathrm{d}z} + (z^2 - \nu^2) w = 0,

    with Laurent expansion

    .. math ::
        J_\nu(z) = z^\nu \left(\frac{1}{\Gamma(\nu + 1) 2^\nu} + O(z^2) \right),

    if $\nu$ is not a negative integer. If $\nu=-n \in \mathbb{Z}_{&lt;0}$
    *is* a negative integer, then the definition is

    .. math ::
        J_{-n}(z) = (-1)^n J_n(z).
</code></pre>
<p>We also plan to add support for <code>$$double dollars$$</code> for display math so that <code>.. math ::</code> is no longer needed either .</p>
<p>For end users, the documentation on <a href="https://docs.sympy.org">docs.sympy.org</a>
will continue to render exactly the same, but for developers, it is much
easier to read and write.</p>
<p>This extension can be easily used in any Sphinx project. Simply install it
with pip or conda:</p>
<pre><code>pip install sphinx-math-dollar
</code></pre>
<p>or</p>
<pre><code>conda install -c conda-forge sphinx-math-dollar
</code></pre>
<p>Then enable it in your <code>conf.py</code>:</p>
<pre><code class="language-py">extensions = ['sphinx_math_dollar', 'sphinx.ext.mathjax']
</code></pre>
<h3>Google Season of Docs</h3>
<p>The above work on sphinx-math-dollar is part of work I have been doing to
improve the tooling around SymPy's documentation. This has been to assist our
technical writer Lauren Glattly, who is working with SymPy for the next three
months as part of the new <a href="https://developers.google.com/season-of-docs/">Google Season of
Docs</a> program. Lauren's project
is to improve the consistency of our docstrings in SymPy. She has already
identified many key ways our docstring documentation can be improved, and is
currently working on a style guide for writing docstrings. Some of the issues
that Lauren has identified require improved tooling around the way the HTML
documentation is built to fix. So some other SymPy developers and I have been
working on improving this, so that she can focus on the technical writing
aspects of our documentation.</p>
<p>Lauren has created a draft style guide for documentation at
<a href="https://github.com/sympy/sympy/wiki/SymPy-Documentation-Style-Guide">https://github.com/sympy/sympy/wiki/SymPy-Documentation-Style-Guide</a>. Please
take a moment to look at it and if you have any feedback on it, comment below
or write to the SymPy mailing list.</p>
</div>
</div></article>
</div></main>
</div>
</body>
</html><html><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="/posts/whats-new-in-sympy-14/" class="u-url">What's New in SymPy 1.4</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Aaron Meurer
            </span></p>
            <p class="dateline">
            <a href="/posts/whats-new-in-sympy-14/" rel="bookmark">
            <time class="published dt-published" datetime="2019-05-02T00:00:00-05:00" itemprop="datePublished" title="2019-05-02 00:00">2019-05-02 00:00</time></a>
            </p>
                <p class="commentline">
        
        <a href="/posts/whats-new-in-sympy-14/#utterances-thread">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p><em>This post has been cross-posted on the <a href="https://labs.quansight.org/blog/2019/04/whats-new-in-sympy-14/">Quansight Blog</a>.</em></p>
<p>As of November, 2018, I have been working at
<a href="https://www.quansight.com/">Quansight</a>. Quansight is a new startup founded by
the same people who started Anaconda, which aims to connect companies and open
source communities, and offers consulting, training, support and mentoring
services. I work under the heading of <a href="https://www.quansight.com/labs">Quansight
Labs</a>. Quansight Labs is a public-benefit
division of Quansight. It provides a home for a "PyData Core Team" which
consists of developers, community managers, designers, and documentation
writers who build open-source technology and grow open-source communities
around all aspects of the AI and Data Science workflow. As a part of this, I
am able to spend a fraction of my time working on SymPy.
<a href="https://www.sympy.org/en/index.html">SymPy</a>, for those who do not know, is a
symbolic mathematics library written in pure Python. I am the lead maintainer
of SymPy.</p>
<p>SymPy 1.4 was released on April 9, 2019. In this post, I'd like to go over
some of the highlights for this release. The full release notes for the
release can be found on the <a href="https://github.com/sympy/sympy/wiki/Release-Notes-for-1.4">SymPy
wiki</a>.</p>
<p>To update to SymPy 1.4, use</p>
<pre><code class="language-bash">conda install sympy
</code></pre>
<p>or if you prefer to use pip</p>
<pre><code class="language-bash">pip install -U sympy
</code></pre>
<p>The SymPy 1.4 release contains over <a href="https://github.com/sympy/sympy/wiki/Release-Notes-for-1.4#authors">500 changes from 38 different
submodules</a>,
so I will not be going over every change, but only a few of the main
highlights. A <a href="https://github.com/sympy/sympy/wiki/Release-Notes-for-1.4#authors">total of 104
people</a>
contributed to this release, of whom 66 contributed for the first time for
this release.</p>
<p>While I did not personally work on any of the changes listed below (my work
for this release tended to be more invisible, behind the scenes fixes), I did
do the release itself.</p>
<h2>Automatic LaTeX rendering in the Jupyter notebook</h2>
<p>Prior to SymPy 1.4, SymPy expressions in the notebook rendered by default with their
string representation. To get <code>LaTeX</code> output, you had to call <code>init_printing()</code>:</p>
<img src="/sympy-1.3-notebook.png" alt="SymPy 1.3 rendering in the Jupyter lab notebook"><p>In SymPy 1.4, SymPy expressions now automatically render as LaTeX in the notebook:</p>
<img src="/sympy-1.4-notebook.png" alt="SymPy 1.4 rendering in the Jupyter lab notebook"><p>However, this only applies automatically if the type of an object is a SymPy
expression. For built-in types such as lists or ints, <code>init_printing()</code> is
still required to get LaTeX printing. For example, <code>solve()</code> returns a list,
so does not render as LaTeX unless <code>init_printing()</code> is called:</p>
<img src="/sympy-1.4-notebook-2.png" alt="SymPy 1.4 rendering in the Jupyter lab notebook with init_printing()"><p><code>init_printing()</code> is also still needed if you want to change any of the
printing settings, for instance, passing flags to the <code>latex()</code> printer or
selecting a different printer.</p>
<p>If you want the string form of an expression for copy-pasting, you can use
<code>print</code>.</p>
<h2>Improved simplification of relational expressions</h2>
<p>Simplification of relational and piecewise expressions has been improved:</p>
<pre><code class="language-py">&gt;&gt;&gt; x, y, z, w = symbols('x y z w')
&gt;&gt;&gt; init_printing()
&gt;&gt;&gt; expr = And(Eq(x,y), x &gt;= y, w &lt; y, y &gt;= z, z &lt; y)
&gt;&gt;&gt; expr
x = y ∧ x ≥ y ∧ y ≥ z ∧ w &lt; y ∧ z &lt; y
&gt;&gt;&gt; simplify(expr)
x = y ∧ y &gt; Max(w, z)
</code></pre>
<pre><code class="language-py">&gt;&gt;&gt; expr = Piecewise((x*y, And(x &gt;= y, Eq(y, 0))), (x - 1, Eq(x, 1)), (0, True))
&gt;&gt;&gt; expr
⎧ x⋅y   for y = 0 ∧ x ≥ y
⎪
⎨x - 1      for x = 1
⎪
⎩  0        otherwise
&gt;&gt;&gt; simplify(expr)
0
</code></pre>
<h2>Improved MathML printing</h2>
<p>The MathML presentation printer has been greatly improved, putting it on par
with the existing Unicode and LaTeX pretty printers.</p>
<pre><code class="language-py">&gt;&gt;&gt; mathml(Integral(exp(-x**2), (x, -oo, oo)), 'presentation')
&lt;mrow&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;-&lt;/mo&gt;&lt;mi&gt;&amp;#x221E;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x221E;&lt;/mi&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mi&gt;&amp;ExponentialE;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;-&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;dd;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;
</code></pre>
<p>If your <a href="https://caniuse.com/#feat=mathml">browser supports MathML</a> (at the
time of writing, only Firefox and Safari), you should see the above
presentation form for <code>Integral(exp(-x**2), (x, -oo, oo))</code> below:</p>
<p><math style="display: block;"><mrow><msubsup><mo>∫</mo><mrow><mo>-</mo><mi>∞</mi></mrow><mi>∞</mi></msubsup><msup><mi>ⅇ</mi><mrow><mo>-</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></msup><mo>ⅆ</mo><mi>x</mi></mrow></math></p>
<h2>Improvements to solvers</h2>
<p>Several improvements have been made to the solvers.</p>
<pre><code class="language-py">&gt;&gt;&gt; eq = Eq((x**2 - 7*x + 11)**(x**2 - 13*x + 42), 1)
&gt;&gt;&gt; eq
                2
               x  - 13⋅x + 42
⎛ 2           ⎞
⎝x  - 7⋅x + 11⎠               = 1
&gt;&gt;&gt; solve(eq, x) # In SymPy 1.3, this only gave the partial solution [2, 5, 6, 7]
[2, 3, 4, 5, 6, 7]
</code></pre>
<p>The ODE solver, <code>dsolve</code>, has also seen some improvements. Two new hints have
been added.</p>
<p><code>'nth_algebraic'</code> solves ODEs using <code>solve</code> by inverting the derivatives
algebraically:</p>
<pre><code class="language-py">&gt;&gt;&gt; f = Function('f')
&gt;&gt;&gt; eq = Eq(f(x) * (f(x).diff(x)**2 - 1), 0)
&gt;&gt;&gt; eq
⎛          2    ⎞
⎜⎛d       ⎞     ⎟
⎜⎜──(f(x))⎟  - 1⎟⋅f(x) = 0
⎝⎝dx      ⎠     ⎠
&gt;&gt;&gt; dsolve(eq, f(x)) # In SymPy 1.3, this only gave the solution f(x) = C1 - x
[f(x) = 0, f(x) = C₁ - x, f(x) = C₁ + x]
</code></pre>
<p><code>'nth_order_reducible'</code> solves ODEs that only involve derivatives of <code>f(x)</code>,
via the substitution $g(x)=f^{(n)}(x)$.</p>
<pre><code class="language-py">&gt;&gt;&gt; eq = Eq(Derivative(f(x), (x, 2)) + x*Derivative(f(x), x), x)
&gt;&gt;&gt; eq
               2
  d           d
x⋅──(f(x)) + ───(f(x)) = x
  dx           2
             dx
&gt;&gt;&gt; dsolve(eq, f(x))
                  ⎛√2⋅x⎞
f(x) = C₁ + C₂⋅erf⎜────⎟ + x
                  ⎝ 2  ⎠
</code></pre>
<h2>Dropping Python 3.4 support</h2>
<p>This is the last release of SymPy to support Python 3.4. SymPy 1.4 supports
Python 2.7, 3.4, 3.5, 3.6, 3.7, and PyPy. What's perhaps more exciting is that
the next release of SymPy, 1.5, which will be released later this year, will
be the last version to support Python 2.7.</p>
<p>Our
<a href="https://github.com/sympy/sympy/wiki/Python-version-support-policy">policy</a> is
to drop support for major Python versions when they reach their <a href="https://devguide.python.org/#status-of-python-branches">End of
Life</a>. In other words,
they receive no further support from the core Python team. Python 3.4 reached
its end of life on May 19 of this year, and Python 2.7 will reach its end of
life on January 1, 2020.</p>
<p>I have <a href="https://www.asmeurer.com/blog/posts/moving-away-from-python-2/">blogged in the
past</a> on why I
believe it is important for library authors to be proactive in dropping Python
2 support, and since then <a href="https://python3statement.org">a large number of Python
libraries</a> have either dropped support or
announced their plans to by 2020.</p>
<p>Having Python 2 support removed will not only allow us to remove a <a href="https://github.com/sympy/sympy/blob/sympy-1.4/sympy/core/compatibility.py">large
amount of compatibility
cruft</a>
from our codebase, it will also allow us to use some Python 3-only features
that will clean up our API, such as <a href="https://python-3-for-scientists.readthedocs.io/en/latest/python3_advanced.html#keyword-only-arguments">keyword-only
arguments</a>,
<a href="https://python-3-for-scientists.readthedocs.io/en/latest/python3_features.html#function-annotations">type
hints</a>,
and <a href="https://python-3-for-scientists.readthedocs.io/en/latest/python3_features.html#unicode-variable-names">Unicode variable
names</a>.
It will also enable <a href="https://github.com/sympy/sympy/issues?q=is%3Aissue+is%3Aopen+label%3A%22Dropping+Python+2%22">several internal
changes</a>
that will not be visible to end-users, but which will result in a much cleaner
and more maintainable codebase.</p>
<p>If you are still using Python 2, I strongly recommend switching to Python 3,
as otherwise the entire ecosystem of Python libraries is soon going to stop
improving for you. Python 3 is already highly recommended for SymPy usage due
to several key improvements. In particular, in Python 3, division of two
Python <code>int</code>s like <code>1/2</code> produces the float <code>0.5</code>. In Python 2, it does
integer division (producing <code>1/2 == 0</code>). The Python 2 integer division
behavior can lead to very surprising results when using SymPy (imagine writing
<code>x**2 + 1/2*x + 2</code> and having the <code>x</code> term "disappear"). When using SymPy, we
<a href="https://docs.sympy.org/latest/tutorial/gotchas.html#two-final-notes-and">recommend</a>
using rational numbers (like <code>Rational(1, 2)</code>) and avoiding <code>int/int</code>, but the
Python 3 behavior will at least maintain a mathematically correct result if
you do not do this. SymPy is also <a href="https://speed.python.org/comparison/?exe=12%2BL%2Bmaster%2C12%2BL%2B3.5%2C12%2BL%2B3.6%2C12%2BL%2B2.7&amp;ben=666%2C667%2C669%2C668&amp;env=1%2C2&amp;hor=false&amp;bas=none&amp;chart=normal+bars">already faster in Python
3</a>
due to things like <code>math.gcd</code> and <code>functools.lru_cache</code> being written in C,
and general performance improvements in the interpreter itself.</p>
<h2>And much more</h2>
<p>These are only a few of the highlights of the hundreds of changes in this
release. The full release notes can be found on <a href="https://github.com/sympy/sympy/wiki/Release-Notes-for-1.4">our
wiki</a>. The wiki
also has the in progress changes for our next release, <a href="https://github.com/sympy/sympy/wiki/Release-Notes-for-1.5">SymPy
1.5</a>, which will be
released later this year. Our <a href="https://github.com/sympy/sympy-bot">bot</a>
automatically collects release notes from every pull request, meaning SymPy
releases have very comprehensive and readable release notes pages. If you see
any mistakes on either page, feel free to edit the wiki and fix them.</p>
</div>
</div></article></html><html>
<nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="/" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="/index-4.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script>
MathJax = {
  tex: {
    inlineMath: [['$', '$']]
  },
  svg: {
    fontCache: 'global'
  }
};
</script><footer id="footer"><p>Contents © 2022         <a href="mailto:asmeurer@gmail.com">Aaron Meurer</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
</p>
<p xmlns:dct="https://purl.org/dc/terms/" xmlns:vcard="https://www.w3.org/2001/vcard-rdf/3.0#">
  <a rel="license" href="https://creativecommons.org/publicdomain/zero/1.0/">
    <img src="https://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0"></a>
</p>
            
        </footer><script src="/assets/js/all-nocdn.js"></script><div style="text-align:center">
<span class="st_twitterfollow_large" displaytext="Twitter Follow" st_username="asmeurer"></span>
<span class="st_twitter_large" displaytext="Tweet"></span>
<span class="st_googleplus_large" displaytext="Google +"></span>
<span class="st_plusone_large" displaytext="Google +1"></span>

<span class="st_email_large" displaytext="Email"></span>

</div>
<script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script>
MathJax = {
  tex: {
    inlineMath: [['$', '$']]
  },
  svg: {
    fontCache: 'global'
  }
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</html>

