The Risch Algorithm: Part 1
###########################
:date: 2010-06-30 03:43
:author: asmeurer
:category: Uncategorized
:slug: the-risch-algorithm-part-1

My work this week isn't very interesting, even insomuch as my work any
week is interesting, so this week I have elected to start a series of
blog posts about the Risch Algorithm in general. I will start out with
the basics in this post.

Anyone who has taken Calculus knows a handful of heuristics to calculate
integrals. u-substitution, partial fractions, integration by parts,
trigonometric substitution, and table integration are a few of the more
popular ones. These are general enough to work for most integrals that
are encountered in problems in Physics, Engineering, and so on, as well
as most of those generated by solving differential equations from the
same fields. But these fall short in a couple of ways. First off, they
are just heuristics. If they fail, it does not mean that no integral
exists. This means that they are useless for proving that certain
functions, such as $latex e^{-x^2}$ do not have integrals, no matter how
hard you try to find them. Second, they work for only relatively simple
functions. For example, suppose you have a rational function in $latex
\\log{x}$ and $latex x$. An example would be $latex \\frac{(\\log{x})^2
+ 2\\log{x} + x^2 + 1}{x\\log{x} + 2x^3}$. We are not interested in
integrating this function, but rather in finding it back given its
derivative, $latex - \\frac{1 + 7 x^{2} \\log{x} + \\log{x} +
(\\log{x})^2 + 3 x^{2} + 6 x^{2} (\\log{x})^2 + (\\log{x})^3 + 2
x^{4}}{4 x^{4} \\log{x} + x^{2} (\\log{x})^2 + 4 x^{6}}$. The only
method I named above that would come even close to being applicable to
this integrand is partial fractions. This requires multivariate partial
fraction decomposition (with respect to $latex x$ and $latex \\log{x}$),
and gives $latex -{\\frac {2\\,{x}^{2}+1+\\log{x} }{{x}^{2}}}+{\\frac
{-1+8\\,{x}^{4}-16\\,{x}^{6}-{x}^{2}}{ \\left( \\log{x} +2\\,{x}^{2}
\\right) ^{2}{x}^{2}}}+{\\frac {-3\\,{x}^{2}+12\\,{x}^{4}-1}{ \\left(
\\log{x} +2\\,{x}^{2} \\right) {x}^{2}}}$, which brings us no closer to
a solution.

The reason that I started with a function and then computed its
derivative was to show how easy it is to come up with a very complicated
function that has an elementary anti-derivative. Therefore, we see that
the methods from calculus are not the ones to use if we want an
integration algorithm that is complete. The Risch Integration Algorithm
is based on a completely different approach. At its core lies
Liouville's Theorem, which gives us the form of any elementary
anti-derivative. (I wish to point out at this point that heuristics like
this are still useful in a computer algebra system such as SymPy as fast
preprocessors to the full integration algorithm).

The Risch Algorithm works by doing polynomial manipulations on the
integrand, which is entirely deterministic (non-heuristic), and gives us
the power of all the theorems of algebra, allowing us to actually prove
that anti-derivatives cannot exist when they don't. To start off, we
have to look at derivations. As I said, everything with the Risch
Algorithm is looked at algebraically (as opposed to analytically). The
first thing to look at is the derivative itself. We define a derivation
as any function $latex D$ on a ring $latex R$ that satisfies two
properties:

| 1. $latex D(a + b) = Da + Db$ (Sum Rule),
|  2. $latex D(ab) = aDb + bDa$ (Product Rule)

for any $latex a, b \\in R$. Furthermore, define the set of constant
elements as $latex Const\_D(R) = \\{a \\in R\\textrm{ such that }Da =
0\\}$. From just these two rules, you can prove all the rules from
calculus such as the power rule and the quotient rule. Defining things
algebraically lets us avoid analytic problems, such as discontinuities
and the need to prove convergence all the time. Another problem from
analysis is the multivalue nature of certain functions, namely the
natural logarithm. We get around this by defining $latex \\log{a}$ as
the unique function satisfying $latex D\\log{a} = \\frac{Da}{a}$, for
$latex a \\neq 0$. From this definition we can prove the famous
logarithmic identities $latex \\log{ab} = \\log{a} + \\log{b}$ and
$latex \\log{a^n} = n\\log{a}$ for logarithmic derivatives, again using
only the two rules for a derivation given above. For example, $latex
D\\log{ab}=\\frac{Dab}{ab}=\\frac{aDb + bDa}{ab} = \\frac{bDa}{ab} +
\\frac{aDb}{ab} = $$latex \\frac{Da}{a} + \\frac{Db}{b}=D\\log{a} +
D\\log{b}=D(\\log{a} + \\log{b})$.

The above definition for the natural logarithm gives the first insight
into how the integration algorithm works. We define transcendental
functions in terms of their derivatives. So if $latex t = e^x$, then
$latex Dt/t = 1$. We can define all of the trigonometric functions in
terms of $latex e^x$ and $latex \\log{x}$ if we use $latex \\sqrt{-1}$,
but we can also avoid this. For example, if $latex t = \\tan{x}$, then
$latex Dt = 1 + t^2$ because $latex \\frac{d}{dx}\\tan{x} = \\sec^2{x} =
1 + \\tan^2{x}$.

We say that $latex t\\in K$ is a *monomial* over the field $latex k$
with respect to a derivation $latex D$ if it satisfies

| 1. $latex t$ is transcendental over $latex k$,
|  2. $latex D[t]\\in k[t]$.

The first condition is necessary because the we are only going to deal
with the trancenental version of the Risch Algorithm (the algebraic case
is solved too, but the solution method is quite different, and I am not
implementing it this summer). The second condition just says that the
derivative of t is a polynomial in t and a rational function in x. The
functions I mentioned above all satisfy these properties for $latex K =
\\mathbb{Q}$. Theorems in analysis show that $latex \\log{x}$, $latex
e^x$, and $latex \\tan{x}$ are all transcendental over $latex
\\mathbb{Q}[x]$. This is actually the only use of analysis that we make
in the integration algorithm. Also, we see that if $latex
t\_1=\\log{x}$, $latex t\_2=e^x$, and $latex t\_3=\\tan{x}$, then $latex
Dt\_1=\\frac{1}{x}$, $latex Dt\_2=t\_2$, and $latex Dt\_3=1 + t\_3^2$,
which are all polynomials in their respective $latex t\_i$ and rational
functions in $latex x$. In the algorithm, $latex K$ is actually a tower
of monomial extensions of $latex \\mathbb{Q}$, so $latex t\_n$ is a
monomial over $latex \\mathbb{Q}(x, t\_1, \\dots, t\_{n-1})$. This
allows us to work with functions like $latex e^{\\tan{x}}$. We can't
make $latex t=e^{\\tan{x}}$ directly because $latex
\\frac{d}{dx}e^{\\tan{x}} = (1 + \\tan^2{x})e^{\\tan{x}}$ is not a
polynomial in $latex t$ (it also contains $latex \\tan{x}$) . But if we
let $latex t\_1$ be such that $latex Dt\_1=1 + t\_1^2$, i.e., $latex
t\_1=\\tan{x}$, then we can let $latex t\_2$ be such that $latex
Dt\_2=(1 + t\_1^2)t\_2$, i.e., $latex t\_2=e^{\\tan{x}}$. Remember that
the $latex t\_i$ are all "functions" of x, but there is no need to write
$latex t=t(x)$ as long as we remember that $latex Dt\\neq 0$, i.e.,
$latex t\\not \\in Const\_D(K)$. This is another advantage of using
algebraic over analytic methods; it allows us to reduce an integral down
to a rational function in the "symbols" $latex x$ and $latex t\_1, t\_2,
\\dots, t\_n$. By convention, we make the first extension $latex t\_0$
such that $latex Dt\_0=1$, i.e., $latex t\_0=x$. I will just call it
$latex x$ here instead of $latex t\_0$, to avoid confusion.

This is the preparsing that I alluded to in an `earlier post`_ that I
have not implemented yet. The reason that I haven't implemented it yet
is not just because I haven't gotten around to it. We have to be careful
when we build up the extension that each element is indeed
transcendental over the already built-up field $latex k$. For example,
although it appears transcendental, the function $latex
e^{\\frac{1}{2}\\log{(1 + x^2)}}$ is really algebraic because it equals
$latex \\sqrt{1 + x^2}$. There are additional requirements, such that
each extension is not the derivative of logarithmic derivative of an
element of $latex k$ (see also the example I gave in the previous post).
This is the part that I was talking about in my `previous post`_ that is
not written out as much as the other algorithms in Bronstein's book. So
this is algorithmically solved, just like the rest of the Algorithm, but
it is non-trivial and may end up being the hardest part of the algorithm
for me to implement, just because it will probably require the most
figuring out on my part.

So we can see that we can convert a transcendental integral, such as the
one above, into a rational function in x and monomial extensions $latex
t\_1, t\_2, \\dots, t\_n$. For example, the above integrand would become
$latex - \\frac{1 + t + t^{2} + 3 x^{2} + 6 t^{2} x^{2} + 7 t x^{2} +
t^{3} + 2 x^{4}}{t^{2} x^{2} + 4 t x^{4} + 4 x^{6}}$. We then perform
certain polynomial manipulations on this integrand, using the fact that
$latex Dx=1$ and $latex Dt=\\frac{1}{x}$. For the transcendental case of
the Risch Algorithm, this is similar to the rational function
integration that I outlined in `this post`_, and has Liouville's Theorem
at its core. This is where I will start off next time.

.. _earlier post: http://asmeurersympy.wordpress.com/2010/06/26/quick-update/
.. _previous post: http://asmeurersympy.wordpress.com/2010/06/26/quick-update/
.. _this post: http://asmeurersympy.wordpress.com/2010/06/11/integration-of-rational-functions/
